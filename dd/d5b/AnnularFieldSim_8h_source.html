<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />
<title>EIC Software: fun4all_coresoftware/blob/master/calibrations/tpc/generator/AnnularFieldSim.h Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script> <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script> 
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-155388685-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-155388685-3');
</script>
</head>
<body>
	<div id="top">
		<!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectlogo"><a href="https://eic.github.io/"><img
								alt="Logo" src="../../ion-collision-xparent-crop.png" height="100"/></a></td>
						<td style="padding-left: 0.5em;">
							<div id="projectname">
								EIC Software
							</div> 
							<div id="projectbrief">
								Reference for 
								<a href="https://eic.github.io/">EIC</a> 
								<a href="https://github.com/eic/">simulation and reconstruction software on GitHub</a>
							</div> 
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Home&#160;page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../usergroup0.html"><span>External&#160;Links</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dd/d5b/AnnularFieldSim_8h_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">AnnularFieldSim.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../dd/d5b/AnnularFieldSim_8h.html">Go to the documentation of this file.</a> Or view <a target="top" href="https://github.com/eic/fun4all_coresoftware/blob/master/calibrations/tpc/generator/AnnularFieldSim.h">the newest version in sPHENIX GitHub for file AnnularFieldSim.h</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d25/Rossegger_8h.html">Rossegger.h</a>&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;TObject.h&gt;</span>  <span class="comment">// for TObject</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;TVector3.h&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span>    <span class="comment">// for NAN, abs</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;cstdio&gt;</span>   <span class="comment">// for printf</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;cstdlib&gt;</span>  <span class="comment">// for malloc</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span>   <span class="comment">// for string</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="line"><a name="l00014"></a><span class="lineno"><a class="code" href="../../d8/d64/classMultiArray.html">   14</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d8/d64/classMultiArray.html">MultiArray</a>;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keyword">class </span><a class="code" href="../../df/d10/classAnalyticFieldModel.html">AnalyticFieldModel</a>;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="keyword">class </span>TH3F;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keyword">class </span>TTree;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html">   19</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../de/d64/classAnnularFieldSim.html">AnnularFieldSim</a></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; <span class="keyword">private</span>:</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="comment">//units:</span></div>
<div class="line"><a name="l00023"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ac44c4053b96af444a599251c93649d0e">   23</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#ac44c4053b96af444a599251c93649d0e">cm</a> = 1;        <span class="comment">//centimeters -- if you change this, check that all the loading functions are properly agnostic.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#af0f7dd48bf037176a3148a5183f67150">   24</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#af0f7dd48bf037176a3148a5183f67150">m</a> = 100 * <a class="code" href="../../de/d64/classAnnularFieldSim.html#ac44c4053b96af444a599251c93649d0e">cm</a>;  <span class="comment">//meters.</span></div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a25cf8a456e60f15aa09e467c7c73e6b2">   25</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a25cf8a456e60f15aa09e467c7c73e6b2">mm</a> = <a class="code" href="../../de/d64/classAnnularFieldSim.html#ac44c4053b96af444a599251c93649d0e">cm</a> / 10;</div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a2a4fbc3d65ef9a797ecefaa35c74b074">   26</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a2a4fbc3d65ef9a797ecefaa35c74b074">um</a> = <a class="code" href="../../de/d64/classAnnularFieldSim.html#a25cf8a456e60f15aa09e467c7c73e6b2">mm</a> / 1e3;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a3122217cae55b22ab3c6b157cd96b695">   28</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a3122217cae55b22ab3c6b157cd96b695">C</a> = 1;  <span class="comment">//Coulombs</span></div>
<div class="line"><a name="l00029"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a51064bace549d13506a470e8da8b7915">   29</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a51064bace549d13506a470e8da8b7915">nC</a> = <a class="code" href="../../de/d64/classAnnularFieldSim.html#a3122217cae55b22ab3c6b157cd96b695">C</a> / 1e9;</div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a9d6b07e6c9851ded2f4cbeb4420a3566">   30</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a9d6b07e6c9851ded2f4cbeb4420a3566">fC</a> = <a class="code" href="../../de/d64/classAnnularFieldSim.html#a3122217cae55b22ab3c6b157cd96b695">C</a> / 1e15;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a50f6e78f93f158e6ab693cc119250cc6">   32</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a50f6e78f93f158e6ab693cc119250cc6">s</a> = 1;  <span class="comment">//seconds</span></div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a4e5c8f9814a8b08c8d30cfe74b1f1ab6">   33</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a4e5c8f9814a8b08c8d30cfe74b1f1ab6">us</a> = <a class="code" href="../../de/d64/classAnnularFieldSim.html#a50f6e78f93f158e6ab693cc119250cc6">s</a> / 1e6;</div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a732d3249f679913d83aada91efb092bd">   34</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a732d3249f679913d83aada91efb092bd">ns</a> = <a class="code" href="../../de/d64/classAnnularFieldSim.html#a50f6e78f93f158e6ab693cc119250cc6">s</a> / 1e9;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#add22fc45f5d33e13cfc422f3e8c8c997">   36</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#add22fc45f5d33e13cfc422f3e8c8c997">V</a> = 1;  <span class="comment">//volts</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ad3398b737ec329b9f9dca579bf123bb0">   38</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#ad3398b737ec329b9f9dca579bf123bb0">Tesla</a> = <a class="code" href="../../de/d64/classAnnularFieldSim.html#add22fc45f5d33e13cfc422f3e8c8c997">V</a> * <a class="code" href="../../de/d64/classAnnularFieldSim.html#a50f6e78f93f158e6ab693cc119250cc6">s</a> / <a class="code" href="../../de/d64/classAnnularFieldSim.html#af0f7dd48bf037176a3148a5183f67150">m</a> / <a class="code" href="../../de/d64/classAnnularFieldSim.html#af0f7dd48bf037176a3148a5183f67150">m</a>;  <span class="comment">//Tesla=Vs/m^2</span></div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a50493c2c71d69d44ed9ae9b29d8dbb75">   39</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a50493c2c71d69d44ed9ae9b29d8dbb75">kGauss</a> = <a class="code" href="../../de/d64/classAnnularFieldSim.html#ad3398b737ec329b9f9dca579bf123bb0">Tesla</a> / 10;    <span class="comment">//kGauss</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ae37a0016d1e498a305ef9ccda23b6fd9">   41</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#ae37a0016d1e498a305ef9ccda23b6fd9">eps0</a> = 8.854e-12 * (<a class="code" href="../../de/d64/classAnnularFieldSim.html#a3122217cae55b22ab3c6b157cd96b695">C</a> / <a class="code" href="../../de/d64/classAnnularFieldSim.html#add22fc45f5d33e13cfc422f3e8c8c997">V</a>) / <a class="code" href="../../de/d64/classAnnularFieldSim.html#af0f7dd48bf037176a3148a5183f67150">m</a>;    <span class="comment">//Farads(=Coulombs/Volts) per meter</span></div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#acc1f15347d3bfeeb631b7e0e0a177e8d">   42</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#acc1f15347d3bfeeb631b7e0e0a177e8d">epsinv</a> = 1 / <a class="code" href="../../de/d64/classAnnularFieldSim.html#ae37a0016d1e498a305ef9ccda23b6fd9">eps0</a>;                 <span class="comment">//Vcm/C</span></div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#af7c1e4f13e1b7c9ab80e97485034e34a">   43</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#af7c1e4f13e1b7c9ab80e97485034e34a">k_perm</a> = 1 / (4 * 3.1416 * <a class="code" href="../../de/d64/classAnnularFieldSim.html#ae37a0016d1e498a305ef9ccda23b6fd9">eps0</a>);  <span class="comment">//implied units of V*cm/C because we&#39;re doing unitful work here.</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a548d440aa514aa75d10b01b43dd3d563">   46</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a548d440aa514aa75d10b01b43dd3d563">BoundsCase</a></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  {</div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a548d440aa514aa75d10b01b43dd3d563a001a15105ff79311da52488c96571fd8">   48</a></span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#a548d440aa514aa75d10b01b43dd3d563a001a15105ff79311da52488c96571fd8">InBounds</a>,</div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a548d440aa514aa75d10b01b43dd3d563aa857465f2cf8d2a2e910794e90ef30b9">   49</a></span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#a548d440aa514aa75d10b01b43dd3d563aa857465f2cf8d2a2e910794e90ef30b9">OnHighEdge</a>,</div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a548d440aa514aa75d10b01b43dd3d563a036052f156b5b8b74e2746185342bc43">   50</a></span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#a548d440aa514aa75d10b01b43dd3d563a036052f156b5b8b74e2746185342bc43">OnLowEdge</a>,</div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a548d440aa514aa75d10b01b43dd3d563a5d6b1a005f45425192fb685b714dac15">   51</a></span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#a548d440aa514aa75d10b01b43dd3d563a5d6b1a005f45425192fb685b714dac15">OutOfBounds</a></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  };  <span class="comment">//note that &#39;OnLowEdge&#39; is qualitatively different from &#39;OnHighEdge&#39;.  Low means there is a non-zero distance between the point and the edge of the bin.  High applies even if that distance is exactly zero.</span></div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ace93c2ce22b87fc89172a3f0df484912">   53</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#ace93c2ce22b87fc89172a3f0df484912">LookupCase</a></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  {</div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ace93c2ce22b87fc89172a3f0df484912ac20b14fd6f49ea685f1efa42313344cf">   55</a></span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#ace93c2ce22b87fc89172a3f0df484912ac20b14fd6f49ea685f1efa42313344cf">Full3D</a>,</div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ace93c2ce22b87fc89172a3f0df484912ab2ebc633d33ad7912d9290d256ea4819">   56</a></span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#ace93c2ce22b87fc89172a3f0df484912ab2ebc633d33ad7912d9290d256ea4819">HybridRes</a>,</div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ace93c2ce22b87fc89172a3f0df484912aa9a7b26da725426bb440409274d09ca5">   57</a></span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#ace93c2ce22b87fc89172a3f0df484912aa9a7b26da725426bb440409274d09ca5">PhiSlice</a>,</div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ace93c2ce22b87fc89172a3f0df484912afd1a80e709f9494e2123081ec7d33f90">   58</a></span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#ace93c2ce22b87fc89172a3f0df484912afd1a80e709f9494e2123081ec7d33f90">Analytic</a>,</div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ace93c2ce22b87fc89172a3f0df484912af7578ea26890f328d41266f6216e723a">   59</a></span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#ace93c2ce22b87fc89172a3f0df484912af7578ea26890f328d41266f6216e723a">NoLookup</a></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  };</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="comment">//Full3D = uses (nr x nphi x nz)^2 lookup table</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="comment">//Hybrid = uses (nr x nphi x nz) x (nr_local x nphi_local x nz_local) + (nr_low x nphi_low x nz_low)^2 set of tables</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">//PhiSlice = uses (nr x 1 x nz) x (nr x nphi x nz) lookup table exploiting phi symmetry.</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="comment">//Analytic = doesn&#39;t use lookup tables -- no memory footprint, uses analytic E field at center of each bin.</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="comment">//    Note that this is not the same as analytic propagation, which checks the analytic field integrals in each step.</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="comment">//NoLookup = Don&#39;t build any structures -- effectively ignores any calculated spacecharge field</span></div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#acb7667cb9f4bba130299af053fdc51f0">   67</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#acb7667cb9f4bba130299af053fdc51f0">ChargeCase</a></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  {</div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#acb7667cb9f4bba130299af053fdc51f0aab085a8b706e467986aecb5f4c184858">   69</a></span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#acb7667cb9f4bba130299af053fdc51f0aab085a8b706e467986aecb5f4c184858">FromFile</a>,</div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#acb7667cb9f4bba130299af053fdc51f0a1314d7c68c2619df9fc8bb860ae99c75">   70</a></span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#acb7667cb9f4bba130299af053fdc51f0a1314d7c68c2619df9fc8bb860ae99c75">AnalyticSpacecharge</a>,</div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#acb7667cb9f4bba130299af053fdc51f0ababca6924febfe3960a8663425f1adf2">   71</a></span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#acb7667cb9f4bba130299af053fdc51f0ababca6924febfe3960a8663425f1adf2">NoSpacecharge</a></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  };  <span class="comment">//load from file, load from AnalyticFieldModel, or set to zero.</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">//note that if we set to Zero, we skip the lookup step.</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="comment">//debug items</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ac15a558ac9d5c8252702c3b5ddd76c9b">   77</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#ac15a558ac9d5c8252702c3b5ddd76c9b">debug_printActionEveryN</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a2e301ad1adea89d30124c628d6d34d7e">   78</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a2e301ad1adea89d30124c628d6d34d7e">debug_npercent</a>;</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#afe1556a1293f9395a1aca920cd28065e">   79</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#afe1556a1293f9395a1aca920cd28065e">debug_printCounter</a>;</div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#adbd418bf0e1b92cde436822fd02abf74">   80</a></span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#adbd418bf0e1b92cde436822fd02abf74">debug_distortionScale</a>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a843b7f4bccc385bb048c9a643a986582">   82</a></span>&#160;  <a class="code" href="../../df/d10/classAnalyticFieldModel.html">AnalyticFieldModel</a> *<a class="code" href="../../de/d64/classAnnularFieldSim.html#a843b7f4bccc385bb048c9a643a986582">aliceModel</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">//the other half of the detector:</span></div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a6743c036ddac97dd925c0df7db7ea501">   85</a></span>&#160;  <a class="code" href="../../de/d64/classAnnularFieldSim.html">AnnularFieldSim</a> *<a class="code" href="../../de/d64/classAnnularFieldSim.html#a6743c036ddac97dd925c0df7db7ea501">twin</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a2725f78da3001d4b75a0d9f91b34dea9">   86</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a2725f78da3001d4b75a0d9f91b34dea9">hasTwin</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="comment">//constants of motion, dimensions, etc:</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a706460f97f54eb09c18d695e436ee2b9">   90</a></span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#a706460f97f54eb09c18d695e436ee2b9">zero_vector</a>;  <span class="comment">//a shorthand way to return a vectorial zero.</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="comment">//static constexpr float k=8.987e13;//=1/(4*pi*eps0) in N*cm^2/C^2 in a vacuum. N*cm^2/C units, so that we supply space charge in coulomb units.</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="comment">//static constexpr float k_perm=8.987e11;//=1/(4*pi*eps0) in (V*cm)/C in a vacuum. so that we supply space charge in Coulombs, distance in cm, and fields in V/cm</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="comment">//gas constants:</span></div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ae83b1b7d69b7029daf8a9ed58314e5c1">   95</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#ae83b1b7d69b7029daf8a9ed58314e5c1">vdrift</a> = NAN;  <span class="comment">//gas drift speed in cm/s</span></div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a1062463e699885ded88f6c1a3a07a533">   96</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a1062463e699885ded88f6c1a3a07a533">langevin_T1</a> = NAN;</div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a217aae0018d7122b91d6cc9b5709c61b">   97</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a217aae0018d7122b91d6cc9b5709c61b">langevin_T2</a> = NAN;       <span class="comment">//gas tensor drift terms.</span></div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ae94da38b14049881cc6c9e36b84a05d2">   98</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#ae94da38b14049881cc6c9e36b84a05d2">omegatau_nominal</a> = NAN;  <span class="comment">//nominal omegatau value, derived from vdrift and field strengths.</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">//double vprime; //first derivative of drift velocity at specific E</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="comment">//double vprime2; //second derivative of drift velocity at specific E</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="comment">//field constants:</span></div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ad4d6e08a4520174509a6c8d1e84c9868">  103</a></span>&#160;  std::string <a class="code" href="../../de/d64/classAnnularFieldSim.html#ad4d6e08a4520174509a6c8d1e84c9868">fieldstring</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ab032b553e141c1a6add587c42458f347">  104</a></span>&#160;  std::string <a class="code" href="../../de/d64/classAnnularFieldSim.html#ab032b553e141c1a6add587c42458f347">Bfieldname</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#aee246a62e470501dc809be946330f11c">  105</a></span>&#160;  std::string <a class="code" href="../../de/d64/classAnnularFieldSim.html#aee246a62e470501dc809be946330f11c">Efieldname</a>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="comment">//  char fieldstring[300],Bfieldname[100],Efieldname[100];</span></div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#aee70eac1c5ac6454c9ff23128288b03e">  107</a></span>&#160;  std::string <a class="code" href="../../de/d64/classAnnularFieldSim.html#aee70eac1c5ac6454c9ff23128288b03e">chargefilename</a>;</div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a7eb439bec285eceabc0470598486ea7b">  108</a></span>&#160;  <span class="keywordtype">char</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a7eb439bec285eceabc0470598486ea7b">chargestring</a>[300] = {0};  <span class="comment">//, chargefilename[100];</span></div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a517b31827f7563eeb6c9c54182b5655e">  109</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a517b31827f7563eeb6c9c54182b5655e">Enominal</a> = NAN;          <span class="comment">//magnitude of the nominal field on which drift speed is based, in V/cm.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ace424fdd41ee18b156ca4356cdfa736e">  110</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#ace424fdd41ee18b156ca4356cdfa736e">Bnominal</a>;                <span class="comment">//magnitude of the nominal magnetic field on which drift speed is based, in Tesla.</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="comment">//physical dimensions</span></div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ad599b2a5ac68da60609b8892b8f82032">  113</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#ad599b2a5ac68da60609b8892b8f82032">phispan</a>;     <span class="comment">//angular span of the area in the phi direction, since TVector3 is too smart.</span></div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#abc6e7cc71ac9688d76f0d72016df3e34">  114</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#abc6e7cc71ac9688d76f0d72016df3e34">rmin</a>, <a class="code" href="../../de/d64/classAnnularFieldSim.html#a5b910d33cbf61449e7b78071d2403ec2">rmax</a>;  <span class="comment">//inner and outer radii of the annulus</span></div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a4b55cef465021cb15d4ddf315cb29aaa">  115</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a4b55cef465021cb15d4ddf315cb29aaa">zmin</a>, <a class="code" href="../../de/d64/classAnnularFieldSim.html#a1d48f893997408b32ded5f0f3b8e3bfd">zmax</a>;  <span class="comment">//lower and upper edges of the coordinate system in z (not fully implemented yet)</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="comment">//float phimin, phimax;//not implemented at all yet.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#aa47cb66417a01a48e56d6b02789264f6">  117</a></span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#aa47cb66417a01a48e56d6b02789264f6">dim</a>;       <span class="comment">//dimensions of simulated region, in cm</span></div>
<div class="line"><a name="l00118"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a261ec743956234d0e225c1e12e701a78">  118</a></span>&#160;  <a class="code" href="../../dc/de5/classRossegger.html">Rossegger</a> *<a class="code" href="../../de/d64/classAnnularFieldSim.html#a261ec743956234d0e225c1e12e701a78">green</a>;   <span class="comment">//stand-alone class to compute greens functions.</span></div>
<div class="line"><a name="l00119"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ad37e2804a3e394e5617951c6bb444f84">  119</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#ad37e2804a3e394e5617951c6bb444f84">green_shift</a>;  <span class="comment">//how far to offset our position in z when querying our green&#39;s functions.</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="comment">//variables related to the whole-volume tiling:</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a320889ce4dd4f78af0db7d7771154749">  123</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a79536226ea2f16746228f2167068446e">nr</a>, <a class="code" href="../../de/d64/classAnnularFieldSim.html#ab8baa667abbf5c7f39839623f1034b25">nphi</a>, <a class="code" href="../../de/d64/classAnnularFieldSim.html#a320889ce4dd4f78af0db7d7771154749">nz</a>;       <span class="comment">//number of fundamental bins (f-bins) in each direction = dimensions of 3D array covering entire volume</span></div>
<div class="line"><a name="l00124"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a3f741c62fa309bcceb685d8718f6ceab">  124</a></span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#a3f741c62fa309bcceb685d8718f6ceab">step</a>;          <span class="comment">//size of an f-bin in each direction</span></div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a117311ef87fa82b0a7cc27f7af531d81">  125</a></span>&#160;  <a class="code" href="../../de/d64/classAnnularFieldSim.html#ace93c2ce22b87fc89172a3f0df484912">LookupCase</a> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a117311ef87fa82b0a7cc27f7af531d81">lookupCase</a>;  <span class="comment">//which lookup system to instantiate and use.</span></div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#aa182d2d11e0e8216fa7ebb1dcdd4a68c">  126</a></span>&#160;  <a class="code" href="../../de/d64/classAnnularFieldSim.html#acb7667cb9f4bba130299af053fdc51f0">ChargeCase</a> <a class="code" href="../../de/d64/classAnnularFieldSim.html#aa182d2d11e0e8216fa7ebb1dcdd4a68c">chargeCase</a>;  <span class="comment">//which charge model to use</span></div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ac8d43e1809336ebb1b7b3f97e04c17cf">  127</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#ac8d43e1809336ebb1b7b3f97e04c17cf">truncation_length</a>;  <span class="comment">//distance in cells (full 3D metric in units of bins)</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="comment">//variables related to the region of interest:</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a100a33387d110f6fc985fb11b066fc0d">  131</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#aef30f781970f4b7a0709ee1da6defc90">rmin_roi</a>, <a class="code" href="../../de/d64/classAnnularFieldSim.html#a46d75be3799c796b5ef085326fe9c3fe">phimin_roi</a>, <a class="code" href="../../de/d64/classAnnularFieldSim.html#a100a33387d110f6fc985fb11b066fc0d">zmin_roi</a>;  <span class="comment">//lower edge of our region of interest, measured in f-bins</span></div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ab07f230e28b39f3910eab9318400513c">  132</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#ac3e28c48fc1f03956561cdcfbc650999">rmax_roi</a>, <a class="code" href="../../de/d64/classAnnularFieldSim.html#ac1e93ff3f4e623449e6d10d2f1910cc6">phimax_roi</a>, <a class="code" href="../../de/d64/classAnnularFieldSim.html#ab07f230e28b39f3910eab9318400513c">zmax_roi</a>;  <span class="comment">//excluded upper edge of our region of interest, measured in f-bins</span></div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a949b7ed609195b0cd4498e040ff262db">  133</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a6a8f9df0c18dc6bdea346575b817c152">nr_roi</a>, <a class="code" href="../../de/d64/classAnnularFieldSim.html#ae9038e19b32063a3c67c00853cd325b8">nphi_roi</a>, <a class="code" href="../../de/d64/classAnnularFieldSim.html#a949b7ed609195b0cd4498e040ff262db">nz_roi</a>;        <span class="comment">//dimensions of our roi in f-bins</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="comment">//variables related to the high-res behavior:</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a7a8e3028b6f00782ef26683a18a9c351">  137</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a7a8e3028b6f00782ef26683a18a9c351">nr_high</a> = -1;</div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a8b33436d6a20d9698c3dd39db4ba3784">  138</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a8b33436d6a20d9698c3dd39db4ba3784">nphi_high</a> = -1;</div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a8594f9b21d7ab7f4938ae87793e79d1a">  139</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a8594f9b21d7ab7f4938ae87793e79d1a">nz_high</a> = -1;  <span class="comment">//dimensions, in f-bins of neighborhood of a f-bin in which we calculate the field in full resolution</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="comment">//variables related to the low-res behavior:</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a3e84c61c56134d72992b940a889f297c">  143</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a3e84c61c56134d72992b940a889f297c">r_spacing</a> = -1;</div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a09f972e6da20da4bd6508ea919a566d4">  144</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a09f972e6da20da4bd6508ea919a566d4">phi_spacing</a> = -1;</div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a90c13a6de122eaa34d8da6869b627104">  145</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a90c13a6de122eaa34d8da6869b627104">z_spacing</a> = -1;  <span class="comment">//number of f-bins, in each direction, to gang together to make a single low-resolution bin (l-bin)</span></div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#af6be58ea3979a6278bff906c943ea4a3">  146</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#af6be58ea3979a6278bff906c943ea4a3">nr_low</a> = -1;</div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#aed089501f43e4a12141981e52af26519">  147</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#aed089501f43e4a12141981e52af26519">nphi_low</a> = -1;</div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ae9bdbb31e591c81d45912efa73fce654">  148</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#ae9bdbb31e591c81d45912efa73fce654">nz_low</a> = -1;  <span class="comment">//dimensions, in l-bins, of the entire volume</span></div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a0414585861f707dd518182800e0beaa3">  149</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a0414585861f707dd518182800e0beaa3">rmin_roi_low</a> = -1;</div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#acabd7bc4c835302b2853feda70c52d05">  150</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#acabd7bc4c835302b2853feda70c52d05">phimin_roi_low</a> = -1;</div>
<div class="line"><a name="l00151"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#acc4cbafa5dbfe53f721b469d52185d3c">  151</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#acc4cbafa5dbfe53f721b469d52185d3c">zmin_roi_low</a> = -1;  <span class="comment">//lowest l-bin that is at least partly in our region of interest</span></div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a2057ffce5f05b54a5713b4b1e5641309">  152</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a2057ffce5f05b54a5713b4b1e5641309">rmax_roi_low</a> = -1;</div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a18f3f677be3a854b1adf890dfa6dcd0e">  153</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a18f3f677be3a854b1adf890dfa6dcd0e">phimax_roi_low</a> = -1;</div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#afc016b1bbc9692da21268868f51fc3fb">  154</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#afc016b1bbc9692da21268868f51fc3fb">zmax_roi_low</a> = -1;  <span class="comment">//excluded upper edge l-bin of our region of interest</span></div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a2582bbaaea39ee0668e6aae399828d8b">  155</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a2582bbaaea39ee0668e6aae399828d8b">nr_roi_low</a> = -1;</div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a1c136bb3ad3b004767131c421210c425">  156</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a1c136bb3ad3b004767131c421210c425">nphi_roi_low</a> = -1;</div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a36f0e932c673e595833e38570bb03e8a">  157</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a36f0e932c673e595833e38570bb03e8a">nz_roi_low</a> = -1;  <span class="comment">//dimensions of our roi in l-bins</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="comment">//3- and 6-dimensional arrays to handle bin and bin-to-bin data</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#aeeaac1b3cbe466eac8fec86af99172d2">  161</a></span>&#160;  <a class="code" href="../../d8/d64/classMultiArray.html">MultiArray&lt;TVector3&gt;</a> *<a class="code" href="../../de/d64/classAnnularFieldSim.html#aeeaac1b3cbe466eac8fec86af99172d2">Efield</a>;             <span class="comment">//total electric field in each f-bin in the roi for given configuration of charge AND external field.</span></div>
<div class="line"><a name="l00162"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#aa8a5aed287dd1ad723d2f897c61fc08c">  162</a></span>&#160;  <a class="code" href="../../d8/d64/classMultiArray.html">MultiArray&lt;TVector3&gt;</a> *<a class="code" href="../../de/d64/classAnnularFieldSim.html#aa8a5aed287dd1ad723d2f897c61fc08c">Epartial_highres</a>;   <span class="comment">//electric field in each f-bin in the roi from charge in a given f-bin or summed bin in the high res region.</span></div>
<div class="line"><a name="l00163"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#aa4cc4892f9e2ca6b8ce07383fb1897f6">  163</a></span>&#160;  <a class="code" href="../../d8/d64/classMultiArray.html">MultiArray&lt;TVector3&gt;</a> *<a class="code" href="../../de/d64/classAnnularFieldSim.html#aa4cc4892f9e2ca6b8ce07383fb1897f6">Epartial_lowres</a>;    <span class="comment">//electric field in each l-bin in the roi from charge in a given l-bin anywhere in the volume.</span></div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a12dd10a36307c5896ef633b5edf6d67d">  164</a></span>&#160;  <a class="code" href="../../d8/d64/classMultiArray.html">MultiArray&lt;TVector3&gt;</a> *<a class="code" href="../../de/d64/classAnnularFieldSim.html#a12dd10a36307c5896ef633b5edf6d67d">Epartial</a>;           <span class="comment">//electric field for the old brute-force model.</span></div>
<div class="line"><a name="l00165"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#aaca0e0273dbdea674cb59f3b0466c4c9">  165</a></span>&#160;  <a class="code" href="../../d8/d64/classMultiArray.html">MultiArray&lt;TVector3&gt;</a> *<a class="code" href="../../de/d64/classAnnularFieldSim.html#aaca0e0273dbdea674cb59f3b0466c4c9">Epartial_phislice</a>;  <span class="comment">//electric field in a 2D phi-slice from the full 3D region.</span></div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#aedd910db5278318b852bfc65ca976cf6">  166</a></span>&#160;  <a class="code" href="../../d8/d64/classMultiArray.html">MultiArray&lt;TVector3&gt;</a> *<a class="code" href="../../de/d64/classAnnularFieldSim.html#aedd910db5278318b852bfc65ca976cf6">Eexternal</a>;          <span class="comment">//externally applied electric field in each f-bin in the roi</span></div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a8a4ff3d7e7a493f4b38408e83c7479af">  167</a></span>&#160;  <a class="code" href="../../d8/d64/classMultiArray.html">MultiArray&lt;TVector3&gt;</a> *<a class="code" href="../../de/d64/classAnnularFieldSim.html#a8a4ff3d7e7a493f4b38408e83c7479af">Bfield</a>;             <span class="comment">//magnetic field in each f-bin in the roi</span></div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a86198768dba687cc0b35d4a6a235ecfb">  168</a></span>&#160;  <a class="code" href="../../d8/d64/classMultiArray.html">MultiArray&lt;double&gt;</a> *<a class="code" href="../../de/d64/classAnnularFieldSim.html#a86198768dba687cc0b35d4a6a235ecfb">q</a>;                    <span class="comment">//space charge in each f-bin in the whole volume</span></div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a17ab62844a52175c4b2439b1a6beb78e">  169</a></span>&#160;  <a class="code" href="../../d8/d64/classMultiArray.html">MultiArray&lt;double&gt;</a> *<a class="code" href="../../de/d64/classAnnularFieldSim.html#a17ab62844a52175c4b2439b1a6beb78e">q_local</a>;              <span class="comment">//temporary holder of space charge in each f-bin and summed bin of the high-res region.</span></div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a908de0cdfdcde19201e7c18f1c81db07">  170</a></span>&#160;  <a class="code" href="../../d8/d64/classMultiArray.html">MultiArray&lt;double&gt;</a> *<a class="code" href="../../de/d64/classAnnularFieldSim.html#a908de0cdfdcde19201e7c18f1c81db07">q_lowres</a>;             <span class="comment">//space charge in each l-bin. = sums over sets of f-bins.</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">//constructors with history for backwards compatibility</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <a class="code" href="../../de/d64/classAnnularFieldSim.html#a1345fb27558efc4651d8fa5f4ac36db9">AnnularFieldSim</a>(<span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#abc6e7cc71ac9688d76f0d72016df3e34">rmin</a>, <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a5b910d33cbf61449e7b78071d2403ec2">rmax</a>, <span class="keywordtype">float</span> <a class="code" href="../../df/d9f/PHG4EPDDetector_8cc.html#ae7ad3d414b6c5188eed2a2427237d90b">dz</a>, <span class="keywordtype">int</span> r, <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a7b540384a61cacdec7528421fa0a22b2">phi</a>, <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a9593b8fc874ec60dacdcbeaec75a8235">z</a>, <span class="keywordtype">float</span> vdr);  <span class="comment">//abbr. constructor with roi=full region</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <a class="code" href="../../de/d64/classAnnularFieldSim.html#a1345fb27558efc4651d8fa5f4ac36db9">AnnularFieldSim</a>(<span class="keywordtype">float</span> rin, <span class="keywordtype">float</span> rout, <span class="keywordtype">float</span> <a class="code" href="../../df/d9f/PHG4EPDDetector_8cc.html#ae7ad3d414b6c5188eed2a2427237d90b">dz</a>,</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                  <span class="keywordtype">int</span> r, <span class="keywordtype">int</span> roi_r0, <span class="keywordtype">int</span> roi_r1,</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                  <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a7b540384a61cacdec7528421fa0a22b2">phi</a>, <span class="keywordtype">int</span> roi_phi0, <span class="keywordtype">int</span> roi_phi1,</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                  <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a9593b8fc874ec60dacdcbeaec75a8235">z</a>, <span class="keywordtype">int</span> roi_z0, <span class="keywordtype">int</span> roi_z1,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                  <span class="keywordtype">float</span> vdr, <a class="code" href="../../de/d64/classAnnularFieldSim.html#ace93c2ce22b87fc89172a3f0df484912">LookupCase</a> in_lookupCase = <a class="code" href="../../de/d64/classAnnularFieldSim.html#ace93c2ce22b87fc89172a3f0df484912aa9a7b26da725426bb440409274d09ca5">PhiSlice</a>);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <a class="code" href="../../de/d64/classAnnularFieldSim.html#a1345fb27558efc4651d8fa5f4ac36db9">AnnularFieldSim</a>(<span class="keywordtype">float</span> in_innerRadius, <span class="keywordtype">float</span> in_outerRadius, <span class="keywordtype">float</span> in_outerZ,</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                  <span class="keywordtype">int</span> r, <span class="keywordtype">int</span> roi_r0, <span class="keywordtype">int</span> roi_r1, <span class="keywordtype">int</span> in_rLowSpacing, <span class="keywordtype">int</span> in_rHighSize,</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                  <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a7b540384a61cacdec7528421fa0a22b2">phi</a>, <span class="keywordtype">int</span> roi_phi0, <span class="keywordtype">int</span> roi_phi1, <span class="keywordtype">int</span> in_phiLowSpacing, <span class="keywordtype">int</span> in_phiHighSize,</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                  <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a9593b8fc874ec60dacdcbeaec75a8235">z</a>, <span class="keywordtype">int</span> roi_z0, <span class="keywordtype">int</span> roi_z1, <span class="keywordtype">int</span> in_zLowSpacing, <span class="keywordtype">int</span> in_zHighSize,</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                  <span class="keywordtype">float</span> vdr, <a class="code" href="../../de/d64/classAnnularFieldSim.html#ace93c2ce22b87fc89172a3f0df484912">LookupCase</a> in_lookupCase);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <a class="code" href="../../de/d64/classAnnularFieldSim.html#a1345fb27558efc4651d8fa5f4ac36db9">AnnularFieldSim</a>(<span class="keywordtype">float</span> in_innerRadius, <span class="keywordtype">float</span> in_outerRadius, <span class="keywordtype">float</span> in_outerZ,</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                  <span class="keywordtype">int</span> r, <span class="keywordtype">int</span> roi_r0, <span class="keywordtype">int</span> roi_r1, <span class="keywordtype">int</span> in_rLowSpacing, <span class="keywordtype">int</span> in_rHighSize,</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                  <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a7b540384a61cacdec7528421fa0a22b2">phi</a>, <span class="keywordtype">int</span> roi_phi0, <span class="keywordtype">int</span> roi_phi1, <span class="keywordtype">int</span> in_phiLowSpacing, <span class="keywordtype">int</span> in_phiHighSize,</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                  <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a9593b8fc874ec60dacdcbeaec75a8235">z</a>, <span class="keywordtype">int</span> roi_z0, <span class="keywordtype">int</span> roi_z1, <span class="keywordtype">int</span> in_zLowSpacing, <span class="keywordtype">int</span> in_zHighSize,</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                  <span class="keywordtype">float</span> vdr, <a class="code" href="../../de/d64/classAnnularFieldSim.html#ace93c2ce22b87fc89172a3f0df484912">LookupCase</a> in_lookupCase, <a class="code" href="../../de/d64/classAnnularFieldSim.html#acb7667cb9f4bba130299af053fdc51f0">ChargeCase</a> in_chargeCase);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="comment">//debug functions:</span></div>
<div class="line"><a name="l00192"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a81f469e55ef787ea4d173ac26de871c8">  192</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a81f469e55ef787ea4d173ac26de871c8">UpdateEveryN</a>(<span class="keywordtype">int</span> <a class="code" href="../../d8/dbe/pythia6_2pythiaInterface_8h.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#a2e301ad1adea89d30124c628d6d34d7e">debug_npercent</a> = <a class="code" href="../../d8/dbe/pythia6_2pythiaInterface_8h.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#ac15a558ac9d5c8252702c3b5ddd76c9b">debug_printActionEveryN</a> = 0;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  };</div>
<div class="line"><a name="l00198"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a41c47c61e74d8b39455b96b09890acba">  198</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a41c47c61e74d8b39455b96b09890acba">debugFlag</a>()</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../de/d64/classAnnularFieldSim.html#ac15a558ac9d5c8252702c3b5ddd76c9b">debug_printActionEveryN</a> &gt; 0 &amp;&amp; <a class="code" href="../../de/d64/classAnnularFieldSim.html#afe1556a1293f9395a1aca920cd28065e">debug_printCounter</a>++ &gt;= <a class="code" href="../../de/d64/classAnnularFieldSim.html#ac15a558ac9d5c8252702c3b5ddd76c9b">debug_printActionEveryN</a>)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <a class="code" href="../../de/d64/classAnnularFieldSim.html#afe1556a1293f9395a1aca920cd28065e">debug_printCounter</a> = 0;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  };</div>
<div class="line"><a name="l00207"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a592e1ba0b13720e340af63794784889c">  207</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a592e1ba0b13720e340af63794784889c">SetDistortionScaleRPZ</a>(<span class="keywordtype">float</span> a, <span class="keywordtype">float</span> b, <span class="keywordtype">float</span> <a class="code" href="../../d4/d51/vector__math__inline_8h.html#ae0323a9039add2978bf5b49550572c7c">c</a>)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#adbd418bf0e1b92cde436822fd02abf74">debug_distortionScale</a>.SetXYZ(a, b, c);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  };</div>
<div class="line"><a name="l00212"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a0d741973f0802f8b1c734bfdcf806f9d">  212</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a0d741973f0802f8b1c734bfdcf806f9d">SetTruncationDistance</a>(<span class="keywordtype">int</span> <a class="code" href="../../d4/d51/vector__math__inline_8h.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#ac8d43e1809336ebb1b7b3f97e04c17cf">truncation_length</a> = <a class="code" href="../../d4/d51/vector__math__inline_8h.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="comment">//getters for internal states:</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../de/d64/classAnnularFieldSim.html#a7968214559bb324459390f9cce7e8a88">GetLookupString</a>();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../de/d64/classAnnularFieldSim.html#af0c340523f69f514b60be663c0422f26">GetGasString</a>();</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../de/d64/classAnnularFieldSim.html#a146ebec611255de008dd779f3092f893">GetFieldString</a>();</div>
<div class="line"><a name="l00222"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a98979ea683686b965fa9d6f17b5499ed">  222</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../de/d64/classAnnularFieldSim.html#a98979ea683686b965fa9d6f17b5499ed">GetChargeString</a>() { <span class="keywordflow">return</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a7eb439bec285eceabc0470598486ea7b">chargestring</a>; };</div>
<div class="line"><a name="l00223"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ac34f1c0a0635f557efa7a813901b93b0">  223</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#ac34f1c0a0635f557efa7a813901b93b0">GetNominalB</a>() { <span class="keywordflow">return</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#ace424fdd41ee18b156ca4356cdfa736e">Bnominal</a>; };</div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#af0302e48cd39c73528f5ca39255d0294">  224</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#af0302e48cd39c73528f5ca39255d0294">GetNominalE</a>() { <span class="keywordflow">return</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a517b31827f7563eeb6c9c54182b5655e">Enominal</a>; };</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordtype">float</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#ab976e8a9626ad0d4f02b55d5efa022a8">GetChargeAt</a>(TVector3 <a class="code" href="../../dc/de5/PHG4mRICHDetector_8cc.html#a11ded6fc3d3fab0e72612c3886df87a0">pos</a>);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#a7e8b5fae7ced0297ad4b919850a23bf1">GetFieldAt</a>(TVector3 <a class="code" href="../../dc/de5/PHG4mRICHDetector_8cc.html#a11ded6fc3d3fab0e72612c3886df87a0">pos</a>);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#a55c0f0c1f184fabfc4c2b881848e0b18">GetBFieldAt</a>(TVector3 <a class="code" href="../../dc/de5/PHG4mRICHDetector_8cc.html#a11ded6fc3d3fab0e72612c3886df87a0">pos</a>);</div>
<div class="line"><a name="l00228"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ac3106a1618f3f51868239210deaee3c5">  228</a></span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#ac3106a1618f3f51868239210deaee3c5">GetFieldStep</a>() { <span class="keywordflow">return</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a3f741c62fa309bcceb685d8718f6ceab">step</a>; };</div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a9bd7d94036eb0cbe4cf182af460bee0e">  229</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a9bd7d94036eb0cbe4cf182af460bee0e">GetFieldStepsR</a>() { <span class="keywordflow">return</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a6a8f9df0c18dc6bdea346575b817c152">nr_roi</a>; };</div>
<div class="line"><a name="l00230"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ababaa9675b4f7a0ea774b3145623b892">  230</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#ababaa9675b4f7a0ea774b3145623b892">GetFieldStepsPhi</a>() { <span class="keywordflow">return</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#ae9038e19b32063a3c67c00853cd325b8">nphi_roi</a>; };</div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a983fff01de22f2bafd88331d636cd8ac">  231</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a983fff01de22f2bafd88331d636cd8ac">GetFieldStepsZ</a>() { <span class="keywordflow">return</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a949b7ed609195b0cd4498e040ff262db">nz_roi</a>; };</div>
<div class="line"><a name="l00232"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a33dfea024e1870e3a8ce09a5bee6d5cf">  232</a></span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#a33dfea024e1870e3a8ce09a5bee6d5cf">GetInnerEdge</a>() { <span class="keywordflow">return</span> TVector3(<a class="code" href="../../de/d64/classAnnularFieldSim.html#abc6e7cc71ac9688d76f0d72016df3e34">rmin</a>, 0, <a class="code" href="../../de/d64/classAnnularFieldSim.html#a4b55cef465021cb15d4ddf315cb29aaa">zmin</a>); };</div>
<div class="line"><a name="l00233"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a89aa84314e52d84ff41305d0c74e93b4">  233</a></span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#a89aa84314e52d84ff41305d0c74e93b4">GetOuterEdge</a>() { <span class="keywordflow">return</span> TVector3(<a class="code" href="../../de/d64/classAnnularFieldSim.html#a5b910d33cbf61449e7b78071d2403ec2">rmax</a>, 0, <a class="code" href="../../de/d64/classAnnularFieldSim.html#a1d48f893997408b32ded5f0f3b8e3bfd">zmax</a>); };</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="comment">//file-writing functions for complex mapping questions:</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a69085e0758c28f66750ab848c3d35a8f">GenerateDistortionMaps</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *filebase, <span class="keywordtype">int</span> r_subsamples = 1, <span class="keywordtype">int</span> p_subsamples = 1, <span class="keywordtype">int</span> z_subsamples = 1, <span class="keywordtype">int</span> z_substeps = 1, <span class="keywordtype">bool</span> andCartesian = <span class="keyword">false</span>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#afefe72cb32eb62dc9f14d9bc7509f48f">GenerateSeparateDistortionMaps</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *filebase, <span class="keywordtype">int</span> r_subsamples = 1, <span class="keywordtype">int</span> p_subsamples = 1, <span class="keywordtype">int</span> z_subsamples = 1, <span class="keywordtype">int</span> z_substeps = 1, <span class="keywordtype">bool</span> andCartesian = <span class="keyword">false</span>);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#aa885eab897ed9c092de883332f6960a1">PlotFieldSlices</a>(<span class="keyword">const</span> std::string &amp;filebase, TVector3 <a class="code" href="../../dc/de5/PHG4mRICHDetector_8cc.html#a11ded6fc3d3fab0e72612c3886df87a0">pos</a>, <span class="keywordtype">char</span> which = <span class="charliteral">&#39;E&#39;</span>);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#aefaee12b378d8d529325ed6b80b9e41a">load_spacecharge</a>(<span class="keyword">const</span> std::string &amp;<a class="code" href="../../de/d14/namespaceINPUTHEPMC.html#a33c804f0b70a9f1d8d8b096b29a6c151">filename</a>, <span class="keyword">const</span> std::string &amp;histname, <span class="keywordtype">float</span> zoffset = 0, <span class="keywordtype">float</span> chargescale = 1, <span class="keywordtype">float</span> cmscale = 1, <span class="keywordtype">bool</span> isChargeDensity = <span class="keyword">true</span>);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#aefaee12b378d8d529325ed6b80b9e41a">load_spacecharge</a>(TH3F *hist, <span class="keywordtype">float</span> zoffset, <span class="keywordtype">float</span> chargescale, <span class="keywordtype">float</span> cmscale, <span class="keywordtype">bool</span> isChargeDensity);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#adbbe2204b3be7c779dcf3d0d08cc50ea">load_and_resample_spacecharge</a>(<span class="keywordtype">int</span> new_nphi, <span class="keywordtype">int</span> new_nr, <span class="keywordtype">int</span> new_nz, <span class="keyword">const</span> std::string &amp;<a class="code" href="../../de/d14/namespaceINPUTHEPMC.html#a33c804f0b70a9f1d8d8b096b29a6c151">filename</a>, <span class="keyword">const</span> std::string &amp;histname, <span class="keywordtype">float</span> zoffset, <span class="keywordtype">float</span> chargescale, <span class="keywordtype">float</span> cmscale, <span class="keywordtype">bool</span> isChargeDensity);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#adbbe2204b3be7c779dcf3d0d08cc50ea">load_and_resample_spacecharge</a>(<span class="keywordtype">int</span> new_nphi, <span class="keywordtype">int</span> new_nr, <span class="keywordtype">int</span> new_nz, TH3F *hist, <span class="keywordtype">float</span> zoffset, <span class="keywordtype">float</span> chargescale, <span class="keywordtype">float</span> cmscale, <span class="keywordtype">bool</span> isChargeDensity);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a2398cd69c5bb7b1409319ae44236d6b2">load_analytic_spacecharge</a>(<span class="keywordtype">float</span> scalefactor);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a93cf8cb06ee829f5890c6f45fbc100d2">add_testcharge</a>(<span class="keywordtype">float</span> r, <span class="keywordtype">float</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a7b540384a61cacdec7528421fa0a22b2">phi</a>, <span class="keywordtype">float</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a9593b8fc874ec60dacdcbeaec75a8235">z</a>, <span class="keywordtype">float</span> coulombs);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00250"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ab0ec56c7a9f3cd65b78832c2c07c9c08">  250</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#ab0ec56c7a9f3cd65b78832c2c07c9c08">setNominalB</a>(<span class="keywordtype">float</span> <a class="code" href="../../d4/d51/vector__math__inline_8h.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#ace424fdd41ee18b156ca4356cdfa736e">Bnominal</a> = <a class="code" href="../../d4/d51/vector__math__inline_8h.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#a5dc85e1b1849249dd359df0a32bd907c">UpdateOmegaTau</a>();</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  };</div>
<div class="line"><a name="l00256"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a3ff6863daa0965bcfa07d363fd8a990d">  256</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a3ff6863daa0965bcfa07d363fd8a990d">setNominalE</a>(<span class="keywordtype">float</span> <a class="code" href="../../d4/d51/vector__math__inline_8h.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#a517b31827f7563eeb6c9c54182b5655e">Enominal</a> = <a class="code" href="../../d4/d51/vector__math__inline_8h.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#a5dc85e1b1849249dd359df0a32bd907c">UpdateOmegaTau</a>();</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  };</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#ab9f595e36e6c7af8568afdace7fea051">setFlatFields</a>(<span class="keywordtype">float</span> B, <span class="keywordtype">float</span> E);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a3f3bf08a1e0acb87ce83bdd442c6330f">loadEfield</a>(<span class="keyword">const</span> std::string &amp;<a class="code" href="../../de/d14/namespaceINPUTHEPMC.html#a33c804f0b70a9f1d8d8b096b29a6c151">filename</a>, <span class="keyword">const</span> std::string &amp;treename, <span class="keywordtype">int</span> zsign = 1);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a2358166b8d8066a216fc05c2858f0b9f">loadBfield</a>(<span class="keyword">const</span> std::string &amp;<a class="code" href="../../de/d14/namespaceINPUTHEPMC.html#a33c804f0b70a9f1d8d8b096b29a6c151">filename</a>, <span class="keyword">const</span> std::string &amp;treename);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a9e8f466f311ca2ca6bd59ef2d65c7823">load3dBfield</a>(<span class="keyword">const</span> std::string &amp;<a class="code" href="../../de/d14/namespaceINPUTHEPMC.html#a33c804f0b70a9f1d8d8b096b29a6c151">filename</a>, <span class="keyword">const</span> std::string &amp;treename, <span class="keywordtype">int</span> zsign = 1, <span class="keywordtype">float</span> scale = 1.0);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#ae2be7d3732a0dbab2ff6d49a219058be">loadField</a>(<a class="code" href="../../d8/d64/classMultiArray.html">MultiArray&lt;TVector3&gt;</a> **field, TTree *source, <span class="keywordtype">float</span> *rptr, <span class="keywordtype">float</span> *phiptr, <span class="keywordtype">float</span> *zptr, <span class="keywordtype">float</span> *frptr, <span class="keywordtype">float</span> *fphiptr, <span class="keywordtype">float</span> *fzptr, <span class="keywordtype">float</span> fieldunit, <span class="keywordtype">int</span> zsign);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div>
<div class="line"><a name="l00269"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a91bd934caa7c86d36e56f3a0116b368d">  269</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a91bd934caa7c86d36e56f3a0116b368d">load_rossegger</a>(<span class="keywordtype">double</span> <a class="code" href="../../db/d4e/predicates_8cxx.html#a92508a9fbb1db78d0bbedbf68cf93d1b">epsilon</a> = 1E-4)</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#a261ec743956234d0e225c1e12e701a78">green</a> = <span class="keyword">new</span> <a class="code" href="../../dc/de5/classRossegger.html">Rossegger</a>(<a class="code" href="../../de/d64/classAnnularFieldSim.html#abc6e7cc71ac9688d76f0d72016df3e34">rmin</a>, <a class="code" href="../../de/d64/classAnnularFieldSim.html#a5b910d33cbf61449e7b78071d2403ec2">rmax</a>, <a class="code" href="../../de/d64/classAnnularFieldSim.html#a1d48f893997408b32ded5f0f3b8e3bfd">zmax</a>, <a class="code" href="../../db/d4e/predicates_8cxx.html#a92508a9fbb1db78d0bbedbf68cf93d1b">epsilon</a>);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  };</div>
<div class="line"><a name="l00274"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ae050a053eaa70073d2cb8e0fd8095a71">  274</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#ae050a053eaa70073d2cb8e0fd8095a71">borrow_rossegger</a>(<a class="code" href="../../dc/de5/classRossegger.html">Rossegger</a> *ross, <span class="keywordtype">float</span> zshift)</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#a261ec743956234d0e225c1e12e701a78">green</a> = ross;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#ad37e2804a3e394e5617951c6bb444f84">green_shift</a> = zshift;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  };  <span class="comment">//get an already-existing rossegger table instead of loading it ourselves.</span></div>
<div class="line"><a name="l00280"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ab1fef85da048f753fa6b223fb7c309d7">  280</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#ab1fef85da048f753fa6b223fb7c309d7">borrow_epartial_from</a>(<a class="code" href="../../de/d64/classAnnularFieldSim.html">AnnularFieldSim</a> *sim, <span class="keywordtype">float</span> zshift)</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#aaca0e0273dbdea674cb59f3b0466c4c9">Epartial_phislice</a> = sim-&gt;<a class="code" href="../../de/d64/classAnnularFieldSim.html#aaca0e0273dbdea674cb59f3b0466c4c9">Epartial_phislice</a>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#ad37e2804a3e394e5617951c6bb444f84">green_shift</a> = zshift;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  };  <span class="comment">//get an already-existing rossegger table instead of loading it ourselves.</span></div>
<div class="line"><a name="l00286"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#ae7eee225f3c41e6ccb0bfcee40cb0099">  286</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#ae7eee225f3c41e6ccb0bfcee40cb0099">set_twin</a>(<a class="code" href="../../de/d64/classAnnularFieldSim.html">AnnularFieldSim</a> *sim)</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#a6743c036ddac97dd925c0df7db7ea501">twin</a> = sim;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#a2725f78da3001d4b75a0d9f91b34dea9">hasTwin</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  };  <span class="comment">//define a twin to handle the negative-z drifting.  If asked to drift something out of range in z, if the twin flag is set we will ask the twin to do the drifting.  Note that the twin does not get linked back in to this side.  It is only the follower.</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#aba83c13891c05b283eebd23b347a8c2b">calc_unit_field</a>(TVector3 <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a3232ff383f8961b78bdd089138488930">at</a>, TVector3 from);</div>
<div class="line"><a name="l00294"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a3451f4963ce7c171bfbd0d566d3f10b9">  294</a></span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#a3451f4963ce7c171bfbd0d566d3f10b9">analyticFieldIntegral</a>(<span class="keywordtype">float</span> zdest, TVector3 <a class="code" href="../../dc/de5/PHG4mRICHDetector_8cc.html#a10e6010f5f8222befd1273192d72ddf5">start</a>) { <span class="keywordflow">return</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a3451f4963ce7c171bfbd0d566d3f10b9">analyticFieldIntegral</a>(zdest, start, <a class="code" href="../../de/d64/classAnnularFieldSim.html#aeeaac1b3cbe466eac8fec86af99172d2">Efield</a>); };</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#a3451f4963ce7c171bfbd0d566d3f10b9">analyticFieldIntegral</a>(<span class="keywordtype">float</span> zdest, TVector3 <a class="code" href="../../dc/de5/PHG4mRICHDetector_8cc.html#a10e6010f5f8222befd1273192d72ddf5">start</a>, <a class="code" href="../../d8/d64/classMultiArray.html">MultiArray&lt;TVector3&gt;</a> *field);</div>
<div class="line"><a name="l00297"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#aef1291170f9342d354fd2d9e41706fb0">  297</a></span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#aef1291170f9342d354fd2d9e41706fb0">interpolatedFieldIntegral</a>(<span class="keywordtype">float</span> zdest, TVector3 <a class="code" href="../../dc/de5/PHG4mRICHDetector_8cc.html#a10e6010f5f8222befd1273192d72ddf5">start</a>) { <span class="keywordflow">return</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#aef1291170f9342d354fd2d9e41706fb0">interpolatedFieldIntegral</a>(zdest, start, <a class="code" href="../../de/d64/classAnnularFieldSim.html#aeeaac1b3cbe466eac8fec86af99172d2">Efield</a>); };</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#aef1291170f9342d354fd2d9e41706fb0">interpolatedFieldIntegral</a>(<span class="keywordtype">float</span> zdest, TVector3 <a class="code" href="../../dc/de5/PHG4mRICHDetector_8cc.html#a10e6010f5f8222befd1273192d72ddf5">start</a>, <a class="code" href="../../d8/d64/classMultiArray.html">MultiArray&lt;TVector3&gt;</a> *field);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a89886f51584b79fee6e61ca60e353545">FilterPhiPos</a>(<span class="keywordtype">double</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a7b540384a61cacdec7528421fa0a22b2">phi</a>);         <span class="comment">//puts phi in 0&lt;phi&lt;2pi</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#ae7f3aaa01498d1b9259f05559c5bac7e">FilterPhiIndex</a>(<span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a7b540384a61cacdec7528421fa0a22b2">phi</a>, <span class="keywordtype">int</span> range);  <span class="comment">//puts phi in bin range 0&lt;phi&lt;range.  defaults to using nphi for range.</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#a9c93ebfb51787f51897612bf70cdc9fa">GetCellCenter</a>(<span class="keywordtype">int</span> r, <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a7b540384a61cacdec7528421fa0a22b2">phi</a>, <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a9593b8fc874ec60dacdcbeaec75a8235">z</a>);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#adbb9bba03c21915698421f313dc43071">GetRoiCellCenter</a>(<span class="keywordtype">int</span> r, <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a7b540384a61cacdec7528421fa0a22b2">phi</a>, <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a9593b8fc874ec60dacdcbeaec75a8235">z</a>);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#aa3b4e8df7cf7fd8b70640312db83198e">GetGroupCellCenter</a>(<span class="keywordtype">int</span> r0, <span class="keywordtype">int</span> <a class="code" href="../../d4/d68/HelixHough__kappaRange__sse_8cpp.html#a9936d57a6e416957ad6f37e2a80f3757">r1</a>, <span class="keywordtype">int</span> phi0, <span class="keywordtype">int</span> phi1, <span class="keywordtype">int</span> z0, <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#aeddfda3fd55d66059a08011d2ae2368f">z1</a>);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#ae0865076b7af1f0c57ddd36c9af2cc22">GetWeightedCellCenter</a>(<span class="keywordtype">int</span> r, <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a7b540384a61cacdec7528421fa0a22b2">phi</a>, <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a9593b8fc874ec60dacdcbeaec75a8235">z</a>);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#a9d8694f7b8d4d53ba2d2d0b0d088844c">fieldIntegral</a>(<span class="keywordtype">float</span> zdest, TVector3 <a class="code" href="../../dc/de5/PHG4mRICHDetector_8cc.html#a10e6010f5f8222befd1273192d72ddf5">start</a>, <a class="code" href="../../d8/d64/classMultiArray.html">MultiArray&lt;TVector3&gt;</a> *field);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#aa99cdfc4fd947bfc8a90fd606bd78e2d">populate_fieldmap</a>();</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="comment">//now handled by setting &#39;analytic&#39; lookup:  void populate_analytic_fieldmap();</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a2f49f50c2bc4351587ab6cf8e660111e">populate_lookup</a>();</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a0860caf13830e3b6ffb63477e5d5d90d">populate_full3d_lookup</a>();</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a2bc090942421a5a9f185be13f2689d5a">populate_highres_lookup</a>();</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a8fcaff1d1d774fba15565f6990077ea0">populate_lowres_lookup</a>();</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a266e4d2f962db9ca8c4ff25d6a34a574">populate_phislice_lookup</a>();</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a621d21e9eeffb1498dd4b863d96f2566">load_phislice_lookup</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *sourcefile);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a72c5541a42b26e81855bac886333959b">save_phislice_lookup</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *destfile);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#a7e5bfbb3d32ab1733d1fa653cdacbc1b">sum_field_at</a>(<span class="keywordtype">int</span> r, <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a7b540384a61cacdec7528421fa0a22b2">phi</a>, <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a9593b8fc874ec60dacdcbeaec75a8235">z</a>);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#aaada41d72ff17cae02000b4bc9e4be15">sum_full3d_field_at</a>(<span class="keywordtype">int</span> r, <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a7b540384a61cacdec7528421fa0a22b2">phi</a>, <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a9593b8fc874ec60dacdcbeaec75a8235">z</a>);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#ad135dd5ff342110147544f8032671fb4">sum_local_field_at</a>(<span class="keywordtype">int</span> r, <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a7b540384a61cacdec7528421fa0a22b2">phi</a>, <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a9593b8fc874ec60dacdcbeaec75a8235">z</a>);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#a526ad468319e05b2cdbb37569c496048">sum_nonlocal_field_at</a>(<span class="keywordtype">int</span> r, <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a7b540384a61cacdec7528421fa0a22b2">phi</a>, <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a9593b8fc874ec60dacdcbeaec75a8235">z</a>);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#a4a7d310d527ef4d9b7ba5a986b996317">sum_phislice_field_at</a>(<span class="keywordtype">int</span> r, <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a7b540384a61cacdec7528421fa0a22b2">phi</a>, <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a9593b8fc874ec60dacdcbeaec75a8235">z</a>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#a5868eb5808ec182e9299bee9be6f5b0f">swimToInAnalyticSteps</a>(<span class="keywordtype">float</span> zdest, TVector3 <a class="code" href="../../dc/de5/PHG4mRICHDetector_8cc.html#a10e6010f5f8222befd1273192d72ddf5">start</a>, <span class="keywordtype">int</span> <a class="code" href="../../dc/dd5/namespacepropagation__timing.html#ac99fb9b6044121fe2ca6e5246c9103ac">steps</a>, <span class="keywordtype">int</span> *goodToStep);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#a53c9be7916f154aa611235bed094e700">swimToInSteps</a>(<span class="keywordtype">float</span> zdest, TVector3 <a class="code" href="../../dc/de5/PHG4mRICHDetector_8cc.html#a10e6010f5f8222befd1273192d72ddf5">start</a>, <span class="keywordtype">int</span> <a class="code" href="../../dc/dd5/namespacepropagation__timing.html#ac99fb9b6044121fe2ca6e5246c9103ac">steps</a>, <span class="keywordtype">bool</span> <a class="code" href="../../da/d7b/namespaceActs.html#a2d4349d85a14c2f358714e95dd15046c" title="performs linear interpolation inside a hyper box">interpolate</a>, <span class="keywordtype">int</span> *goodToStep);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#a648cbb510827b4a034ee3890be1cac1c">swimTo</a>(<span class="keywordtype">float</span> zdest, TVector3 <a class="code" href="../../dc/de5/PHG4mRICHDetector_8cc.html#a10e6010f5f8222befd1273192d72ddf5">start</a>, <span class="keywordtype">bool</span> <a class="code" href="../../da/d7b/namespaceActs.html#a2d4349d85a14c2f358714e95dd15046c" title="performs linear interpolation inside a hyper box">interpolate</a> = <span class="keyword">true</span>, <span class="keywordtype">bool</span> useAnalytic = <span class="keyword">false</span>);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#aaba67a669347f6693571910ffaca965f">GetStepDistortion</a>(<span class="keywordtype">float</span> zdest, TVector3 <a class="code" href="../../dc/de5/PHG4mRICHDetector_8cc.html#a10e6010f5f8222befd1273192d72ddf5">start</a>, <span class="keywordtype">bool</span> <a class="code" href="../../da/d7b/namespaceActs.html#a2d4349d85a14c2f358714e95dd15046c" title="performs linear interpolation inside a hyper box">interpolate</a> = <span class="keyword">true</span>, <span class="keywordtype">bool</span> useAnalytic = <span class="keyword">false</span>);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  TVector3 <a class="code" href="../../de/d64/classAnnularFieldSim.html#a005b9e2e1f8240557e47c19e9b76f6dd">GetTotalDistortion</a>(<span class="keywordtype">float</span> zdest, TVector3 <a class="code" href="../../dc/de5/PHG4mRICHDetector_8cc.html#a10e6010f5f8222befd1273192d72ddf5">start</a>, <span class="keywordtype">int</span> nsteps, <span class="keywordtype">bool</span> <a class="code" href="../../da/d7b/namespaceActs.html#a2d4349d85a14c2f358714e95dd15046c" title="performs linear interpolation inside a hyper box">interpolate</a> = <span class="keyword">true</span>, <span class="keywordtype">int</span> *goodToStep = 0);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; <span class="keyword">private</span>:</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <a class="code" href="../../de/d64/classAnnularFieldSim.html#a548d440aa514aa75d10b01b43dd3d563">BoundsCase</a> <a class="code" href="../../de/d64/classAnnularFieldSim.html#af41a4754a596a90505d15a5dcb1868a6">GetRindexAndCheckBounds</a>(<span class="keywordtype">float</span> <a class="code" href="../../dc/de5/PHG4mRICHDetector_8cc.html#a11ded6fc3d3fab0e72612c3886df87a0">pos</a>, <span class="keywordtype">int</span> *r);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <a class="code" href="../../de/d64/classAnnularFieldSim.html#a548d440aa514aa75d10b01b43dd3d563">BoundsCase</a> <a class="code" href="../../de/d64/classAnnularFieldSim.html#aab5dee891f7302176821ad489549a18f">GetPhiIndexAndCheckBounds</a>(<span class="keywordtype">float</span> <a class="code" href="../../dc/de5/PHG4mRICHDetector_8cc.html#a11ded6fc3d3fab0e72612c3886df87a0">pos</a>, <span class="keywordtype">int</span> *<a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a7b540384a61cacdec7528421fa0a22b2">phi</a>);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <a class="code" href="../../de/d64/classAnnularFieldSim.html#a548d440aa514aa75d10b01b43dd3d563">BoundsCase</a> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a004ad992d4f49f5aba99cd82b8983163">GetZindexAndCheckBounds</a>(<span class="keywordtype">float</span> <a class="code" href="../../dc/de5/PHG4mRICHDetector_8cc.html#a11ded6fc3d3fab0e72612c3886df87a0">pos</a>, <span class="keywordtype">int</span> *<a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a9593b8fc874ec60dacdcbeaec75a8235">z</a>);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#af04bf96017270868073f53e74f2b8a51">GetRindex</a>(<span class="keywordtype">float</span> <a class="code" href="../../dc/de5/PHG4mRICHDetector_8cc.html#a11ded6fc3d3fab0e72612c3886df87a0">pos</a>);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a3dbe4c497e36fd3bca32e7e821921178">GetPhiIndex</a>(<span class="keywordtype">float</span> <a class="code" href="../../dc/de5/PHG4mRICHDetector_8cc.html#a11ded6fc3d3fab0e72612c3886df87a0">pos</a>);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a012dc921d76beb8c5184b38b8c4577c5">GetZindex</a>(<span class="keywordtype">float</span> <a class="code" href="../../dc/de5/PHG4mRICHDetector_8cc.html#a11ded6fc3d3fab0e72612c3886df87a0">pos</a>);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div>
<div class="line"><a name="l00337"></a><span class="lineno"><a class="code" href="../../de/d64/classAnnularFieldSim.html#a5dc85e1b1849249dd359df0a32bd907c">  337</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/d64/classAnnularFieldSim.html#a5dc85e1b1849249dd359df0a32bd907c">UpdateOmegaTau</a>()</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <a class="code" href="../../de/d64/classAnnularFieldSim.html#ae94da38b14049881cc6c9e36b84a05d2">omegatau_nominal</a> = -<a class="code" href="../../de/d64/classAnnularFieldSim.html#ace424fdd41ee18b156ca4356cdfa736e">Bnominal</a> * <a class="code" href="../../de/d64/classAnnularFieldSim.html#ae83b1b7d69b7029daf8a9ed58314e5c1">vdrift</a> / <a class="code" href="../../df/d28/namespacekdfinder.html#ab72d428625e99a2d7380eb7691c246c7">abs</a>(<a class="code" href="../../de/d64/classAnnularFieldSim.html#a517b31827f7563eeb6c9c54182b5655e">Enominal</a>);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  };  <span class="comment">//various constants to match internal representation to the familiar formula.  Adding in these factors suggests I should switch to a unitful calculation throughout...</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;};</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="preprocessor">#ifndef MULTIARRAY</span></div>
<div class="line"><a name="l00345"></a><span class="lineno"><a class="code" href="../../dd/d5b/AnnularFieldSim_8h.html#aedf77230dc541e1081a2ded986835330">  345</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define MULTIARRAY</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="preprocessor"></span><span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="keyword">class </span><a class="code" href="../../d8/d64/classMultiArray.html">MultiArray</a> : <span class="keyword">public</span> <a class="code" href="../../d5/d0f/classTObject.html">TObject</a></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;{</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="comment">//class to hold an up-to-six dimensional array of whatever T is.  Any indices not used are flattened.  This should probably be replaced with sets of TH3s...</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00351"></a><span class="lineno"><a class="code" href="../../d8/d64/classMultiArray.html#a8207a9f3ec3a3a0ed5d1d87749a47025">  351</a></span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/d64/classMultiArray.html#a8207a9f3ec3a3a0ed5d1d87749a47025">MAX_DIM</a> = 6;</div>
<div class="line"><a name="l00352"></a><span class="lineno"><a class="code" href="../../d8/d64/classMultiArray.html#aaab5b8283679cdc82b497b3b377a04f1">  352</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d8/d64/classMultiArray.html#aaab5b8283679cdc82b497b3b377a04f1">dim</a>;</div>
<div class="line"><a name="l00353"></a><span class="lineno"><a class="code" href="../../d8/d64/classMultiArray.html#acdff37dff55c10d8b3259fa4bafcf3b5">  353</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d8/d64/classMultiArray.html#acdff37dff55c10d8b3259fa4bafcf3b5">n</a>[6];</div>
<div class="line"><a name="l00354"></a><span class="lineno"><a class="code" href="../../d8/d64/classMultiArray.html#a220148ee6e6282d90df84b0e615a3714">  354</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d8/d64/classMultiArray.html#a220148ee6e6282d90df84b0e615a3714">length</a>;</div>
<div class="line"><a name="l00355"></a><span class="lineno"><a class="code" href="../../d8/d64/classMultiArray.html#a6b7602228826a6a61c9892664422160a">  355</a></span>&#160;  <a class="code" href="../../d1/d76/Example_8C.html#ae4491b8907d9377ccca86937e81f2adf">T</a> *<a class="code" href="../../d8/d64/classMultiArray.html#a6b7602228826a6a61c9892664422160a">field</a>;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div>
<div class="line"><a name="l00357"></a><span class="lineno"><a class="code" href="../../d8/d64/classMultiArray.html#a7374005b4d29124011ca496fd4817e8c">  357</a></span>&#160;  <a class="code" href="../../d8/d64/classMultiArray.html#a7374005b4d29124011ca496fd4817e8c">MultiArray</a>(<span class="keywordtype">int</span> a = 0, <span class="keywordtype">int</span> b = 0, <span class="keywordtype">int</span> <a class="code" href="../../d4/d51/vector__math__inline_8h.html#ae0323a9039add2978bf5b49550572c7c">c</a> = 0, <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a891cb8c7054cada2d3d045543e5eea0e">d</a> = 0, <span class="keywordtype">int</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a">e</a> = 0, <span class="keywordtype">int</span> f = 0)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordtype">int</span> n_[6];</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="../../d8/d64/classMultiArray.html#a8207a9f3ec3a3a0ed5d1d87749a47025">MAX_DIM</a>; i++)</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <a class="code" href="../../d8/d64/classMultiArray.html#acdff37dff55c10d8b3259fa4bafcf3b5">n</a>[i] = 0;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    n_[0] = a;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    n_[1] = b;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    n_[2] = <a class="code" href="../../d4/d51/vector__math__inline_8h.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    n_[3] = <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a891cb8c7054cada2d3d045543e5eea0e">d</a>;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    n_[4] = <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a">e</a>;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    n_[5] = f;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <a class="code" href="../../d8/d64/classMultiArray.html#a220148ee6e6282d90df84b0e615a3714">length</a> = 1;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <a class="code" href="../../d8/d64/classMultiArray.html#aaab5b8283679cdc82b497b3b377a04f1">dim</a> = <a class="code" href="../../d8/d64/classMultiArray.html#a8207a9f3ec3a3a0ed5d1d87749a47025">MAX_DIM</a>;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="../../d8/d64/classMultiArray.html#aaab5b8283679cdc82b497b3b377a04f1">dim</a>; i++)</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <span class="keywordflow">if</span> (n_[i] &lt; 1)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        dim = i;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <a class="code" href="../../d8/d64/classMultiArray.html#acdff37dff55c10d8b3259fa4bafcf3b5">n</a>[i] = n_[i];</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <a class="code" href="../../d8/d64/classMultiArray.html#a220148ee6e6282d90df84b0e615a3714">length</a> *= <a class="code" href="../../d8/d64/classMultiArray.html#acdff37dff55c10d8b3259fa4bafcf3b5">n</a>[i];</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    }</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <a class="code" href="../../d8/d64/classMultiArray.html#a6b7602228826a6a61c9892664422160a">field</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="../../d1/d76/Example_8C.html#ae4491b8907d9377ccca86937e81f2adf">T</a> *<span class="keyword">&gt;</span>(malloc(<a class="code" href="../../d8/d64/classMultiArray.html#a220148ee6e6282d90df84b0e615a3714">length</a> * <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d76/Example_8C.html#ae4491b8907d9377ccca86937e81f2adf">T</a>)));</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="comment">//field=(T)( malloc(length*sizeof(T) ));</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="comment">//for (int i=0;i&lt;length;i++) field[i].SetXYZ(0,0,0);</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  }</div>
<div class="line"><a name="l00384"></a><span class="lineno"><a class="code" href="../../d8/d64/classMultiArray.html#ace1d5287ec5e923e44cb43b488ce8f71">  384</a></span>&#160;  <a class="code" href="../../d8/d64/classMultiArray.html#ace1d5287ec5e923e44cb43b488ce8f71">~MultiArray</a>()</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    free(<a class="code" href="../../d8/d64/classMultiArray.html#a6b7602228826a6a61c9892664422160a">field</a>);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div>
<div class="line"><a name="l00389"></a><span class="lineno"><a class="code" href="../../d8/d64/classMultiArray.html#a33bbe655697ef0d6b52428f200869917">  389</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d8/d64/classMultiArray.html#a33bbe655697ef0d6b52428f200869917">Add</a>(<span class="keywordtype">int</span> a, <span class="keywordtype">int</span> b, <span class="keywordtype">int</span> <a class="code" href="../../d4/d51/vector__math__inline_8h.html#ae0323a9039add2978bf5b49550572c7c">c</a>, <a class="code" href="../../d1/d76/Example_8C.html#ae4491b8907d9377ccca86937e81f2adf">T</a> <a class="code" href="../../d2/d84/Rossegger_8cc.html#ae4dfdc692656ae1d3de1367a50eb5af9">in</a>)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <a class="code" href="../../d8/d64/classMultiArray.html#a33bbe655697ef0d6b52428f200869917">Add</a>(a, b, c, 0, 0, 0, in);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  };</div>
<div class="line"><a name="l00394"></a><span class="lineno"><a class="code" href="../../d8/d64/classMultiArray.html#aaa2f06936252cfd73d8f1f8d460617f9">  394</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d8/d64/classMultiArray.html#a33bbe655697ef0d6b52428f200869917">Add</a>(<span class="keywordtype">int</span> a, <span class="keywordtype">int</span> b, <span class="keywordtype">int</span> <a class="code" href="../../d4/d51/vector__math__inline_8h.html#ae0323a9039add2978bf5b49550572c7c">c</a>, <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a891cb8c7054cada2d3d045543e5eea0e">d</a>, <span class="keywordtype">int</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a">e</a>, <span class="keywordtype">int</span> f, <a class="code" href="../../d1/d76/Example_8C.html#ae4491b8907d9377ccca86937e81f2adf">T</a> <a class="code" href="../../d2/d84/Rossegger_8cc.html#ae4dfdc692656ae1d3de1367a50eb5af9">in</a>)</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordtype">int</span> n_[6];</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    n_[0] = a;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    n_[1] = b;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    n_[2] = <a class="code" href="../../d4/d51/vector__math__inline_8h.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    n_[3] = <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a891cb8c7054cada2d3d045543e5eea0e">d</a>;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    n_[4] = <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a">e</a>;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    n_[5] = f;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordtype">int</span> index = n_[0];</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code" href="../../d8/d64/classMultiArray.html#aaab5b8283679cdc82b497b3b377a04f1">dim</a>; i++)</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      index = (index * <a class="code" href="../../d8/d64/classMultiArray.html#acdff37dff55c10d8b3259fa4bafcf3b5">n</a>[i]) + n_[i];</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    }</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <a class="code" href="../../d8/d64/classMultiArray.html#a6b7602228826a6a61c9892664422160a">field</a>[index] = <a class="code" href="../../d8/d64/classMultiArray.html#a6b7602228826a6a61c9892664422160a">field</a>[index] + <a class="code" href="../../d2/d84/Rossegger_8cc.html#ae4dfdc692656ae1d3de1367a50eb5af9">in</a>;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div>
<div class="line"><a name="l00412"></a><span class="lineno"><a class="code" href="../../d8/d64/classMultiArray.html#aec5a4ca1ee2a856a7574a75d6ad48568">  412</a></span>&#160;  <a class="code" href="../../d1/d76/Example_8C.html#ae4491b8907d9377ccca86937e81f2adf">T</a> <a class="code" href="../../d8/d64/classMultiArray.html#aec5a4ca1ee2a856a7574a75d6ad48568">Get</a>(<span class="keywordtype">int</span> a = 0, <span class="keywordtype">int</span> b = 0, <span class="keywordtype">int</span> <a class="code" href="../../d4/d51/vector__math__inline_8h.html#ae0323a9039add2978bf5b49550572c7c">c</a> = 0, <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a891cb8c7054cada2d3d045543e5eea0e">d</a> = 0, <span class="keywordtype">int</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a">e</a> = 0, <span class="keywordtype">int</span> f = 0)</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordtype">int</span> n_[6];</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    n_[0] = a;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    n_[1] = b;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    n_[2] = <a class="code" href="../../d4/d51/vector__math__inline_8h.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    n_[3] = <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a891cb8c7054cada2d3d045543e5eea0e">d</a>;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    n_[4] = <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a">e</a>;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    n_[5] = f;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordtype">int</span> index = 0;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="../../d8/d64/classMultiArray.html#aaab5b8283679cdc82b497b3b377a04f1">dim</a>; i++)</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d64/classMultiArray.html#acdff37dff55c10d8b3259fa4bafcf3b5">n</a>[i] &lt;= n_[i] || n_[i] &lt; 0)</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      {  <span class="comment">//check bounds</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <a class="code" href="../../da/d23/msg__buffer_8cc.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;asking for el %d %d %d %d %d %d.  %dth element is outside of bounds 0&lt;x&lt;%d\n&quot;</span>, n_[0], n_[1], n_[2], n_[3], n_[4], n_[5], n_[i], <a class="code" href="../../d8/d64/classMultiArray.html#acdff37dff55c10d8b3259fa4bafcf3b5">n</a>[i]);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        assert(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      }</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      index = (index * <a class="code" href="../../d8/d64/classMultiArray.html#acdff37dff55c10d8b3259fa4bafcf3b5">n</a>[i]) + n_[i];</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/d64/classMultiArray.html#a6b7602228826a6a61c9892664422160a">field</a>[index];</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  }</div>
<div class="line"><a name="l00433"></a><span class="lineno"><a class="code" href="../../d8/d64/classMultiArray.html#a10b5deef61719e49242efbfdbb34adda">  433</a></span>&#160;  <a class="code" href="../../d1/d76/Example_8C.html#ae4491b8907d9377ccca86937e81f2adf">T</a> *<a class="code" href="../../d8/d64/classMultiArray.html#a10b5deef61719e49242efbfdbb34adda">GetPtr</a>(<span class="keywordtype">int</span> a = 0, <span class="keywordtype">int</span> b = 0, <span class="keywordtype">int</span> <a class="code" href="../../d4/d51/vector__math__inline_8h.html#ae0323a9039add2978bf5b49550572c7c">c</a> = 0, <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a891cb8c7054cada2d3d045543e5eea0e">d</a> = 0, <span class="keywordtype">int</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a">e</a> = 0, <span class="keywordtype">int</span> f = 0)</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  {  <span class="comment">//faster for repeated access.</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordtype">int</span> n_[6];</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    n_[0] = a;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    n_[1] = b;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    n_[2] = <a class="code" href="../../d4/d51/vector__math__inline_8h.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    n_[3] = <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a891cb8c7054cada2d3d045543e5eea0e">d</a>;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    n_[4] = <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a">e</a>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    n_[5] = f;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordtype">int</span> index = n_[0];</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code" href="../../d8/d64/classMultiArray.html#aaab5b8283679cdc82b497b3b377a04f1">dim</a>; i++)</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      index = (index * <a class="code" href="../../d8/d64/classMultiArray.html#acdff37dff55c10d8b3259fa4bafcf3b5">n</a>[i]) + n_[i];</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">return</span> &amp;(<a class="code" href="../../d8/d64/classMultiArray.html#a6b7602228826a6a61c9892664422160a">field</a>[index]);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div>
<div class="line"><a name="l00450"></a><span class="lineno"><a class="code" href="../../d8/d64/classMultiArray.html#a9600359f6801c3b0df50fad25beea350">  450</a></span>&#160;  <a class="code" href="../../d1/d76/Example_8C.html#ae4491b8907d9377ccca86937e81f2adf">T</a> *<a class="code" href="../../d8/d64/classMultiArray.html#a9600359f6801c3b0df50fad25beea350">GetFlat</a>(<span class="keywordtype">int</span> a = 0)</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordflow">if</span> (a &gt;= <a class="code" href="../../d8/d64/classMultiArray.html#a220148ee6e6282d90df84b0e615a3714">length</a>) assert(<span class="keyword">false</span>);  <span class="comment">//check bounds</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">return</span> &amp;(<a class="code" href="../../d8/d64/classMultiArray.html#a6b7602228826a6a61c9892664422160a">field</a>[a]);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div>
<div class="line"><a name="l00456"></a><span class="lineno"><a class="code" href="../../d8/d64/classMultiArray.html#a724a354269ec724f79ab24f2c9210c28">  456</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d8/d64/classMultiArray.html#a724a354269ec724f79ab24f2c9210c28">Length</a>()</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/d64/classMultiArray.html#a220148ee6e6282d90df84b0e615a3714">length</a>;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno"><a class="code" href="../../d8/d64/classMultiArray.html#a0cf24ea8c5d6c9ae66222d7e32957890">  461</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d8/d64/classMultiArray.html#a0cf24ea8c5d6c9ae66222d7e32957890">Set</a>(<span class="keywordtype">int</span> a, <span class="keywordtype">int</span> b, <span class="keywordtype">int</span> <a class="code" href="../../d4/d51/vector__math__inline_8h.html#ae0323a9039add2978bf5b49550572c7c">c</a>, <a class="code" href="../../d1/d76/Example_8C.html#ae4491b8907d9377ccca86937e81f2adf">T</a> <a class="code" href="../../d2/d84/Rossegger_8cc.html#ae4dfdc692656ae1d3de1367a50eb5af9">in</a>)</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <a class="code" href="../../d8/d64/classMultiArray.html#a0cf24ea8c5d6c9ae66222d7e32957890">Set</a>(a, b, c, 0, 0, 0, in);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  };</div>
<div class="line"><a name="l00466"></a><span class="lineno"><a class="code" href="../../d8/d64/classMultiArray.html#a2367dadc6b2f1f53f4d1d4bb10bc779d">  466</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d8/d64/classMultiArray.html#a0cf24ea8c5d6c9ae66222d7e32957890">Set</a>(<span class="keywordtype">int</span> a, <span class="keywordtype">int</span> b, <span class="keywordtype">int</span> <a class="code" href="../../d4/d51/vector__math__inline_8h.html#ae0323a9039add2978bf5b49550572c7c">c</a>, <span class="keywordtype">int</span> <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a891cb8c7054cada2d3d045543e5eea0e">d</a>, <span class="keywordtype">int</span> <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a">e</a>, <span class="keywordtype">int</span> f, <a class="code" href="../../d1/d76/Example_8C.html#ae4491b8907d9377ccca86937e81f2adf">T</a> <a class="code" href="../../d2/d84/Rossegger_8cc.html#ae4dfdc692656ae1d3de1367a50eb5af9">in</a>)</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordtype">int</span> n_[6];</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    n_[0] = a;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    n_[1] = b;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    n_[2] = <a class="code" href="../../d4/d51/vector__math__inline_8h.html#ae0323a9039add2978bf5b49550572c7c">c</a>;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    n_[3] = <a class="code" href="../../dc/d49/HelixHough__allButKappaRange__sse_8cpp.html#a891cb8c7054cada2d3d045543e5eea0e">d</a>;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    n_[4] = <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a705fd87e8079f6d88222965eb977437a">e</a>;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    n_[5] = f;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordtype">int</span> index = n_[0];</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code" href="../../d8/d64/classMultiArray.html#aaab5b8283679cdc82b497b3b377a04f1">dim</a>; i++)</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    {</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      index = (index * <a class="code" href="../../d8/d64/classMultiArray.html#acdff37dff55c10d8b3259fa4bafcf3b5">n</a>[i]) + n_[i];</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <a class="code" href="../../d8/d64/classMultiArray.html#a6b7602228826a6a61c9892664422160a">field</a>[index] = <a class="code" href="../../d2/d84/Rossegger_8cc.html#ae4dfdc692656ae1d3de1367a50eb5af9">in</a>;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  }</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;};</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="preprocessor">#endif  //MULTIARRAY</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->

<!-- start footer part -->
<div id="nav-path" class="navpath">
	<!-- id is needed for treeview function! -->
	<ul>
		<li class="navelem"><a class="el" href="../../dir_1325c8421f54d819b2baf4988d0479c9.html">fun4all_coresoftware</a></li><li class="navelem"><a class="el" href="../../dir_08ec5ecddc4172fc9269dd44100f20c6.html">blob</a></li><li class="navelem"><a class="el" href="../../dir_a96d3b3a5a02e24c6d54dfcaf732524c.html">master</a></li><li class="navelem"><a class="el" href="../../dir_77bfddeb46c384ecc9fe3da2a56ade70.html">calibrations</a></li><li class="navelem"><a class="el" href="../../dir_03eabd864efad5b151876ef7c700c16c.html">tpc</a></li><li class="navelem"><a class="el" href="../../dir_6b44bc03a9630fe9b8ac0d7869eabc6d.html">generator</a></li><li class="navelem"><a class="el" href="../../dd/d5b/AnnularFieldSim_8h.html">AnnularFieldSim.h</a></li>
		<li class="footer">
		Built by <a href="mailto:jhuang@bnl.gov">Jin Huang</a></em>.
			updated: <em>Mon Jan 22 2024 12:43:38</em> using <a
			href="http://www.doxygen.org/index.html"> <img class="footer"
				src="../../doxygen.png" alt="doxygen" /></a> 1.8.2 
				with <a href="https://github.com/eic">EIC GitHub integration</a>
		</li>
	</ul>
</div>
</body>
</html>
