<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />
<title>EIC Software: EicRoot/blob/master/pid/PidCorr/PndPidCorrelator.cxx Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script> <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script> 
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-155388685-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-155388685-3');
</script>
</head>
<body>
	<div id="top">
		<!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectlogo"><a href="https://eic.github.io/"><img
								alt="Logo" src="../../ion-collision-xparent-crop.png" height="100"/></a></td>
						<td style="padding-left: 0.5em;">
							<div id="projectname">
								EIC Software
							</div> 
							<div id="projectbrief">
								Reference for 
								<a href="https://eic.github.io/">EIC</a> 
								<a href="https://github.com/eic/">simulation and reconstruction software on GitHub</a>
							</div> 
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Home&#160;page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../usergroup0.html"><span>External&#160;Links</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dd/dd9/PndPidCorrelator_8cxx_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">PndPidCorrelator.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../dd/dd9/PndPidCorrelator_8cxx.html">Go to the documentation of this file.</a> Or view <a target="top" href="https://github.com/eic/EicRoot/blob/master/pid/PidCorr/PndPidCorrelator.cxx">the newest version in sPHENIX GitHub for file PndPidCorrelator.cxx</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d35/PndDetectorList_8h.html">PndDetectorList.h</a>&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d32/PndPidCorrelator_8h.html">PndPidCorrelator.h</a>&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/de9/PndTrackID_8h.html">PndTrackID.h</a>&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/deb/PndMCTrack_8h.html">PndMCTrack.h</a>&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//#include &lt;EicIdealTrackingCode.h&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#if _TODAY_</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#include &quot;<a class="code" href="../../d6/d81/PndTrack_8h.html">PndTrack.h</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;PndSciTPoint.h&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;PndSciTHit.h&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;PndEmcBump.h&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;PndEmcDigi.h&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;PndEmcStructure.h&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;PndEmcXtal.h&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;PndEmcErrorMatrix.h&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;PndEmcClusterCalibrator.h&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;PndEmcClusterEnergySums.h&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;PndMdtPoint.h&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;PndMdtHit.h&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;PndMdtTrk.h&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;PndDrcBarPoint.h&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;PndDrcHit.h&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;PndDskParticle.h&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/df2/FairTrackParH_8h.html">FairTrackParH.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d59/FairMCApplication_8h.html">FairMCApplication.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/d7c/FairRunAna_8h.html">FairRunAna.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d92/FairRootManager_8h.html">FairRootManager.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/dac/FairRuntimeDb_8h.html">FairRuntimeDb.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;TObjArray.h&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;TVector3.h&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;TGeoMatrix.h&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;TGeoManager.h&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;TSystem.h&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">// ----------------------------------------------------------</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">// --- Interface with PidMaker and output ---</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">//___________________________________________________________</span></div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="code" href="../../dd/d8c/classPndPidCorrelator.html#abb821e0ce071257700f1840bc9b018da">   48</a></span>&#160;<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#abb821e0ce071257700f1840bc9b018da">PndPidCorrelator::~PndPidCorrelator</a>() </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;{</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <a class="code" href="../../d0/d6c/classFairRootManager.html">FairRootManager</a> *fManager =<a class="code" href="../../d0/d6c/classFairRootManager.html#a830b7803b29e7424a75f2dc374dcc96b">FairRootManager::Instance</a>();</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#a8b1f6e033453b12c001e58ff7a9ee896">Write</a>();</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#if _TODAY_</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor"></span>  <span class="keyword">delete</span> fEmcErrorMatrix; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor"></span>}</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//___________________________________________________________</span></div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a6ba682a19d0ec4388914ec72d636198d">   59</a></span>&#160;<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a6ba682a19d0ec4388914ec72d636198d">PndPidCorrelator::PndPidCorrelator</a>(<span class="comment">/*EicIdealTrackingCode *ideal*/</span>) : </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <a class="code" href="../../d2/d9e/classFairTask.html">FairTask</a>(),</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  fTrackBranch(<span class="stringliteral">&quot;EicIdealGenTrack&quot;</span>),</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  fTrackIDBranch(<span class="stringliteral">&quot;EicIdealGenTrackID&quot;</span>), </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  fTrack(new TClonesArray()),</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  fTrackOutBranch(<span class="stringliteral">&quot;&quot;</span>),</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  fIdealHyp(kFALSE),</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  fCorrErrorProp(kTRUE),</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  fGeanePro(kTRUE),</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  fMcTrack(new TClonesArray()),</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  fPidHyp(0)<span class="comment">/*, </span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">        fIdeal(ideal)*/</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;#if _TODAY_</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;, ,, fTrackID(new TClonesArray()), fTrack2(new TClonesArray()), fTrackID2(new TClonesArray()), fPidChargedCand(new TClonesArray()), fPidNeutralCand(new TClonesArray()), fMdtTrack(new TClonesArray()), fMvdHitsStrip(new TClonesArray()), fMvdHitsPixel(new TClonesArray()), fTofHit(new TClonesArray()), fTofPoint(new TClonesArray()), fFtofHit(new TClonesArray()), fFtofPoint(new TClonesArray()), fEmcCluster(new TClonesArray()), fEmcBump(new TClonesArray()), fEmcDigi(new TClonesArray()), fMdtPoint(new TClonesArray()), fMdtHit(new TClonesArray()), fMdtTrk(new TClonesArray()), fDrcPoint(new TClonesArray()), fDrcHit(new TClonesArray()), fDskParticle(new TClonesArray()), fSttHit(new TClonesArray()), fFtsHit(new TClonesArray()), </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  fCorrPar(new PndPidCorrPar()), fEmcGeoPar(new PndEmcGeoPar()), fEmcErrorMatrixPar(new PndEmcErrorMatrixPar()), fEmcErrorMatrix(new PndEmcErrorMatrix()), fSttParameters(new PndGeoSttPar()), fEmcCalibrator(NULL), fEmcClstCount(0), fFscClstCount(0),</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  fDebugMode(kFALSE),</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  fMdtRefit(kFALSE),</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  fMvdMode(-1),</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  fSttMode(-1),</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  fFtsMode(-1),</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  fTofMode(-1), </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  fFtofMode(-1),</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  fEmcMode(-1),</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  fMdtMode(-1), </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  fDrcMode(-1),</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  fDskMode(-1),</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  fMixMode(kFALSE),</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  fFast(kFALSE),</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  fSimulation(kFALSE),</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  fIdeal(kFALSE), </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  tofCorr(0),</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  emcCorr(0), </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  fscCorr(0),</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  drcCorr(0),</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  dskCorr(0),</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  fTrackBranch2(<span class="stringliteral">&quot;&quot;</span>),</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  fTrackIDBranch2(<span class="stringliteral">&quot;&quot;</span>),</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  sDir(<span class="stringliteral">&quot;&quot;</span>),</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  sFile(<span class="stringliteral">&quot;&quot;</span>),</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  fGeoH(NULL),</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  fClusterList(), </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  fClusterQ(),</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  mapMdtBarrel(),</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  mapMdtEndcap(),</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  mapMdtForward()</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;#endif</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;{</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#af9bfe67c10fb5056e1ee1234d0d4ab08" title="PndTrackID TCA.">fPidChargedCand</a> = <span class="keyword">new</span> TClonesArray(<span class="stringliteral">&quot;PndPidCandidate&quot;</span>);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad56f3d2159499bb90c18bfeb35156d42">sDir</a> = <span class="stringliteral">&quot;./&quot;</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#accbfd0cfbdacd0d6f757703df00249cc">sFile</a> = <span class="stringliteral">&quot;./pidcorrelator.root&quot;</span>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a4b4e83428fd94997823ccfc48bb0c768">fGeoH</a> = <a class="code" href="../../d1/d76/classPndGeoHandling.html#ada66633b706490fa2d5c61d670243b06">PndGeoHandling::Instance</a>();</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">#if _TODAY_</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor"></span>  <span class="comment">//---</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  fPidNeutralCand = <span class="keyword">new</span> TClonesArray(<span class="stringliteral">&quot;PndPidCandidate&quot;</span>);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="comment">// Resetting MDT geometry parameters</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordflow">for</span> (Int_t <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a44fb500abc41c8b4d2937824ad76f8bd">mm</a>=0; <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a44fb500abc41c8b4d2937824ad76f8bd">mm</a>&lt;3; <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a44fb500abc41c8b4d2937824ad76f8bd">mm</a>++)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">for</span> (Int_t ll=0; ll&lt;20;ll++)</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  mdtLayerPos[<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a44fb500abc41c8b4d2937824ad76f8bd">mm</a>][ll] = -1;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  mdtIronThickness[<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a44fb500abc41c8b4d2937824ad76f8bd">mm</a>][ll] = -1;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#adba4c855b67ae00ebfffc42364ff6726">Reset</a>();</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="preprocessor">#if _TODAY_</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="preprocessor"></span><span class="comment">//___________________________________________________________</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a6ba682a19d0ec4388914ec72d636198d">PndPidCorrelator::PndPidCorrelator</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d3/d16/VstRadLength_8C.html#a5ac083a645d964373f022d03df4849c8">name</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../df/d6b/title_8f.html#aa5c036d373cd37c00f0892e713b39988">title</a>) :</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <a class="code" href="../../d2/d9e/classFairTask.html">FairTask</a>(name),</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  fMcTrack(new TClonesArray()), fTrack(new TClonesArray()), fTrackID(new TClonesArray()), fTrack2(new TClonesArray()), fTrackID2(new TClonesArray()), fPidChargedCand(new TClonesArray()), fPidNeutralCand(new TClonesArray()), fMdtTrack(new TClonesArray()), fMvdHitsStrip(new TClonesArray()), fMvdHitsPixel(new TClonesArray()), fTofHit(new TClonesArray()), fTofPoint(new TClonesArray()), fFtofHit(new TClonesArray()), fFtofPoint(new TClonesArray()), fEmcCluster(new TClonesArray()), fEmcBump(new TClonesArray()), fEmcDigi(new TClonesArray()), fMdtPoint(new TClonesArray()), fMdtHit(new TClonesArray()), fMdtTrk(new TClonesArray()), fDrcPoint(new TClonesArray()), fDrcHit(new TClonesArray()), fDskParticle(new TClonesArray()), fSttHit(new TClonesArray()), fFtsHit(new TClonesArray()), </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  fCorrPar(new PndPidCorrPar()), fEmcGeoPar(new PndEmcGeoPar()), fEmcErrorMatrixPar(new PndEmcErrorMatrixPar()), fEmcErrorMatrix(new PndEmcErrorMatrix()), fSttParameters(new PndGeoSttPar()), fEmcCalibrator(NULL), fEmcClstCount(0), fFscClstCount(0),</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  fDebugMode(kFALSE),</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  fGeanePro(kTRUE), </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  fMdtRefit(kFALSE),</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  fMvdMode(-1),</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  fSttMode(-1), </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  fFtsMode(-1),</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  fTofMode(-1), </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  fFtofMode(-1),</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  fEmcMode(-1),</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  fMdtMode(-1), </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  fDrcMode(-1),</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  fDskMode(-1),</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  fMixMode(kFALSE),</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  fPidHyp(0),</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  fIdealHyp(kFALSE), </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  fFast(kFALSE),</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  fSimulation(kFALSE),</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  fIdeal(kFALSE), </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  fCorrErrorProp(kTRUE),</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  tofCorr(0),</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  emcCorr(0), </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  fscCorr(0),</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  drcCorr(0),</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  dskCorr(0),</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  fTrackBranch(<span class="stringliteral">&quot;&quot;</span>),</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  fTrackIDBranch(<span class="stringliteral">&quot;&quot;</span>),</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  fTrackBranch2(<span class="stringliteral">&quot;&quot;</span>),</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  fTrackIDBranch2(<span class="stringliteral">&quot;&quot;</span>),</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  fTrackOutBranch(<span class="stringliteral">&quot;&quot;</span>),</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  sDir(<span class="stringliteral">&quot;&quot;</span>),</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  sFile(<span class="stringliteral">&quot;&quot;</span>),</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  fGeoH(NULL),</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  fClusterList(), </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  fClusterQ(),</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  mapMdtBarrel(),</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  mapMdtEndcap(),</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  mapMdtForward()</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;{</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="comment">//---</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#af9bfe67c10fb5056e1ee1234d0d4ab08" title="PndTrackID TCA.">fPidChargedCand</a> = <span class="keyword">new</span> TClonesArray(<span class="stringliteral">&quot;PndPidCandidate&quot;</span>);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  fPidNeutralCand = <span class="keyword">new</span> TClonesArray(<span class="stringliteral">&quot;PndPidCandidate&quot;</span>);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad56f3d2159499bb90c18bfeb35156d42">sDir</a> = <span class="stringliteral">&quot;./&quot;</span>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#accbfd0cfbdacd0d6f757703df00249cc">sFile</a> = <span class="stringliteral">&quot;./pidcorrelator.root&quot;</span>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a4b4e83428fd94997823ccfc48bb0c768">fGeoH</a> = <a class="code" href="../../d1/d76/classPndGeoHandling.html#ada66633b706490fa2d5c61d670243b06">PndGeoHandling::Instance</a>(); </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="comment">// Resetting MDT geometry parameters</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordflow">for</span> (Int_t <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a44fb500abc41c8b4d2937824ad76f8bd">mm</a>=0; <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a44fb500abc41c8b4d2937824ad76f8bd">mm</a>&lt;3; <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a44fb500abc41c8b4d2937824ad76f8bd">mm</a>++)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">for</span> (Int_t ll=0; ll&lt;20;ll++)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  mdtLayerPos[<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a44fb500abc41c8b4d2937824ad76f8bd">mm</a>][ll] = -1;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  mdtIronThickness[<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a44fb500abc41c8b4d2937824ad76f8bd">mm</a>][ll] = -1;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#adba4c855b67ae00ebfffc42364ff6726">Reset</a>();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;}</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">//___________________________________________________________</span></div>
<div class="line"><a name="l00194"></a><span class="lineno"><a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a69bd198a35b7199b60b8b56b1501dd5c">  194</a></span>&#160;<a class="code" href="../../d8/d44/FairTask_8h.html#ac29def3095b23bd5d68cec73adacbf4c">InitStatus</a> <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a69bd198a35b7199b60b8b56b1501dd5c">PndPidCorrelator::Init</a>() {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">//  cout &lt;&lt; &quot;InitStatus PndPidCorrelator::Init()&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <a class="code" href="../../d0/d6c/classFairRootManager.html">FairRootManager</a> *fManager =<a class="code" href="../../d0/d6c/classFairRootManager.html#a830b7803b29e7424a75f2dc374dcc96b">FairRootManager::Instance</a>(); </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#aa1341eb4656ff630e812d2b44d360e03">fTrack</a> = (TClonesArray *)fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a10a1e48f1a51345cc21497386e0a4871" title="PndMCTrack TCA.">fTrackBranch</a>);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keywordflow">if</span> ( ! <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#aa1341eb4656ff630e812d2b44d360e03">fTrack</a> ) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: No PndTrack array!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/d44/FairTask_8h.html#ac29def3095b23bd5d68cec73adacbf4cac87213591a63e8e81fe2dd59e8aa46c1">kERROR</a>;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a0edd64376bb11506de6faa7e914ff9cf">fTrackIDBranch</a>!=<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a62f958668d5abee110e8cfc82ac07248" title="PndTrack TCA.">fTrackID</a> = (TClonesArray *)fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a0edd64376bb11506de6faa7e914ff9cf">fTrackIDBranch</a>);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keywordflow">if</span> ( ! <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a62f958668d5abee110e8cfc82ac07248" title="PndTrack TCA.">fTrackID</a> ) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: No PndTrackID array! Switching MC propagation OFF&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a0edd64376bb11506de6faa7e914ff9cf">fTrackIDBranch</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="preprocessor">#if _TODAY_  </span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> (fTrackBranch2!=<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      fTrack2 = (TClonesArray *)fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(fTrackBranch2);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="keywordflow">if</span> ( ! fTrack2 ) {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: No 2nd PndTrack array!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d8/d44/FairTask_8h.html#ac29def3095b23bd5d68cec73adacbf4cac87213591a63e8e81fe2dd59e8aa46c1">kERROR</a>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordflow">if</span> (fTrackIDBranch2!=<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      fTrackID2 = (TClonesArray *)fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(fTrackIDBranch2);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="keywordflow">if</span> ( ! fTrackID2 ) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: No 2nd PndTrackID array! Switching MC propagation OFF&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  fTrackIDBranch2 = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="comment">// *** STT ***</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordflow">if</span> (fSttMode)</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keywordflow">if</span> (fMixMode==kFALSE)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    fSttHit = (TClonesArray*) fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(<span class="stringliteral">&quot;STTHit&quot;</span>);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">if</span> ( fSttHit ) </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Using STTHit&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        fSttMode = 2;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;-W- PndPidCorrelator::Init: No STT hits array! Switching STT OFF&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        fSttMode = 0;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      } </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    fSttHit = (TClonesArray*) fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(<span class="stringliteral">&quot;STTHitMix&quot;</span>);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">if</span> ( fSttHit )</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      {</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Using STTHitMix&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        fSttMode = 2;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;-W- PndPidCorrelator::Init: No STT hits mix array! Switching STT OFF&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        fSttMode = 0;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="comment">// *** FTS ***</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keywordflow">if</span> (fFtsMode)</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <span class="keywordflow">if</span> (fMixMode==kFALSE)</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    fFtsHit = (TClonesArray*) fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(<span class="stringliteral">&quot;FTSHit&quot;</span>);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">if</span> ( fFtsHit ) </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Using FTSHit&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        fFtsMode = 2;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;-W- PndPidCorrelator::Init: No FTS hits array! Switching FTS OFF&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        fFtsMode = 0;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      } </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    fFtsHit = (TClonesArray*) fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(<span class="stringliteral">&quot;FTSHitMix&quot;</span>);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">if</span> ( fFtsHit )</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Using FTSHitMix&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        fFtsMode = 2;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;-W- PndPidCorrelator::Init: No FTS hits mix array! Switching FTS OFF&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        fFtsMode = 0;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="comment">// *** MVD ***</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordflow">if</span> (fMvdMode)</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <span class="keywordflow">if</span> (fMixMode==kFALSE)</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    fMvdHitsStrip = (TClonesArray*) fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(<span class="stringliteral">&quot;MVDHitsStrip&quot;</span>);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">if</span> ( ! fMvdHitsStrip ) </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;-W- PndPidCorrelator::Init: No MVDHitsStrip array!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">else</span> fMvdMode = 2;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    fMvdHitsPixel = (TClonesArray*) fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(<span class="stringliteral">&quot;MVDHitsPixel&quot;</span>);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">if</span> ( ! fMvdHitsPixel ) </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;-W- PndPidCorrelator::Init: No MVDHitsPixel array!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordflow">else</span> fMvdMode = 2;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    fMvdHitsStrip = (TClonesArray*) fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(<span class="stringliteral">&quot;MVDHitsStripMix&quot;</span>);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">if</span> ( ! fMvdHitsStrip )</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;-W- PndPidCorrelator::Init: No MVDHitsStripMix array!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">else</span> fMvdMode = 2;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    fMvdHitsPixel = (TClonesArray*) fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(<span class="stringliteral">&quot;MVDHitsPixelMix&quot;</span>);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">if</span> ( ! fMvdHitsPixel )</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;-W- PndPidCorrelator::Init: No MVDHitsPixelMix array!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">else</span> fMvdMode = 2;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="keywordflow">if</span> (( ! fMvdHitsStrip ) &amp;&amp;  ( ! fMvdHitsPixel ))</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-W- PndPidCorrelator::Init: No MVD hits array! Switching MVD OFF&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    fMvdMode = 0;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Using MVDHit&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  }</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="comment">// *** TOF ***</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="keywordflow">if</span> (fTofMode)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      fTofHit = (TClonesArray*) fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(<span class="stringliteral">&quot;SciTHit&quot;</span>);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="keywordflow">if</span> ( ! fTofHit ) </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-W- PndPidCorrelator::Init: No SciTHit array!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    fTofMode = 0;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="keywordflow">else</span>  </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Using SciTHit&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    fTofMode = 2;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordflow">if</span> (fIdeal)</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        fTofPoint = (TClonesArray*) fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(<span class="stringliteral">&quot;SciTPoint&quot;</span>);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keywordflow">if</span> ( ! fTofPoint )</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;          {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot;-W- PndPidCorrelator::Init: No SciTPoint array!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            fTofMode = 0;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;          }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    }</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="comment">// *** FTOF ***</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keywordflow">if</span> (fFtofMode)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      fFtofHit = (TClonesArray*) fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(<span class="stringliteral">&quot;FtofHit&quot;</span>);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="keywordflow">if</span> ( ! fFtofHit ) </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-W- PndPidCorrelator::Init: No FtofHit array!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    fFtofMode = 0;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  }</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <span class="keywordflow">else</span>  </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Using FtofHit&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    fFtofMode = 2;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">if</span> (fIdeal)</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        fFtofPoint = (TClonesArray*) fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(<span class="stringliteral">&quot;FtofPoint&quot;</span>);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="keywordflow">if</span> ( ! fFtofPoint )</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;          {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot;-W- PndPidCorrelator::Init: No FtofPoint array!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            fFtofMode = 0;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;          }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="comment">// *** EMC ***</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keywordflow">if</span> (fEmcMode)</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      fEmcCluster = (TClonesArray*) fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(<span class="stringliteral">&quot;EmcCluster&quot;</span>);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="keywordflow">if</span> ( ! fEmcCluster ) </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-W- PndPidCorrelator::Init: No EmcCluster array!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    fEmcMode = 0;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <span class="keywordflow">else</span> </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Using EmcCluster&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    fEmcMode = 2;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      fEmcBump = (TClonesArray*) fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(<span class="stringliteral">&quot;EmcBump&quot;</span>);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <span class="keywordflow">if</span> ( ! fEmcBump ) </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-W- PndPidCorrelator::Init: No EmcBump array!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <span class="keywordflow">else</span> </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Using EmcBump&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    fEmcMode = 3;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  }   </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      fEmcDigi = (TClonesArray*) fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(<span class="stringliteral">&quot;EmcDigi&quot;</span>);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="keywordflow">if</span> ( ! fEmcDigi)</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;          cout &lt;&lt; <span class="stringliteral">&quot;-W- PndPidCorrelator::Init: No EmcDigi array! No EMC E1/E9/E25 information is propagated!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    }</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="comment">// *** DRC ***</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="keywordflow">if</span> (fDrcMode)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      fDrcHit = (TClonesArray*) fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(<span class="stringliteral">&quot;DrcHit&quot;</span>);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <span class="keywordflow">if</span> ( ! fDrcHit ) </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-W- PndPidCorrelator::Init: No DrcHit array!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    fDrcMode = 0;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="keywordflow">else</span>  </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Using DrcHit&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    fDrcMode = 2;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  }</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="comment">// *** DSK ***</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="keywordflow">if</span> (fDskMode)</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      fDskParticle = (TClonesArray*) fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(<span class="stringliteral">&quot;DskParticle&quot;</span>);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <span class="keywordflow">if</span> ( ! fDskParticle )</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-W- PndPidCorrelator::Init: No DskParticle array!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    fDskMode = 0;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Using DskParticle&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    fDskMode = 2;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="comment">// *** MDT ***</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keywordflow">if</span> (fMdtMode)</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      fMdtHit = (TClonesArray*) fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(<span class="stringliteral">&quot;MdtHit&quot;</span>);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <span class="keywordflow">if</span> ( ! fMdtHit ) </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-W- PndPidCorrelator::Init: No MdtHit array!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    fMdtMode = 0;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <span class="keywordflow">else</span>  </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Using MdtHit&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    fMdtMode = 2;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      fMdtTrk = (TClonesArray*) fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(<span class="stringliteral">&quot;MdtTrk&quot;</span>);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <span class="keywordflow">if</span> ( ! fMdtTrk ) </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  {</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-W- PndPidCorrelator::Init: No MdtTrk array!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      <span class="keywordflow">else</span>  </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Using MdtTrk&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    fMdtMode = 3;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  }</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    }</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keywordflow">if</span> (fIdeal)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Using MonteCarlo correlation&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      fTofPoint = (TClonesArray*) fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(<span class="stringliteral">&quot;TofPoint&quot;</span>);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <span class="keywordflow">if</span> ( ! fTofPoint ) </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-W- PndPidCorrelator::Init: No TofPoint array!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    fTofMode = 0;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  }</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      <span class="keywordflow">else</span>  </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Using TofPoint&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      fDrcPoint = (TClonesArray*) fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(<span class="stringliteral">&quot;DrcBarPoint&quot;</span>);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      <span class="keywordflow">if</span> ( ! fDrcPoint ) </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-W- PndPidCorrelator::Init: No DrcBarPoint array!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    fDrcMode = 0;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  }</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <span class="keywordflow">else</span>  </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Using DrcPoint&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  }</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      fMdtPoint = (TClonesArray*) fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(<span class="stringliteral">&quot;MdtPoint&quot;</span>);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <span class="keywordflow">if</span> ( ! fMdtPoint ) </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-W- PndPidCorrelator::Init: No MdtPoint array!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    fMdtMode = 0;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      <span class="keywordflow">else</span>  </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Using MdtPoint&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  }</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    }</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="preprocessor"></span>  </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a567b99ae8ac84b12d7431bde711cd48c">Register</a>();</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="preprocessor">#if _TODAY_  </span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="preprocessor"></span>  fCorrPar-&gt;printParams();</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="preprocessor"></span>  </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a0923736cb5697a5e1f9236d512340f5e">fGeanePro</a>)</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    { </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Using Geane for Track propagation&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#afa5d1c9a95012384c31c423dad1cd21c">fCorrErrorProp</a>)</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  {</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Switching OFF Geane error propagation&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  }</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a233468ad4c71ae7a4c6bea9c9411dd4a">fIdealHyp</a>)</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ac9bec857ea07ca373ca441a4c3f52819" title="PndPidCandidate TCA for charged particles.">fMcTrack</a> = (TClonesArray *)fManager-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#abbbec76c83bcd0e1b78bef3c54e178eb">GetObject</a>(<span class="stringliteral">&quot;MCTrack&quot;</span>);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordflow">if</span> ( ! <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ac9bec857ea07ca373ca441a4c3f52819" title="PndPidCandidate TCA for charged particles.">fMcTrack</a> ) {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: No PndMcTrack array! No ideal pid hypothesis is possible!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d8/d44/FairTask_8h.html#ac29def3095b23bd5d68cec73adacbf4cac87213591a63e8e81fe2dd59e8aa46c1">kERROR</a>;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a0edd64376bb11506de6faa7e914ff9cf">fTrackIDBranch</a>==<span class="stringliteral">&quot;&quot;</span>) {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: No TrackID Branch name! No ideal pid hypothesis is possible!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d8/d44/FairTask_8h.html#ac29def3095b23bd5d68cec73adacbf4cac87213591a63e8e81fe2dd59e8aa46c1">kERROR</a>;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    }</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  {</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="../../df/d28/namespacekdfinder.html#ab72d428625e99a2d7380eb7691c246c7">abs</a>(<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a>))</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: No PID set -&gt; Using default PION hypothesis&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a> = 211;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      <span class="keywordflow">case</span> 11:</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Using ELECTRON hypothesis&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a> = -11;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <span class="keywordflow">case</span> 13:</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Using MUON hypothesis&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a> = -13;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <span class="keywordflow">case</span> 211:</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Using PION hypothesis&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a> = 211;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      <span class="keywordflow">case</span> 321:</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Using KAON hypothesis&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a> = 321;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="keywordflow">case</span> 2212:</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Using PROTON hypothesis&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a> = 2212;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Not recognised PID set -&gt; Using default PION hypothesis&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a> = 211;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  }</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    }</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d8/d44/FairTask_8h.html#ac29def3095b23bd5d68cec73adacbf4caa01f1050ac3a41808a5320edc5c2db13">kFATAL</a>;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    }</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="preprocessor">#if _TODAY_  </span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> (fMdtMode&gt;0)</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    {</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <span class="keywordflow">if</span> (!MdtGeometry())</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  {</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-W- PndPidCorrelator::Init: No MDT geometry ???&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    fMdtMode = 0;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  }</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    }</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keywordflow">if</span>   (fMdtRefit)</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    {</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      fFitter = <span class="keyword">new</span> <a class="code" href="../../db/d6d/classPndRecoKalmanFit.html">PndRecoKalmanFit</a>();</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      fFitter-&gt;SetGeane(<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a0923736cb5697a5e1f9236d512340f5e">fGeanePro</a>);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      fFitter-&gt;SetNumIterations(1);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <span class="keywordflow">if</span> (!fFitter-&gt;Init()) <span class="keywordflow">return</span> <a class="code" href="../../d8/d44/FairTask_8h.html#ac29def3095b23bd5d68cec73adacbf4caa01f1050ac3a41808a5320edc5c2db13">kFATAL</a>;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    } </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="keywordflow">if</span> (fDebugMode)</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    {</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      r = TFile::Open(<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad56f3d2159499bb90c18bfeb35156d42">sDir</a>+<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#accbfd0cfbdacd0d6f757703df00249cc">sFile</a>,<span class="stringliteral">&quot;RECREATE&quot;</span>);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      tofCorr = <span class="keyword">new</span> TNtuple(<span class="stringliteral">&quot;tofCorr&quot;</span>,<span class="stringliteral">&quot;TRACK-TOF Correlation&quot;</span>,</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;          <span class="stringliteral">&quot;track_x:track_y:track_z:track_phi:track_p:track_charge:track_theta:track_z0:tof_x:tof_y:tof_z:tof_phi:chi2:dphi:len:glen&quot;</span>);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      ftofCorr = <span class="keyword">new</span> TNtuple(<span class="stringliteral">&quot;ftofCorr&quot;</span>,<span class="stringliteral">&quot;TRACK-FTOF Correlation&quot;</span>,</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                            <span class="stringliteral">&quot;track_x:track_y:track_z:ver_x:ver_y:ver_z:ver_px:ver_py:ver_pz:track_p:track_charge:track_theta:track_z0:tof_x:tof_y:tof_z:chi2:len:glen:tlen&quot;</span>);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      emcCorr = <span class="keyword">new</span> TNtuple(<span class="stringliteral">&quot;emcCorr&quot;</span>,<span class="stringliteral">&quot;TRACK-EMC Correlation&quot;</span>,</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;          <span class="stringliteral">&quot;track_x:track_y:track_z:track_phi:track_p:track_charge:track_theta:track_z0:emc_x:emc_y:emc_z:emc_phi:chi2:dphi:emc_ene:glen:emc_mod&quot;</span>);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      fscCorr = <span class="keyword">new</span> TNtuple(<span class="stringliteral">&quot;fscCorr&quot;</span>,<span class="stringliteral">&quot;TRACK-FSC Correlation&quot;</span>,</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;          <span class="stringliteral">&quot;track_x:track_y:track_z:track_phi:track_p:track_charge:track_theta:track_z0:emc_x:emc_y:emc_z:emc_phi:chi2:dphi:emc_ene:glen:emc_mod&quot;</span>);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      mdtCorr = <span class="keyword">new</span> TNtuple(<span class="stringliteral">&quot;mdtCorr&quot;</span>,<span class="stringliteral">&quot;TRACK-MDT Correlation&quot;</span>,</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;          <span class="stringliteral">&quot;track_x:track_y:track_z:track_dx:track_dy:track_dz:track_phi:track_p:track_charge:track_theta:track_z0:mdt_x:mdt_y:mdt_z:mdt_phi:mdt_p:chi2:mdt_mod:dphi:glen:mdt_count:nhits&quot;</span>);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      drcCorr = <span class="keyword">new</span> TNtuple(<span class="stringliteral">&quot;drcCorr&quot;</span>,<span class="stringliteral">&quot;TRACK-DRC Correlation&quot;</span>,</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;          <span class="stringliteral">&quot;track_x:track_y:track_z:track_phi:track_p:track_charge:track_theta:track_z0:drc_x:drc_y:drc_phi:chi2:drc_thetac:drc_nphot:dphi:glen:flag&quot;</span>);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      dskCorr = <span class="keyword">new</span> TNtuple(<span class="stringliteral">&quot;dskCorr&quot;</span>,<span class="stringliteral">&quot;TRACK-DSK Correlation&quot;</span>,</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;          <span class="stringliteral">&quot;track_x:track_y:track_z:track_phi:track_p:track_charge:track_theta:track_z0:dsk_x:dsk_y:dsk_z:dsk_phi:chi2:dsk_thetac:dsk_nphot:dphi:glen:track_lx:track_ly:track_lz:track_xp:flag&quot;</span>);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Filling Debug histograms&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    }</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="comment">// Set Parameters for Emc error matrix </span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <span class="keywordflow">if</span> (fEmcMode&gt;0) </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">if</span> (fEmcErrorMatrixPar-&gt;IsValid())</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        fEmcErrorMatrix-&gt;Init(fEmcErrorMatrixPar-&gt;GetParObject());</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="comment">//std::cout&lt;&lt;&quot;PndPidCorrelator: Emc error matrix is read from RTDB&quot;&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        Int_t emcGeomVersion=fEmcGeoPar-&gt;GetGeometryVersion();</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        fEmcErrorMatrix-&gt;InitFromFile(emcGeomVersion);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        fEmcErrorMatrixPar-&gt;SetErrorMatrixObject(fEmcErrorMatrix-&gt;GetParObject());</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        <span class="comment">//std::cout&lt;&lt;&quot;PndPidCorrelator: Emc error matrix is read from file&quot;&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      }</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    fEmcCalibrator= PndEmcClusterCalibrator::MakeEmcClusterCalibrator(2, 1);  </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  }</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordflow">if</span> (fFast)  cout &lt;&lt; <span class="stringliteral">&quot;-W- PndPidCorrelator::Init: Using fast correlator!!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="preprocessor"></span>    </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::Init: Success!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad24f3291ff08e5459b0e096e985518a3">fEventCounter</a> = 1;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d8/d44/FairTask_8h.html#ac29def3095b23bd5d68cec73adacbf4cafa564a89be7228b8e404430df2d6d06c">kSUCCESS</a>;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;}</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">//______________________________________________________</span></div>
<div class="line"><a name="l00661"></a><span class="lineno"><a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a881a7bf36452bd1e6dda90459f7dc9c5">  661</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a881a7bf36452bd1e6dda90459f7dc9c5">PndPidCorrelator::SetParContainers</a>() {</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="preprocessor">#if _TODAY_  </span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="preprocessor"></span>  <span class="comment">// Get run and runtime database</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <a class="code" href="../../dd/dd2/classFairRun.html">FairRun</a>* <a class="code" href="../../d8/d44/namespaceActs_1_1PrimitivesView3DTest.html#ab51e63c03c55aac604dba9c1cd26ac85">run</a> = <a class="code" href="../../dd/dd2/classFairRun.html#a32e8a29a693ab357d4ce2b56a6cbc3a0">FairRun::Instance</a>();</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="keywordflow">if</span> ( ! run ) Fatal(<span class="stringliteral">&quot;PndPidCorrelator:: SetParContainers&quot;</span>, <span class="stringliteral">&quot;No analysis run&quot;</span>);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <a class="code" href="../../d7/d6f/classFairRuntimeDb.html" title="list of container factories">FairRuntimeDb</a>* <a class="code" href="../../dd/d7e/namespaceActs_1_1Test.html#a2fc35571d95987591758b78e9be84adb">db</a> = run-&gt;<a class="code" href="../../dd/dd2/classFairRun.html#a769c748079f470c6fb88bdddd2635e78">GetRuntimeDb</a>();</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="keywordflow">if</span> ( ! db ) Fatal(<span class="stringliteral">&quot;PndPidCorrelator:: SetParContainers&quot;</span>, <span class="stringliteral">&quot;No runtime database&quot;</span>);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="comment">// Get PID Correlation parameter container</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  fCorrPar = (PndPidCorrPar*) db-&gt;<a class="code" href="../../d7/d6f/classFairRuntimeDb.html#abba88b5b8c7dc22de5a5d1136f0074fb">getContainer</a>(<span class="stringliteral">&quot;PndPidCorrPar&quot;</span>);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="comment">// Get Emc geometry parameter container</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  fEmcGeoPar = (PndEmcGeoPar*) db-&gt;<a class="code" href="../../d7/d6f/classFairRuntimeDb.html#abba88b5b8c7dc22de5a5d1136f0074fb">getContainer</a>(<span class="stringliteral">&quot;PndEmcGeoPar&quot;</span>);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <span class="comment">// Get Emc error matrix parameter container</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  fEmcErrorMatrixPar = (PndEmcErrorMatrixPar*) db-&gt;<a class="code" href="../../d7/d6f/classFairRuntimeDb.html#abba88b5b8c7dc22de5a5d1136f0074fb">getContainer</a>(<span class="stringliteral">&quot;PndEmcErrorMatrixPar&quot;</span>);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="comment">// Get Stt parameter</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  fSttParameters = (PndGeoSttPar*) db-&gt;<a class="code" href="../../d7/d6f/classFairRuntimeDb.html#abba88b5b8c7dc22de5a5d1136f0074fb">getContainer</a>(<span class="stringliteral">&quot;PndGeoSttPar&quot;</span>);</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  fFtsParameters = (PndGeoFtsPar*) db-&gt;<a class="code" href="../../d7/d6f/classFairRuntimeDb.html#abba88b5b8c7dc22de5a5d1136f0074fb">getContainer</a>(<span class="stringliteral">&quot;PndGeoFtsPar&quot;</span>);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="preprocessor"></span>}</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">//______________________________________________________</span></div>
<div class="line"><a name="l00686"></a><span class="lineno"><a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ac7261219c977ce69655b77ca95032aec">  686</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ac7261219c977ce69655b77ca95032aec">PndPidCorrelator::Exec</a>(Option_t * option) {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <span class="comment">//-</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#adba4c855b67ae00ebfffc42364ff6726">Reset</a>();</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  cout &lt;&lt; <span class="stringliteral">&quot; =====   PndPidCorrelator - Event: &quot;</span> &lt;&lt; <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad24f3291ff08e5459b0e096e985518a3">fEventCounter</a>;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  Int_t nTracksTot=0;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#aa1341eb4656ff630e812d2b44d360e03">fTrack</a>)</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    {</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      nTracksTot += <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#aa1341eb4656ff630e812d2b44d360e03">fTrack</a>-&gt;GetEntriesFast();</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    }</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="preprocessor">#if _TODAY_</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> (fTrack2)</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    {</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      nTracksTot += fTrack2-&gt;GetEntriesFast();</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  cout &lt;&lt; <span class="stringliteral">&quot; - Number of tracks for pid &quot;</span> &lt;&lt; nTracksTot;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="preprocessor">#if _TODAY_</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> (fEmcMode&gt;0)</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    {</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      PndEmcCluster *tmp_cluster;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <span class="keywordflow">for</span>(Int_t i=0; i &lt; fEmcCluster-&gt;GetEntriesFast();i++)</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  {</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    tmp_cluster = (PndEmcCluster*)fEmcCluster-&gt;At(i);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keywordflow">if</span>(tmp_cluster-&gt;GetModule() &lt; 5 &amp;&amp; tmp_cluster-&gt;GetModule() &gt;0)</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      {</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        fEmcClstCount++;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      }</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordflow">if</span>(tmp_cluster-&gt;GetModule() == 5)</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        fFscClstCount++;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      }</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  }</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      ResetEmcQ();</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot; - Number of Clusters for pid: &quot;</span>;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot; EMC: &quot;</span> &lt;&lt; fEmcClstCount;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot; FSC: &quot;</span> &lt;&lt; fFscClstCount;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    }</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="preprocessor"></span>  cout&lt;&lt;endl;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#aa1341eb4656ff630e812d2b44d360e03">fTrack</a>)     <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ae4a0f3f29e102b0f60fac6c315ff0e02">ConstructChargedCandidate</a>();</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="preprocessor">#if _TODAY_</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> ((fEmcMode&gt;0)  &amp;&amp; (!fFast)) ConstructNeutralCandidate();</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="preprocessor"></span>  fEventCounter++;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;}</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment">//______________________________________________________</span></div>
<div class="line"><a name="l00735"></a><span class="lineno"><a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ae4a0f3f29e102b0f60fac6c315ff0e02">  735</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ae4a0f3f29e102b0f60fac6c315ff0e02">PndPidCorrelator::ConstructChargedCandidate</a>() {</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="comment">//-</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="comment">//FIXME: Use Clear() to save time. </span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="comment">//Call Delete() only for too busy events to save Memory</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#af9bfe67c10fb5056e1ee1234d0d4ab08" title="PndTrackID TCA.">fPidChargedCand</a>-&gt;Delete();</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="preprocessor">#if _TODAY_</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> (fMdtRefit) fMdtTrack-&gt;Delete();</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="keywordflow">if</span> (fMdtMode&gt;0) MdtMapping();</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="preprocessor"></span>  </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  Int_t nTracks = <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#aa1341eb4656ff630e812d2b44d360e03">fTrack</a>-&gt;GetEntriesFast();</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <span class="keywordflow">for</span> (Int_t i = 0; i &lt; nTracks; i++) {</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <a class="code" href="../../d4/d3f/classPndTrack.html">PndTrack</a>* track = (<a class="code" href="../../d4/d3f/classPndTrack.html">PndTrack</a>*) <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#aa1341eb4656ff630e812d2b44d360e03">fTrack</a>-&gt;At(i);</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    Int_t ierr = 0;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <a class="code" href="../../db/dc5/classFairTrackParP.html">FairTrackParP</a> par = track-&gt;<a class="code" href="../../d4/d3f/classPndTrack.html#a43a935dbdeeab8e55ec747d141414398">GetParamLast</a>();</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    cout &lt;&lt; par.<a class="code" href="../../d2/dfb/classFairTrackPar.html#a82b3d239ff710c04550cea5df141864d">GetMomentum</a>().Mag() &lt;&lt; endl;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keywordflow">if</span> ((par.<a class="code" href="../../d2/dfb/classFairTrackPar.html#a82b3d239ff710c04550cea5df141864d">GetMomentum</a>().Mag()&lt;0.1) <span class="comment">/*|| (par.GetMomentum().Mag()&gt;100.)*/</span> )<span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <a class="code" href="../../de/d81/classFairTrackParH.html">FairTrackParH</a> *helix = <span class="keyword">new</span> <a class="code" href="../../de/d81/classFairTrackParH.html">FairTrackParH</a>(&amp;par, ierr);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <a class="code" href="../../df/d33/classPndPidCandidate.html">PndPidCandidate</a>* pidCand =  <span class="keyword">new</span> <a class="code" href="../../df/d33/classPndPidCandidate.html">PndPidCandidate</a>();</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="comment">//for(unsigned iq=0; iq&lt;track-&gt;mSmoothedValues.size(); iq++)</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="comment">//pidCand-&gt;mSmoothedValues.push_back(track-&gt;mSmoothedValues[iq]);</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a0edd64376bb11506de6faa7e914ff9cf">fTrackIDBranch</a>!=<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      {</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  <a class="code" href="../../da/da4/classPndTrackID.html">PndTrackID</a>* trackID = (<a class="code" href="../../da/da4/classPndTrackID.html">PndTrackID</a>*) <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a62f958668d5abee110e8cfc82ac07248" title="PndTrack TCA.">fTrackID</a>-&gt;At(i);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="keywordflow">if</span> (trackID-&gt;<a class="code" href="../../da/da4/classPndTrackID.html#a81788200cc7794a0deb6ffd43aefe84e">GetNCorrTrackId</a>()&gt;0)</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    {</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      pidCand-&gt;<a class="code" href="../../df/d33/classPndPidCandidate.html#a9c88f490de73e84903e605975a95636d">SetMcIndex</a>(trackID-&gt;<a class="code" href="../../da/da4/classPndTrackID.html#a37dfa4f7eea03034045424b97a61f610">GetCorrTrackID</a>());</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a233468ad4c71ae7a4c6bea9c9411dd4a">fIdealHyp</a>)</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <a class="code" href="../../df/d16/classPndMCTrack.html">PndMCTrack</a> *mcTrack = (<a class="code" href="../../df/d16/classPndMCTrack.html">PndMCTrack</a>*)<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ac9bec857ea07ca373ca441a4c3f52819" title="PndPidCandidate TCA for charged particles.">fMcTrack</a>-&gt;At(trackID-&gt;<a class="code" href="../../da/da4/classPndTrackID.html#a37dfa4f7eea03034045424b97a61f610">GetCorrTrackID</a>());</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keywordflow">if</span> ( ! mcTrack ) </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      {</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a> = 211;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                    cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::ConstructChargedCandidate: PndMCTrack does not exist!! (why?) -&gt; let&#39;s try with pion hyp &quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      }</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      {</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a> = <a class="code" href="../../df/d28/namespacekdfinder.html#ab72d428625e99a2d7380eb7691c246c7">abs</a>(mcTrack-&gt;<a class="code" href="../../df/d16/classPndMCTrack.html#ae7020957cb139f60e8b25753509947c5">GetPdgCode</a>());</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      }</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a>&gt;=100000000)</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                  {</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                    <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a> = 211;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::ConstructChargedCandidate: Track is an ion (PDGCode&gt;100000000) -&gt; let&#39;s try with pion hyp&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                  }</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="../../df/d28/namespacekdfinder.html#ab72d428625e99a2d7380eb7691c246c7">abs</a>(<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a>)==13 ) <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a> = -13;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="../../df/d28/namespacekdfinder.html#ab72d428625e99a2d7380eb7691c246c7">abs</a>(<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a>)==11 ) <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a> = -11;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        }</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    }</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      } <span class="keywordflow">else</span> { <span class="comment">// added for PndAnalysis, TODO: remove after Fairlinks work with Associators</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      <a class="code" href="../../dd/d26/classPndTrackCand.html">PndTrackCand</a> trackCand = track-&gt;<a class="code" href="../../d4/d3f/classPndTrack.html#a0ba106ff3ff577efb4232b09c2736e7b">GetTrackCand</a>();</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      pidCand-&gt;<a class="code" href="../../df/d33/classPndPidCandidate.html#a9c88f490de73e84903e605975a95636d">SetMcIndex</a>(trackCand.<a class="code" href="../../dd/d26/classPndTrackCand.html#a2df31bef7d8b6ace75cc631cc3738b9e">getMcTrackId</a>());</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    }</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    pidCand-&gt;<a class="code" href="../../df/d33/classPndPidCandidate.html#a701ae2431807f23e8c09676fee4a1f01">SetTrackIndex</a>(i);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    pidCand-&gt;<a class="code" href="../../df/d33/classPndPidCandidate.html#a4c537bc1a420fd6c44312460c7779ad9">SetTrackBranch</a>(<a class="code" href="../../d0/d6c/classFairRootManager.html#a830b7803b29e7424a75f2dc374dcc96b">FairRootManager::Instance</a>()-&gt;GetBranchId(<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a10a1e48f1a51345cc21497386e0a4871" title="PndMCTrack TCA.">fTrackBranch</a>));</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    pidCand-&gt;<a class="code" href="../../df/d10/classFairMultiLinkedData.html#a6021b6584834def64d405d52c5f49429" title="Adds a FairLink link at the end of fLinks. If multi is kTRUE a link is allowed more than once otherwi...">AddLink</a>(<a class="code" href="../../d6/da5/classFairLink.html">FairLink</a>(<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a10a1e48f1a51345cc21497386e0a4871" title="PndMCTrack TCA.">fTrackBranch</a>, i));</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a7ac63f5bf338c5cd489fcfcc155b4353">GetTrackInfo</a>(track, pidCand)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="preprocessor">#if _TODAY_</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> ( (fMvdMode==2) &amp;&amp; ((fMvdHitsStrip-&gt;GetEntriesFast()+fMvdHitsPixel-&gt;GetEntriesFast())&gt;0) ) GetMvdInfo(track, pidCand); </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">if</span> ( (fSttMode == 2) &amp;&amp; (fSttHit    -&gt;GetEntriesFast()&gt;0) ) GetSttInfo(track, pidCand);</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    GetGemInfo(track, pidCand);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="keywordflow">if</span> (!fFast)</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      {</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <span class="keywordflow">if</span> ( (fTofMode==2) &amp;&amp; (fTofHit    -&gt;GetEntriesFast()&gt;0) ) GetTofInfo(helix, pidCand);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <span class="keywordflow">if</span> ( (fEmcMode&gt;0)  &amp;&amp; (fEmcClstCount&gt;0) ) GetEmcInfo(helix, pidCand);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <span class="keywordflow">if</span> ( (fMdtMode&gt;0)  &amp;&amp; (fMdtHit    -&gt;GetEntriesFast()&gt;0) ) GetMdtInfo(track, pidCand);  </div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="keywordflow">if</span> ( (fDrcMode&gt;0)  &amp;&amp; (fDrcHit    -&gt;GetEntriesFast()&gt;0) ) GetDrcInfo(helix, pidCand);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="keywordflow">if</span> ( (fDskMode&gt;0)  &amp;&amp; (fDskParticle-&gt;GetEntriesFast()&gt;0)) GetDskInfo(helix, pidCand); </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      }</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="comment">// Add charged track candidate and copy over parameterizations at the hit locations;</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <a class="code" href="../../df/d33/classPndPidCandidate.html">PndPidCandidate</a> *cand = <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ac72ed899e62455aacc92a32c423dd3ed">AddChargedCandidate</a>(pidCand);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    cand-&gt;<a class="code" href="../../df/d33/classPndPidCandidate.html#a262393f0288ced467249611ce5b8885e">mParameterizations</a> = track-&gt;<a class="code" href="../../d4/d3f/classPndTrack.html#ad9adf547137282a6fbea283aa14b782b">mParameterizations</a>;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  } </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  </div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="preprocessor">#if _TODAY_</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> (fTrackBranch2!=<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    {</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      Int_t nTracks2 = fTrack2-&gt;GetEntriesFast();</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      <span class="keywordflow">for</span> (Int_t i = 0; i &lt; nTracks2; i++) {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <a class="code" href="../../d4/d3f/classPndTrack.html">PndTrack</a>* track = (<a class="code" href="../../d4/d3f/classPndTrack.html">PndTrack</a>*) fTrack2-&gt;At(i);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  Int_t ierr = 0;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  <a class="code" href="../../db/dc5/classFairTrackParP.html">FairTrackParP</a> par = track-&gt;<a class="code" href="../../d4/d3f/classPndTrack.html#a43a935dbdeeab8e55ec747d141414398">GetParamLast</a>();</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <span class="keywordflow">if</span> ((par.<a class="code" href="../../d2/dfb/classFairTrackPar.html#a82b3d239ff710c04550cea5df141864d">GetMomentum</a>().Mag()&lt;0.1) || (par.<a class="code" href="../../d2/dfb/classFairTrackPar.html#a82b3d239ff710c04550cea5df141864d">GetMomentum</a>().Mag()&gt;20.) )<span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  <a class="code" href="../../de/d81/classFairTrackParH.html">FairTrackParH</a> *helix = <span class="keyword">new</span> <a class="code" href="../../de/d81/classFairTrackParH.html">FairTrackParH</a>(&amp;par, ierr);</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      </div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  <a class="code" href="../../df/d33/classPndPidCandidate.html">PndPidCandidate</a>* pidCand =  <span class="keyword">new</span> <a class="code" href="../../df/d33/classPndPidCandidate.html">PndPidCandidate</a>();</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  <span class="keywordflow">if</span> (fTrackIDBranch2!=<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    {</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      <a class="code" href="../../da/da4/classPndTrackID.html">PndTrackID</a>* trackID = (<a class="code" href="../../da/da4/classPndTrackID.html">PndTrackID</a>*) fTrackID2-&gt;At(i);</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <span class="keywordflow">if</span> (trackID-&gt;<a class="code" href="../../da/da4/classPndTrackID.html#a81788200cc7794a0deb6ffd43aefe84e">GetNCorrTrackId</a>()&gt;0)</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        {</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    pidCand-&gt;<a class="code" href="../../df/d33/classPndPidCandidate.html#a9c88f490de73e84903e605975a95636d">SetMcIndex</a>(trackID-&gt;<a class="code" href="../../da/da4/classPndTrackID.html#a37dfa4f7eea03034045424b97a61f610">GetCorrTrackID</a>());</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a233468ad4c71ae7a4c6bea9c9411dd4a">fIdealHyp</a>)</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      {</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <a class="code" href="../../df/d16/classPndMCTrack.html">PndMCTrack</a> *mcTrack = (<a class="code" href="../../df/d16/classPndMCTrack.html">PndMCTrack</a>*)<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ac9bec857ea07ca373ca441a4c3f52819" title="PndPidCandidate TCA for charged particles.">fMcTrack</a>-&gt;At(trackID-&gt;<a class="code" href="../../da/da4/classPndTrackID.html#a37dfa4f7eea03034045424b97a61f610">GetCorrTrackID</a>());</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <span class="keywordflow">if</span> ( ! mcTrack ) </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;          {</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a> = 211;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::ConstructChargedCandidate: PndMCTrack does not exist!! (why?) -&gt; let&#39;s try with pion hyp &quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;          }</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;          {</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a> = <a class="code" href="../../df/d28/namespacekdfinder.html#ab72d428625e99a2d7380eb7691c246c7">abs</a>(mcTrack-&gt;<a class="code" href="../../df/d16/classPndMCTrack.html#ae7020957cb139f60e8b25753509947c5">GetPdgCode</a>());</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;          }</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a>&gt;=100000000)</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;          {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a> = 211;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;-I- PndPidCorrelator::ConstructChargedCandidate: Track is an ion (PDGCode&gt;100000000) -&gt; let&#39;s try with pion hyp&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;          }</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        </div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="../../df/d28/namespacekdfinder.html#ab72d428625e99a2d7380eb7691c246c7">abs</a>(<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a>)==13 ) <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a> = -13;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="../../df/d28/namespacekdfinder.html#ab72d428625e99a2d7380eb7691c246c7">abs</a>(<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a>)==11 ) <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a> = -11;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      }</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        }</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">// added for PndAnalysis, TODO: remove after Fairlinks work with Associators</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <a class="code" href="../../dd/d26/classPndTrackCand.html">PndTrackCand</a> trackCand = track-&gt;<a class="code" href="../../d4/d3f/classPndTrack.html#a0ba106ff3ff577efb4232b09c2736e7b">GetTrackCand</a>();</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    pidCand-&gt;<a class="code" href="../../df/d33/classPndPidCandidate.html#a9c88f490de73e84903e605975a95636d">SetMcIndex</a>(trackCand.<a class="code" href="../../dd/d26/classPndTrackCand.html#a2df31bef7d8b6ace75cc631cc3738b9e">getMcTrackId</a>());</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  }</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  pidCand-&gt;<a class="code" href="../../df/d33/classPndPidCandidate.html#a701ae2431807f23e8c09676fee4a1f01">SetTrackIndex</a>(i);</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        pidCand-&gt;<a class="code" href="../../df/d33/classPndPidCandidate.html#a4c537bc1a420fd6c44312460c7779ad9">SetTrackBranch</a>(<a class="code" href="../../d0/d6c/classFairRootManager.html#a830b7803b29e7424a75f2dc374dcc96b">FairRootManager::Instance</a>()-&gt;GetBranchId(fTrackBranch2));</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  pidCand-&gt;<a class="code" href="../../df/d10/classFairMultiLinkedData.html#a6021b6584834def64d405d52c5f49429" title="Adds a FairLink link at the end of fLinks. If multi is kTRUE a link is allowed more than once otherwi...">AddLink</a>(<a class="code" href="../../d6/da5/classFairLink.html">FairLink</a>(<span class="stringliteral">&quot;PndTrack&quot;</span>, i));</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a7ac63f5bf338c5cd489fcfcc155b4353">GetTrackInfo</a>(track, pidCand)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <span class="keywordflow">if</span> ( (fMvdMode==2) &amp;&amp; ((fMvdHitsStrip-&gt;GetEntriesFast()+fMvdHitsPixel-&gt;GetEntriesFast())&gt;0) ) GetMvdInfo(track, pidCand); </div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  <span class="keywordflow">if</span> ( (fFtsMode == 2) &amp;&amp; (fFtsHit    -&gt;GetEntriesFast()&gt;0) ) GetFtsInfo(track, pidCand); </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  GetGemInfo(track, pidCand);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <span class="keywordflow">if</span> (!fFast)</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    {</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      <span class="keywordflow">if</span> ( (fFtofMode==2) &amp;&amp; (fFtofHit-&gt;GetEntriesFast()&gt;0) ) GetFtofInfo(helix, pidCand);</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      <span class="keywordflow">if</span> ( (fEmcMode&gt;0)  &amp;&amp; (fFscClstCount&gt;0) ) GetFscInfo(helix, pidCand);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      <span class="comment">//if ( (fMdtMode&gt;0)  &amp;&amp; (fMdtHit    -&gt;GetEntriesFast()&gt;0) ) GetMdtInfo(track, pidCand);</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      <span class="keywordflow">if</span> (mapMdtForward.size()&gt;0)  GetFMdtInfo(&amp;par, pidCand);</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    } <span class="comment">// end of fast mode</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ac72ed899e62455aacc92a32c423dd3ed">AddChargedCandidate</a>(pidCand);</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      }</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    }</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="preprocessor">#endif  </span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="preprocessor"></span>}</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="preprocessor">#if _TODAY_</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="preprocessor"></span><span class="comment">//______________________________________________________</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="keywordtype">void</span> PndPidCorrelator::ConstructNeutralCandidate() {</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <span class="comment">//-</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  fPidNeutralCand-&gt;Delete();</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  TString emcType;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  </div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  Int_t nBumps = 0;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="keywordflow">if</span> (fEmcMode == 2)</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    {</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      nBumps = fEmcCluster-&gt;GetEntriesFast();</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      emcType = <span class="stringliteral">&quot;EmcCluster&quot;</span>;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    }</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(fEmcMode == 3)</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    {</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      nBumps = fEmcBump-&gt;GetEntriesFast();</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      emcType = <span class="stringliteral">&quot;EmcBump&quot;</span>;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    }</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <span class="keywordflow">for</span> (Int_t i = 0; i &lt; nBumps; i++)</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    {</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      PndEmcBump* bump;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      PndEmcCluster *clu;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      Float_t quality = -1.;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      <span class="keywordflow">if</span> (fEmcMode==2)</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  { </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="keywordflow">if</span> (fClusterList[i]) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    bump = (PndEmcBump*) fEmcCluster-&gt;At(i);</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    clu  = (PndEmcBump*) fEmcCluster-&gt;At(i);</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;          quality = fClusterQ[i];</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  }</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(fEmcMode == 3)</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  {</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    bump = (PndEmcBump*) fEmcBump-&gt;At(i);</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="keywordflow">if</span> (fClusterList[bump-&gt;GetClusterIndex()]) <span class="keywordflow">continue</span>; <span class="comment">// skip correlated clusters</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    clu = (PndEmcCluster*)fEmcCluster-&gt;At(bump-&gt;GetClusterIndex());</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;          quality = fClusterQ[bump-&gt;GetClusterIndex()];</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  }</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      TVector3 <a class="code" href="../../d5/dbe/EIC-IR1-XX-v00_8C.html#a888f39f7254b5b59976d577091d79a4e">vtx</a>(0,0,0);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      TVector3 <a class="code" href="../../d0/d73/flowAfterburner_8cc.html#a12d28bd93fcce48970997144ffbf1c81">v1</a>=bump-&gt;where();</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      TVector3 p3;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      p3.SetMagThetaPhi(fEmcCalibrator-&gt;Energy(bump), v1.Theta(), v1.Phi());</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      TLorentzVector lv(p3,p3.Mag());</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      TMatrixD covP4=fEmcErrorMatrix-&gt;Get4MomentumErrorMatrix(*clu);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      <a class="code" href="../../df/d33/classPndPidCandidate.html">PndPidCandidate</a>* pidCand = <span class="keyword">new</span> <a class="code" href="../../df/d33/classPndPidCandidate.html">PndPidCandidate</a>(0, <a class="code" href="../../d5/dbe/EIC-IR1-XX-v00_8C.html#a888f39f7254b5b59976d577091d79a4e">vtx</a>, lv);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      pidCand-&gt;<a class="code" href="../../df/d33/classPndPidCandidate.html#a97cfd8016384d1a781997575c142b16c">SetP4Cov</a>(covP4);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      pidCand-&gt;SetEmcRawEnergy(bump-&gt;energy());</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      pidCand-&gt;SetEmcCalEnergy(fEmcCalibrator-&gt;Energy(bump));</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      pidCand-&gt;SetEmcIndex(i);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;      pidCand-&gt;SetEmcModule(bump-&gt;GetModule());</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      pidCand-&gt;SetEmcNumberOfCrystals(bump-&gt;NumberOfDigis());</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;      pidCand-&gt;SetEmcNumberOfBumps(clu-&gt;NBumps());</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      pidCand-&gt;SetEmcQuality(quality);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;      pidCand-&gt;SetEmcClusterZ20(bump-&gt;Z20());</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;      pidCand-&gt;SetEmcClusterZ53(bump-&gt;Z53());</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;      pidCand-&gt;SetEmcClusterLat(bump-&gt;LatMom()); </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      <span class="keywordflow">if</span> (fEmcDigi)</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  {</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    PndEmcClusterEnergySums esum(*clu, fEmcDigi);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    pidCand-&gt;SetEmcClusterE1(esum.E1());</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    pidCand-&gt;SetEmcClusterE9(esum.E9());</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    pidCand-&gt;SetEmcClusterE25(esum.E25());</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  }</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;      pidCand-&gt;<a class="code" href="../../df/d10/classFairMultiLinkedData.html#a2d2c12469a10cdb6bc6cd022f665d5ef" title="Sets the Links with a single FairLink.">SetLink</a>(<a class="code" href="../../d6/da5/classFairLink.html">FairLink</a>(emcType, i));</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      std::vector&lt;Int_t&gt; mclist = clu-&gt;GetMcList();</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      <span class="keywordflow">if</span> (mclist.size()&gt;0)</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  {</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    pidCand-&gt;<a class="code" href="../../df/d33/classPndPidCandidate.html#a9c88f490de73e84903e605975a95636d">SetMcIndex</a>(mclist[0]);</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  }</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      AddNeutralCandidate(pidCand);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    }</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;}</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment">//_________________________________________________________________</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;Bool_t PndPidCorrelator::GetTofInfo(<a class="code" href="../../de/d81/classFairTrackParH.html">FairTrackParH</a>* helix, <a class="code" href="../../df/d33/classPndPidCandidate.html">PndPidCandidate</a>* pidCand) {</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  </div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <span class="keywordflow">if</span> (!fIdeal)</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    {</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      <span class="keywordflow">if</span> ((helix-&gt;<a class="code" href="../../d2/dfb/classFairTrackPar.html#a82b3d239ff710c04550cea5df141864d">GetMomentum</a>().Theta()*TMath::RadToDeg())&lt;20.) <span class="keywordflow">return</span> kFALSE; </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      <span class="keywordflow">if</span> ((helix-&gt;<a class="code" href="../../d2/dfb/classFairTrackPar.html#a82b3d239ff710c04550cea5df141864d">GetMomentum</a>().Theta()*TMath::RadToDeg())&gt;150.) <span class="keywordflow">return</span> kFALSE;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    }</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  <a class="code" href="../../d1/dca/classFairGeanePro.html">FairGeanePro</a> *fProTof = <span class="keyword">new</span> <a class="code" href="../../d1/dca/classFairGeanePro.html">FairGeanePro</a>();</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#afa5d1c9a95012384c31c423dad1cd21c">fCorrErrorProp</a>) fProTof-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#ae74a71b2268ab43db0d4056c26840cdd">PropagateOnlyParameters</a>(); </div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <a class="code" href="../../d1/dca/classFairGeanePro.html">FairGeanePro</a> *fProVertex = <span class="keyword">new</span> <a class="code" href="../../d1/dca/classFairGeanePro.html">FairGeanePro</a>();</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#afa5d1c9a95012384c31c423dad1cd21c">fCorrErrorProp</a>) fProVertex-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#ae74a71b2268ab43db0d4056c26840cdd">PropagateOnlyParameters</a>();</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <span class="comment">//---</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  PndSciTHit *tofHit = NULL; </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  Int_t tofEntries = fTofHit-&gt;GetEntriesFast();</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  Int_t tofIndex = -1;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  Float_t tofTof = 0., tofLength = -1000, tofGLength = -1000, tofLengthTemp = -1000;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  Float_t tofQuality = 1000000;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  Float_t chi2 = 0;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  TVector3 vertex(0., 0., 0.);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  TVector3 tofPos(0., 0., 0.);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  TVector3 <a class="code" href="../../d2/dcb/InteractionsTests_8cpp.html#ae8c383eee21959418ab07be9d62b43cb">momentum</a>(0., 0., 0.);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <span class="keywordflow">for</span> (Int_t tt = 0; tt&lt;tofEntries; tt++)</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    {</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      tofHit = (PndSciTHit*)fTofHit-&gt;At(tt);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      <span class="keywordflow">if</span> ( fIdeal &amp;&amp; ( ((PndSciTPoint*)fTofPoint-&gt;At(tofHit-&gt;GetRefIndex()))-&gt;GetTrackID() !=pidCand-&gt;<a class="code" href="../../df/d33/classPndPidCandidate.html#a820deb20125c21ce39cea26e56c9b0d2">GetMcIndex</a>()) ) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;      tofHit-&gt;Position(tofPos);</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    </div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a0923736cb5697a5e1f9236d512340f5e">fGeanePro</a>) <span class="comment">// Overwrites vertex if Geane is used</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  { </div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;     </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    fProTof-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#aac7c54081831f9281e5b9749d8dcc781">SetPoint</a>(tofPos);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    fProTof-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#a7124e6c14687554025ee3f32336ffffd">PropagateToPCA</a>(1, 1);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <a class="code" href="../../de/d81/classFairTrackParH.html">FairTrackParH</a> *fRes= <span class="keyword">new</span> <a class="code" href="../../de/d81/classFairTrackParH.html">FairTrackParH</a>();</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    Bool_t rc =  fProTof-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#aa2a05972e893284f107f3e2ca5db05d6">Propagate</a>(helix, fRes, <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a>*pidCand-&gt;<a class="code" href="../../df/d33/classPndPidCandidate.html#a9e0641f35922cd31e2e29471126a129c">GetCharge</a>()); </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="keywordflow">if</span> (!rc) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      </div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    vertex.SetXYZ(fRes-&gt;<a class="code" href="../../de/d81/classFairTrackParH.html#a2cb6c554c49ca46ba3d812aaf60fcb7c">GetX</a>(), fRes-&gt;<a class="code" href="../../de/d81/classFairTrackParH.html#a057fca591ac539c2b716ef7066591b7f">GetY</a>(), fRes-&gt;<a class="code" href="../../de/d81/classFairTrackParH.html#a4c5b3597ad017023382d3ab907b1d01f">GetZ</a>());</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;     </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    fProVertex-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#aac7c54081831f9281e5b9749d8dcc781">SetPoint</a>(TVector3(0,0,0));</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    fProVertex-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#a7124e6c14687554025ee3f32336ffffd">PropagateToPCA</a>(1, -1);</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <a class="code" href="../../de/d81/classFairTrackParH.html">FairTrackParH</a> *fRes2= <span class="keyword">new</span> <a class="code" href="../../de/d81/classFairTrackParH.html">FairTrackParH</a>();</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    Bool_t rc2 =  fProVertex-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#aa2a05972e893284f107f3e2ca5db05d6">Propagate</a>(fRes, fRes2, <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a>*pidCand-&gt;<a class="code" href="../../df/d33/classPndPidCandidate.html#a9e0641f35922cd31e2e29471126a129c">GetCharge</a>());</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordflow">if</span> (rc2) tofLengthTemp = fProVertex-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#a17a41a27dfaadf86873f5ccc822c41e9">GetLengthAtPCA</a>();</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  }</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    </div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      Float_t dist = (tofPos-vertex).Mag2();</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    </div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      <span class="keywordflow">if</span> ( tofQuality &gt; dist)</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  {</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    tofIndex = tt;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    tofQuality = dist;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    tofTof = tofHit-&gt;GetTime();</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    tofLength = tofLengthTemp; <span class="comment">// abs(phi * track-&gt;GetRadius() / TMath::Sin(track-&gt;GetMomentum().Theta()));</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  }</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      <span class="keywordflow">if</span> (fDebugMode)</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  {</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    Float_t ntuple[] = {vertex.X(), vertex.Y(), vertex.Z(), vertex.Phi(),</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;            helix-&gt;<a class="code" href="../../d2/dfb/classFairTrackPar.html#a82b3d239ff710c04550cea5df141864d">GetMomentum</a>().Mag(), helix-&gt;<a class="code" href="../../d2/dfb/classFairTrackPar.html#a9c2d5f4a3f77c99943f7ad68ce48d73c">GetQ</a>(), helix-&gt;<a class="code" href="../../d2/dfb/classFairTrackPar.html#a82b3d239ff710c04550cea5df141864d">GetMomentum</a>().Theta(), helix-&gt;<a class="code" href="../../de/d81/classFairTrackParH.html#a4c5b3597ad017023382d3ab907b1d01f">GetZ</a>(),</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;            tofPos.X(), tofPos.Y(), tofPos.Z(), tofPos.Phi(),</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;            dist, vertex.DeltaPhi(tofPos), tofLength, tofGLength};</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    tofCorr-&gt;Fill(ntuple);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  }</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    }</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  </div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <span class="keywordflow">if</span> ( (tofQuality&lt;fCorrPar-&gt;GetTofCut()) || (fIdeal &amp;&amp; tofIndex!=-1) )</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    {</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      pidCand-&gt;SetTofQuality(tofQuality);</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      pidCand-&gt;SetTofStopTime(tofTof);</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;      pidCand-&gt;SetTofTrackLength(tofLength);</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;      pidCand-&gt;SetTofIndex(tofIndex);</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      <span class="keywordflow">if</span> (tofLength&gt;0.)</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  {</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="comment">// mass^2 = p^2 * ( 1/beta^2 - 1 )</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    Float_t mass2 = helix-&gt;<a class="code" href="../../d2/dfb/classFairTrackPar.html#a82b3d239ff710c04550cea5df141864d">GetMomentum</a>().Mag()*helix-&gt;<a class="code" href="../../d2/dfb/classFairTrackPar.html#a82b3d239ff710c04550cea5df141864d">GetMomentum</a>().Mag()*(30.*30.*tofTof*tofTof/tofLength/tofLength-1.);</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    pidCand-&gt;SetTofM2(mass2);</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  }</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    }</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  <span class="keywordflow">return</span> kTRUE;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;}</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="keywordtype">void</span> PndPidCorrelator::ResetEmcQ()</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;{</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="comment">// Fuction to reset all the quality values for emc-track correlation to -1</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  fClusterQ.clear();</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  fClusterList.clear();</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <span class="keywordflow">for</span> (Int_t ii=0; ii&lt;fEmcCluster-&gt;GetEntriesFast(); ii++)</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    {</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;      fClusterQ[ii] = -1;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      fClusterList[ii] = kFALSE;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    }</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;}</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">//_________________________________________________________________</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;Bool_t PndPidCorrelator::GetEmcInfo(<a class="code" href="../../de/d81/classFairTrackParH.html">FairTrackParH</a>* helix, <a class="code" href="../../df/d33/classPndPidCandidate.html">PndPidCandidate</a>* pidCand) { </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <span class="keywordflow">if</span>(! helix){</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;&lt;Error&gt; PndPidCorrelator EMCINFO: FairTrackParH NULL pointer parameter.&quot;</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        &lt;&lt;std::endl;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <span class="keywordflow">return</span> kFALSE;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  }</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  <span class="keywordflow">if</span>(! pidCand){</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;&lt;Error&gt; PndPidCorrelator EMCINFO: pidCand NULL pointer parameter.&quot;</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        &lt;&lt;std::endl;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keywordflow">return</span> kFALSE;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  }</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  <a class="code" href="../../d1/dca/classFairGeanePro.html">FairGeanePro</a> *fProEmc = <span class="keyword">new</span> <a class="code" href="../../d1/dca/classFairGeanePro.html">FairGeanePro</a>(); </div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#afa5d1c9a95012384c31c423dad1cd21c">fCorrErrorProp</a>) fProEmc-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#ae74a71b2268ab43db0d4056c26840cdd">PropagateOnlyParameters</a>();</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  <span class="comment">//---</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  Float_t trackTheta = helix-&gt;<a class="code" href="../../d2/dfb/classFairTrackPar.html#a82b3d239ff710c04550cea5df141864d">GetMomentum</a>().Theta()*TMath::RadToDeg();</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  </div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  Int_t emcEntries = fEmcCluster-&gt;GetEntriesFast();</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  Int_t emcIndex = -1, emcModuleCorr = -1, emcNCrystals = -1, emcNBumps = -1;</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  Float_t emcEloss = 0., emcElossCorr = 0., emcGLength = -1000;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  Float_t emcQuality = 1000000;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  Float_t chi2 = 0;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  TVector3 vertex(0., 0., 0.); TVector3 emcPos(0., 0., 0.);<span class="comment">// TVector3 momentum(0., 0., 0.);</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  </div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  <span class="comment">// Cluster zenike moments</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  Double_t Z20 = 0.0, Z53 = 0.0, secLatM = 0.00, E1 = 0., E9 = 0., E25 = 0.;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  </div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  <span class="keywordflow">for</span> (Int_t ee = 0; ee&lt;emcEntries; ee++)</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    {</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      PndEmcCluster *emcHit = (PndEmcCluster*)fEmcCluster-&gt;At(ee);</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      </div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;      <span class="keywordflow">if</span> ( fIdeal )</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  {</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    std::vector&lt;Int_t&gt; mclist = emcHit-&gt;GetMcList();</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="keywordflow">if</span> (mclist.size()==0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="keywordflow">if</span> (mclist[0]!=pidCand-&gt;<a class="code" href="../../df/d33/classPndPidCandidate.html#a820deb20125c21ce39cea26e56c9b0d2">GetMcIndex</a>()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  }</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      </div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      <span class="keywordflow">if</span> (emcHit-&gt;energy() &lt; fCorrPar-&gt;GetEmc12Thr()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;      Int_t emcModule = emcHit-&gt;GetModule();</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;      <span class="keywordflow">if</span> (emcModule&gt;4) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;      </div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      emcPos = emcHit-&gt;where();</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a0923736cb5697a5e1f9236d512340f5e">fGeanePro</a>)</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  { <span class="comment">// Overwrites vertex if Geane is used</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    fProEmc-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#aac7c54081831f9281e5b9749d8dcc781">SetPoint</a>(emcPos);</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    fProEmc-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#a7124e6c14687554025ee3f32336ffffd">PropagateToPCA</a>(1, 1);</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    vertex.SetXYZ(-10000, -10000, -10000); <span class="comment">// reset vertex</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <a class="code" href="../../de/d81/classFairTrackParH.html">FairTrackParH</a> *fRes= <span class="keyword">new</span> <a class="code" href="../../de/d81/classFairTrackParH.html">FairTrackParH</a>();</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    Bool_t rc =  fProEmc-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#aa2a05972e893284f107f3e2ca5db05d6">Propagate</a>(helix, fRes, <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a>*pidCand-&gt;<a class="code" href="../../df/d33/classPndPidCandidate.html#a9e0641f35922cd31e2e29471126a129c">GetCharge</a>()); <span class="comment">// First propagation at module</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="keywordflow">if</span> (!rc) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    </div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    emcGLength = fProEmc-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#a17a41a27dfaadf86873f5ccc822c41e9">GetLengthAtPCA</a>();</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    vertex.SetXYZ(fRes-&gt;<a class="code" href="../../de/d81/classFairTrackParH.html#a2cb6c554c49ca46ba3d812aaf60fcb7c">GetX</a>(), fRes-&gt;<a class="code" href="../../de/d81/classFairTrackParH.html#a057fca591ac539c2b716ef7066591b7f">GetY</a>(), fRes-&gt;<a class="code" href="../../de/d81/classFairTrackParH.html#a4c5b3597ad017023382d3ab907b1d01f">GetZ</a>());</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="comment">//std::map&lt;PndEmcTwoCoordIndex*, PndEmcXtal*&gt; tciXtalMap=PndEmcStructure::Instance()-&gt;GetTciXtalMap();</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="comment">//PndEmcDigi *lDigi= (PndEmcDigi*)emcHit-&gt;Maxima();</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="comment">//PndEmcXtal* xtal = tciXtalMap[lDigi-&gt;GetTCI()];</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="comment">//emcPos = xtal-&gt;frontCentre();</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  }</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      </div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      Float_t dist = (emcPos-vertex).Mag2();</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      <span class="keywordflow">if</span> ( emcQuality &gt; dist )</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  {</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    emcIndex = ee;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    emcQuality = dist;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    emcEloss = emcHit-&gt;energy();</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    emcElossCorr = fEmcCalibrator-&gt;Energy(emcHit);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    emcModuleCorr = emcModule;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    emcNCrystals = emcHit-&gt;NumberOfDigis();</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;          emcNBumps  = emcHit-&gt;NBumps();</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    Z20 = emcHit-&gt;Z20();<span class="comment">// Z_{n = 2}^{m = 0}</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    Z53 = emcHit-&gt;Z53();<span class="comment">// Z_{n = 5}^{m = 3}</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    secLatM = emcHit-&gt;LatMom();</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordflow">if</span> (fEmcDigi)</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      {</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        PndEmcClusterEnergySums esum(*emcHit, fEmcDigi);</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        E1  = esum.E1(); </div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        E9  = esum.E9();</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        E25 = esum.E25();</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      }</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  }</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;      <span class="keywordflow">if</span> ( (fClusterQ[ee]&lt;0) || (dist &lt; fClusterQ[ee])) </div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <span class="comment">// If the track-emc distance is less than the previous stored value (or still not initialized)</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  {</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    fClusterQ[ee] = dist; <span class="comment">// update the param</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  }</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;      </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;      <span class="keywordflow">if</span> (fDebugMode){</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  Float_t ntuple[] = {vertex.X(), vertex.Y(), vertex.Z(), vertex.Phi(),</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;          helix-&gt;<a class="code" href="../../d2/dfb/classFairTrackPar.html#a82b3d239ff710c04550cea5df141864d">GetMomentum</a>().Mag(), helix-&gt;<a class="code" href="../../d2/dfb/classFairTrackPar.html#a9c2d5f4a3f77c99943f7ad68ce48d73c">GetQ</a>(), helix-&gt;<a class="code" href="../../d2/dfb/classFairTrackPar.html#a82b3d239ff710c04550cea5df141864d">GetMomentum</a>().Theta(), helix-&gt;<a class="code" href="../../de/d81/classFairTrackParH.html#a4c5b3597ad017023382d3ab907b1d01f">GetZ</a>(),</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;          emcPos.X(), emcPos.Y(), emcPos.Z(), emcPos.Phi(),</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;          dist, vertex.DeltaPhi(emcPos), emcHit-&gt;energy(), emcGLength, emcModule};</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  emcCorr-&gt;Fill(ntuple);</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      }</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    }<span class="comment">// End for(ee = 0;)</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  </div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <span class="keywordflow">if</span> ( (emcQuality &lt; fCorrPar-&gt;GetEmc12Cut()) || ( fIdeal &amp;&amp; emcIndex!=-1) ){</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    fClusterList[emcIndex] = kTRUE;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    pidCand-&gt;SetEmcQuality(emcQuality);</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    pidCand-&gt;SetEmcRawEnergy(emcEloss);</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    pidCand-&gt;SetEmcCalEnergy(emcElossCorr);</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    pidCand-&gt;SetEmcIndex(emcIndex);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    pidCand-&gt;SetEmcModule(emcModuleCorr);</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    pidCand-&gt;SetEmcNumberOfCrystals(emcNCrystals);</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    pidCand-&gt;SetEmcNumberOfBumps(emcNBumps);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="comment">//======= </span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    pidCand-&gt;SetEmcClusterZ20(Z20);</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    pidCand-&gt;SetEmcClusterZ53(Z53);</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    pidCand-&gt;SetEmcClusterLat(secLatM); </div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    pidCand-&gt;SetEmcClusterE1(E1);</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    pidCand-&gt;SetEmcClusterE9(E9);</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    pidCand-&gt;SetEmcClusterE25(E25);</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <span class="comment">//=====</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  }</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  </div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <span class="keywordflow">return</span> kTRUE;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;}</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="comment">//_________________________________________________________________</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;Bool_t PndPidCorrelator::GetMdtInfo(<a class="code" href="../../d4/d3f/classPndTrack.html">PndTrack</a>* track, <a class="code" href="../../df/d33/classPndPidCandidate.html">PndPidCandidate</a>* pidCand) {</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <span class="comment">//--- </span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  <a class="code" href="../../db/dc5/classFairTrackParP.html">FairTrackParP</a> par = track-&gt;<a class="code" href="../../d4/d3f/classPndTrack.html#a43a935dbdeeab8e55ec747d141414398">GetParamLast</a>();</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  Int_t ierr = 0;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <a class="code" href="../../de/d81/classFairTrackParH.html">FairTrackParH</a> *helix = <span class="keyword">new</span> <a class="code" href="../../de/d81/classFairTrackParH.html">FairTrackParH</a>(&amp;par, ierr);</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160; </div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  map&lt;Int_t, Int_t&gt;mapMdtTrk;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  <a class="code" href="../../d1/dca/classFairGeanePro.html">FairGeanePro</a> *fProMdt = <span class="keyword">new</span> <a class="code" href="../../d1/dca/classFairGeanePro.html">FairGeanePro</a>();</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#afa5d1c9a95012384c31c423dad1cd21c">fCorrErrorProp</a>) fProMdt-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#ae74a71b2268ab43db0d4056c26840cdd">PropagateOnlyParameters</a>();</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <span class="keywordflow">if</span> (fMdtMode == 3)</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    { </div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      <span class="keywordflow">for</span> (Int_t tt = 0; tt&lt;fMdtTrk-&gt;GetEntriesFast(); tt++)</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  {</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    PndMdtTrk *mdtTrk = (PndMdtTrk*)fMdtTrk-&gt;At(tt);</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    mapMdtTrk[mdtTrk-&gt;GetHitIndex(0)] = tt;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  }</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    }</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  PndMdtHit *mdtHit = NULL;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  Int_t mdtEntries = fMdtHit-&gt;GetEntriesFast();</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  Int_t mdtIndex = -1, mdtMod = 0, mdtLayer = 0, mdtHits = 0;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  Float_t mdtGLength = -1000;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  Float_t mdtQuality = 1000000;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  Float_t mdtIron = 0., mdtMom = 0, mdtTempMom = 0;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  </div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  Float_t chi2 = 0;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  TVector3 vertex(0., 0., 0.);</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  TVector3 vertexD(0., 0., 0.);</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  TVector3 mdtPos(0., 0., 0.);</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  TVector3 <a class="code" href="../../d2/dcb/InteractionsTests_8cpp.html#ae8c383eee21959418ab07be9d62b43cb">momentum</a>(0., 0., 0.);</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  <span class="keywordflow">for</span> (Int_t <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a44fb500abc41c8b4d2937824ad76f8bd">mm</a> = 0; <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a44fb500abc41c8b4d2937824ad76f8bd">mm</a>&lt;mdtEntries; <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a44fb500abc41c8b4d2937824ad76f8bd">mm</a>++)</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    {</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      mdtHit = (PndMdtHit*)fMdtHit-&gt;At(<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a44fb500abc41c8b4d2937824ad76f8bd">mm</a>);</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      <span class="keywordflow">if</span> ( fIdeal &amp;&amp; ( ((PndMdtPoint*)fMdtPoint-&gt;At(mdtHit-&gt;GetRefIndex()))-&gt;GetTrackID() !=pidCand-&gt;<a class="code" href="../../df/d33/classPndPidCandidate.html#a820deb20125c21ce39cea26e56c9b0d2">GetMcIndex</a>()) ) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      <span class="keywordflow">if</span> (mdtHit-&gt;GetLayerID()!=0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      <span class="keywordflow">if</span> (mdtHit-&gt;GetModule()&gt;2) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;      mdtHit-&gt;Position(mdtPos);</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a0923736cb5697a5e1f9236d512340f5e">fGeanePro</a>) <span class="comment">// Overwrites vertex if Geane is used</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;  { </div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;     </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    fProMdt-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#aac7c54081831f9281e5b9749d8dcc781">SetPoint</a>(mdtPos);</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    fProMdt-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#a7124e6c14687554025ee3f32336ffffd">PropagateToPCA</a>(1, 1);</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    vertex.SetXYZ(-10000, -10000, -10000); <span class="comment">// reset vertex</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    vertexD.SetXYZ(-10000, -10000, -10000); <span class="comment">// reset vertex</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    <a class="code" href="../../de/d81/classFairTrackParH.html">FairTrackParH</a> *fRes= <span class="keyword">new</span> <a class="code" href="../../de/d81/classFairTrackParH.html">FairTrackParH</a>();</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    Bool_t rc =  fProMdt-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#aa2a05972e893284f107f3e2ca5db05d6">Propagate</a>(helix, fRes, <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a>*pidCand-&gt;<a class="code" href="../../df/d33/classPndPidCandidate.html#a9e0641f35922cd31e2e29471126a129c">GetCharge</a>()); </div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="keywordflow">if</span> (!rc) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    mdtTempMom = fRes-&gt;<a class="code" href="../../d2/dfb/classFairTrackPar.html#a82b3d239ff710c04550cea5df141864d">GetMomentum</a>().Mag(); </div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    vertex.SetXYZ(fRes-&gt;<a class="code" href="../../de/d81/classFairTrackParH.html#a2cb6c554c49ca46ba3d812aaf60fcb7c">GetX</a>(), fRes-&gt;<a class="code" href="../../de/d81/classFairTrackParH.html#a057fca591ac539c2b716ef7066591b7f">GetY</a>(), fRes-&gt;<a class="code" href="../../de/d81/classFairTrackParH.html#a4c5b3597ad017023382d3ab907b1d01f">GetZ</a>());</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    vertexD.SetXYZ(fRes-&gt;<a class="code" href="../../d2/dfb/classFairTrackPar.html#a73c8f65de46e4c9370aafa87adf07f06">GetDX</a>(), fRes-&gt;<a class="code" href="../../d2/dfb/classFairTrackPar.html#ac217e225a2377254e344e0b06ea1e483">GetDY</a>(), fRes-&gt;<a class="code" href="../../d2/dfb/classFairTrackPar.html#a1e3ac570b82565810f33488f755e2b6c">GetDZ</a>());</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    mdtGLength = fProMdt-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#a17a41a27dfaadf86873f5ccc822c41e9">GetLengthAtPCA</a>();</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  }</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    </div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      Float_t dist;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      <span class="keywordflow">if</span> (mdtHit-&gt;GetModule()==1) </div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;  {</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    dist = (mdtPos-vertex).Mag2();</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;  }</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  {</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    dist = (vertex.X()-mdtPos.X())*(vertex.X()-mdtPos.X())+(vertex.Y()-mdtPos.Y())*(vertex.Y()-mdtPos.Y());</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  }</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    </div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      <span class="keywordflow">if</span> ( mdtQuality &gt; dist)</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  {</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    mdtIndex = <a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a44fb500abc41c8b4d2937824ad76f8bd">mm</a>;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    mdtQuality = dist;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    mdtMod = mdtHit-&gt;GetModule();</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    mdtMom = mdtTempMom;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    mdtLayer = 1;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="keywordflow">if</span> (fMdtMode==3)</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;      {</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;        PndMdtTrk *mdtTrk = (PndMdtTrk*)fMdtTrk-&gt;At(mapMdtTrk[mdtIndex]);</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        mdtIndex = mapMdtTrk[<a class="code" href="../../d6/d4d/namespaceActs_1_1UnitConstants.html#a44fb500abc41c8b4d2937824ad76f8bd">mm</a>];</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        mdtLayer = mdtTrk-&gt;GetLayerCount();</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        mdtIron = mdtTrk-&gt;GetIronDist();</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        mdtMod = mdtTrk-&gt;GetModule();</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        mdtHits = 0;</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        <span class="keywordflow">for</span> (Int_t iLayer=0; iLayer&lt;mdtLayer; iLayer++)</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    {</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;      mdtHits = mdtHits + mdtTrk-&gt;GetHitMult(iLayer);</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      <span class="comment">//std::cout &lt;&lt; iLayer &lt;&lt; &quot;\t&quot; &lt;&lt; mdtTrk-&gt;GetHitMult(iLayer) &lt;&lt; &quot;\t&quot; &lt;&lt; mdtHits &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    }</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;      }</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  }</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;      <span class="keywordflow">if</span> (fDebugMode)</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  {</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    Float_t ntuple[] = {vertex.X(), vertex.Y(), vertex.Z(),</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;            vertexD.X(), vertexD.Y(), vertexD.Z(), vertex.Phi(), </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;            helix-&gt;<a class="code" href="../../d2/dfb/classFairTrackPar.html#a82b3d239ff710c04550cea5df141864d">GetMomentum</a>().Mag(), helix-&gt;<a class="code" href="../../d2/dfb/classFairTrackPar.html#a9c2d5f4a3f77c99943f7ad68ce48d73c">GetQ</a>(), helix-&gt;<a class="code" href="../../d2/dfb/classFairTrackPar.html#a82b3d239ff710c04550cea5df141864d">GetMomentum</a>().Theta(), helix-&gt;<a class="code" href="../../de/d81/classFairTrackParH.html#a4c5b3597ad017023382d3ab907b1d01f">GetZ</a>(),</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;            mdtPos.X(), mdtPos.Y(), mdtPos.Z(), mdtPos.Phi(), mdtTempMom,</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;            dist, mdtHit-&gt;GetModule(), vertex.DeltaPhi(mdtPos), mdtGLength, mdtLayer, mdtHits};</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    mdtCorr-&gt;Fill(ntuple);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  }</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    }</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  </div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  <span class="keywordflow">if</span> ((mdtQuality&lt;fCorrPar-&gt;GetMdtCut()) || ( fIdeal &amp;&amp; mdtIndex!=-1))</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    {</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;      pidCand-&gt;SetMuoIndex(mdtIndex);</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;      pidCand-&gt;SetMuoQuality(mdtQuality);</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      pidCand-&gt;SetMuoIron(mdtIron);</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;      pidCand-&gt;SetMuoMomentumIn(mdtMom);</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;      pidCand-&gt;SetMuoModule(mdtMod);</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;      pidCand-&gt;SetMuoNumberOfLayers(mdtLayer); </div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;      pidCand-&gt;SetMuoHits(mdtHits);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    }</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  </div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  <span class="keywordflow">if</span> (fMdtRefit &amp;&amp; (mdtIndex!=-1) &amp;&amp; (mdtMom&gt;0.)  )</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    {</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;      PndMdtTrk *mdtTrk = (PndMdtTrk*)fMdtTrk-&gt;At(mdtIndex); </div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;      <a class="code" href="../../d4/d3f/classPndTrack.html">PndTrack</a> *mdtTrack = <span class="keyword">new</span> <a class="code" href="../../d4/d3f/classPndTrack.html">PndTrack</a>(*track);</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;      <a class="code" href="../../dd/d26/classPndTrackCand.html">PndTrackCand</a> *oldCand = track-&gt;<a class="code" href="../../d4/d3f/classPndTrack.html#a0acd486c2e08869791a85e591cd275fc">GetTrackCandPtr</a>();</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;      <a class="code" href="../../dd/d26/classPndTrackCand.html">PndTrackCand</a> *newCand = mdtTrk-&gt;AddTrackCand(oldCand);</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;      mdtTrack-&gt;<a class="code" href="../../d4/d3f/classPndTrack.html#a9d78fc4b9063c3848b2a01f25d681b1d">SetTrackCand</a>(*newCand);</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;      Int_t fCharge= mdtTrack-&gt;<a class="code" href="../../d4/d3f/classPndTrack.html#a9890a5410e7cf6eb02f42cd441cd900e">GetParamFirst</a>().<a class="code" href="../../d2/dfb/classFairTrackPar.html#a9c2d5f4a3f77c99943f7ad68ce48d73c">GetQ</a>();</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;      Int_t PDGCode = <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a>*fCharge;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    </div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      <a class="code" href="../../d4/d3f/classPndTrack.html">PndTrack</a> *fitTrack = <span class="keyword">new</span> <a class="code" href="../../d4/d3f/classPndTrack.html">PndTrack</a>();</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;      fitTrack = fFitter-&gt;Fit(mdtTrack, PDGCode);</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      <a class="code" href="../../d4/d3f/classPndTrack.html">PndTrack</a>* pndTrack = <span class="keyword">new</span> <a class="code" href="../../d4/d3f/classPndTrack.html">PndTrack</a>(fitTrack-&gt;<a class="code" href="../../d4/d3f/classPndTrack.html#a9890a5410e7cf6eb02f42cd441cd900e">GetParamFirst</a>(), fitTrack-&gt;<a class="code" href="../../d4/d3f/classPndTrack.html#a43a935dbdeeab8e55ec747d141414398">GetParamLast</a>(), fitTrack-&gt;<a class="code" href="../../d4/d3f/classPndTrack.html#a0ba106ff3ff577efb4232b09c2736e7b">GetTrackCand</a>(),</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;          fitTrack-&gt;<a class="code" href="../../d4/d3f/classPndTrack.html#a3861651046c7239c53b4e0e0bc87250c">GetFlag</a>(), fitTrack-&gt;<a class="code" href="../../d4/d3f/classPndTrack.html#a25e8231e189d3ec6271d81a6e4b7ae34">GetChi2</a>(), fitTrack-&gt;<a class="code" href="../../d4/d3f/classPndTrack.html#a96f0a900aa1898ff61ff63020e488d45">GetNDF</a>(), fitTrack-&gt;<a class="code" href="../../d4/d3f/classPndTrack.html#ac29446e2d97ba21bf72018bcd999750a">GetPidHypo</a>(), fitTrack-&gt;<a class="code" href="../../d4/d3f/classPndTrack.html#a06697d06d444b600d2b50bc42dbb51bb">GetRefIndex</a>(), <a class="code" href="../../d8/d35/PndDetectorList_8h.html#a4fbb72617d082bcd585da15e8bf60fc7a83609f51b76c639d2cccbb63b1c329d5">kLheTrack</a>);</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      AddMdtTrack(pndTrack);</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    }</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  <span class="keywordflow">return</span> kTRUE;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;}</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="comment">//_________________________________________________________________</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;Bool_t PndPidCorrelator::GetDrcInfo(<a class="code" href="../../de/d81/classFairTrackParH.html">FairTrackParH</a>* helix, <a class="code" href="../../df/d33/classPndPidCandidate.html">PndPidCandidate</a>* pidCand) {</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  <span class="keywordflow">if</span> (helix-&gt;<a class="code" href="../../de/d81/classFairTrackParH.html#a4c5b3597ad017023382d3ab907b1d01f">GetZ</a>()&gt;120.) <span class="keywordflow">return</span> kFALSE; <span class="comment">// cut fwd endcap tracks</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  <a class="code" href="../../d1/dca/classFairGeanePro.html">FairGeanePro</a> *fProDrc = <span class="keyword">new</span> <a class="code" href="../../d1/dca/classFairGeanePro.html">FairGeanePro</a>();</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#afa5d1c9a95012384c31c423dad1cd21c">fCorrErrorProp</a>) fProDrc-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#ae74a71b2268ab43db0d4056c26840cdd">PropagateOnlyParameters</a>();</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  <span class="comment">//---</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  PndDrcHit *drcHit = NULL;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  Int_t drcEntries = fDrcHit-&gt;GetEntriesFast();</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  Int_t drcIndex = -1, drcPhot = 0;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  Float_t drcThetaC = -1000, drcThetaCErr = 0, drcGLength = -1000;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;  Float_t drcQuality = 1000000;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  </div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  TVector3 vertex(0., 0., 0.);</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  Float_t vertex_z = -1000;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;  TVector3 drcPos(0., 0., 0.);</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  TVector3 <a class="code" href="../../d2/dcb/InteractionsTests_8cpp.html#ae8c383eee21959418ab07be9d62b43cb">momentum</a>(0., 0., 0.);</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a0923736cb5697a5e1f9236d512340f5e">fGeanePro</a>) <span class="comment">// Overwrites vertex if Geane is used</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    {     </div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      fProDrc-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#a057f6b2fcb8a268d377d478e88dc7da6">PropagateToVolume</a>(<span class="stringliteral">&quot;BarrelDIRC&quot;</span>,0,1);</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;      vertex.SetXYZ(-10000, -10000, -10000); <span class="comment">// reset vertex</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      <a class="code" href="../../de/d81/classFairTrackParH.html">FairTrackParH</a> *fRes= <span class="keyword">new</span> <a class="code" href="../../de/d81/classFairTrackParH.html">FairTrackParH</a>();</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;      Bool_t rc =  fProDrc-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#aa2a05972e893284f107f3e2ca5db05d6">Propagate</a>(helix, fRes, <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a>*pidCand-&gt;<a class="code" href="../../df/d33/classPndPidCandidate.html#a9e0641f35922cd31e2e29471126a129c">GetCharge</a>());   </div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;      <span class="keywordflow">if</span> (!rc) <span class="keywordflow">return</span> kFALSE;</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;      vertex.SetXYZ(fRes-&gt;<a class="code" href="../../de/d81/classFairTrackParH.html#a2cb6c554c49ca46ba3d812aaf60fcb7c">GetX</a>(), fRes-&gt;<a class="code" href="../../de/d81/classFairTrackParH.html#a057fca591ac539c2b716ef7066591b7f">GetY</a>(), 0.);</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;      vertex_z = fRes-&gt;<a class="code" href="../../de/d81/classFairTrackParH.html#a4c5b3597ad017023382d3ab907b1d01f">GetZ</a>();</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;      drcGLength = fProDrc-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#a17a41a27dfaadf86873f5ccc822c41e9">GetLengthAtPCA</a>();</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;      <span class="keywordflow">if</span> (drcGLength&lt;25.) <span class="keywordflow">return</span> kFALSE;  <span class="comment">// additional cut on extrapolation distance to avoid fake correlations</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    }</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  </div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  <span class="keywordflow">for</span> (Int_t dd = 0; dd&lt;drcEntries; dd++)</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    {</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;      drcHit = (PndDrcHit*)fDrcHit-&gt;At(dd); </div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;      <span class="keywordflow">if</span> ( fIdeal &amp;&amp; ( ((PndDrcBarPoint*)fDrcPoint-&gt;At(drcHit-&gt;GetRefIndex()))-&gt;GetTrackID() !=pidCand-&gt;<a class="code" href="../../df/d33/classPndPidCandidate.html#a820deb20125c21ce39cea26e56c9b0d2">GetMcIndex</a>()) ) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;      drcHit-&gt;Position(drcPos);</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;      </div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;      Float_t dphi = vertex.DeltaPhi(drcPos);</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;      Float_t dist = dphi * dphi;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;      <span class="keywordflow">if</span> (drcQuality &gt; dist)</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;  {</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    drcIndex = dd;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    drcQuality = dist;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    drcThetaC = drcHit-&gt;GetThetaC();</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    drcThetaCErr = drcHit-&gt;GetErrThetaC();</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    drcPhot = 0; <span class="comment">// ** to be filled **</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  }</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;      <span class="keywordflow">if</span> (fDebugMode)</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;  {</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    Float_t ntuple[] = {vertex.X(), vertex.Y(), vertex_z, vertex.Phi(),  </div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;            helix-&gt;<a class="code" href="../../d2/dfb/classFairTrackPar.html#a82b3d239ff710c04550cea5df141864d">GetMomentum</a>().Mag(), helix-&gt;<a class="code" href="../../d2/dfb/classFairTrackPar.html#a9c2d5f4a3f77c99943f7ad68ce48d73c">GetQ</a>(), helix-&gt;<a class="code" href="../../d2/dfb/classFairTrackPar.html#a82b3d239ff710c04550cea5df141864d">GetMomentum</a>().Theta(), helix-&gt;<a class="code" href="../../de/d81/classFairTrackParH.html#a4c5b3597ad017023382d3ab907b1d01f">GetZ</a>(),</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;            drcPos.X(), drcPos.Y(), drcPos.Phi(), dist, drcHit-&gt;GetThetaC(), 0., vertex.DeltaPhi(drcPos), drcGLength,</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;            pidCand-&gt;<a class="code" href="../../df/d33/classPndPidCandidate.html#a5f41fe4272fb80fc734fa42af67dd6c9">GetFitStatus</a>()</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    };</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    drcCorr-&gt;Fill(ntuple);</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  }</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    }</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  </div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;  <span class="keywordflow">if</span> ((drcQuality&lt;fCorrPar-&gt;GetDrcCut()) || (fIdeal &amp;&amp; drcIndex!=-1))</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    {</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;      pidCand-&gt;SetDrcQuality(drcQuality);</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      pidCand-&gt;SetDrcThetaC(drcThetaC);</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      pidCand-&gt;SetDrcThetaCErr(drcThetaCErr);</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      pidCand-&gt;SetDrcNumberOfPhotons(drcPhot);</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      pidCand-&gt;SetDrcIndex(drcIndex);</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    }</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;  <span class="keywordflow">return</span> kTRUE;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;}</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="comment">//_________________________________________________________________</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;Bool_t PndPidCorrelator::GetDskInfo(<a class="code" href="../../de/d81/classFairTrackParH.html">FairTrackParH</a>* helix, <a class="code" href="../../df/d33/classPndPidCandidate.html">PndPidCandidate</a>* pidCand) {</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  <span class="keywordflow">if</span> (helix-&gt;<a class="code" href="../../de/d81/classFairTrackParH.html#a4c5b3597ad017023382d3ab907b1d01f">GetZ</a>()&lt;180.) <span class="keywordflow">return</span> kFALSE; <span class="comment">// consider tracks only from last gem plane</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  </div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  <a class="code" href="../../d1/dca/classFairGeanePro.html">FairGeanePro</a> *fProDsk = <span class="keyword">new</span> <a class="code" href="../../d1/dca/classFairGeanePro.html">FairGeanePro</a>(); </div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#afa5d1c9a95012384c31c423dad1cd21c">fCorrErrorProp</a>) fProDsk-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#ae74a71b2268ab43db0d4056c26840cdd">PropagateOnlyParameters</a>();</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  <span class="comment">//---</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  PndDskParticle *dskParticle = NULL;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  Int_t dskEntries = fDskParticle-&gt;GetEntriesFast();</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  Int_t dskIndex = -1, dskPhot = 0;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  Float_t dskThetaC = -1000, dskThetaCErr = 0, dskGLength = -1000;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  Float_t dskQuality = 1000000;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;  Float_t x_p = -1000;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;  </div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;  TVector3 vertex(0., 0., 0.);</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  TVector3 dskPos(0., 0., 0.);</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  TVector3 <a class="code" href="../../d2/dcb/InteractionsTests_8cpp.html#ae8c383eee21959418ab07be9d62b43cb">momentum</a>(0., 0., 0.);</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a0923736cb5697a5e1f9236d512340f5e">fGeanePro</a>) <span class="comment">// Overwrites vertex if Geane is used</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    {     </div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;      fProDsk-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#a057f6b2fcb8a268d377d478e88dc7da6">PropagateToVolume</a>(<span class="stringliteral">&quot;Plate&quot;</span>,0,1);</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      vertex.SetXYZ(-10000, -10000, -10000); <span class="comment">// reset vertex</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      <a class="code" href="../../de/d81/classFairTrackParH.html">FairTrackParH</a> *fRes= <span class="keyword">new</span> <a class="code" href="../../de/d81/classFairTrackParH.html">FairTrackParH</a>();</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      Bool_t rc =  fProDsk-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#aa2a05972e893284f107f3e2ca5db05d6">Propagate</a>(helix, fRes, <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ad1931afd5b1a70cec781db103d37f095">fPidHyp</a>*pidCand-&gt;<a class="code" href="../../df/d33/classPndPidCandidate.html#a9e0641f35922cd31e2e29471126a129c">GetCharge</a>());</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      <span class="keywordflow">if</span> (!rc) <span class="keywordflow">return</span> kFALSE;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      vertex.SetXYZ(fRes-&gt;<a class="code" href="../../de/d81/classFairTrackParH.html#a2cb6c554c49ca46ba3d812aaf60fcb7c">GetX</a>(), fRes-&gt;<a class="code" href="../../de/d81/classFairTrackParH.html#a057fca591ac539c2b716ef7066591b7f">GetY</a>(), fRes-&gt;<a class="code" href="../../de/d81/classFairTrackParH.html#a4c5b3597ad017023382d3ab907b1d01f">GetZ</a>());</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;      dskGLength = fProDsk-&gt;<a class="code" href="../../d1/dca/classFairGeanePro.html#a17a41a27dfaadf86873f5ccc822c41e9">GetLengthAtPCA</a>();</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      x_p = fRes-&gt;<a class="code" href="../../d2/dfb/classFairTrackPar.html#a82b3d239ff710c04550cea5df141864d">GetMomentum</a>().Mag();</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    }</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;  </div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;  <span class="keywordflow">for</span> (Int_t dd = 0; dd&lt;dskEntries; dd++)</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    {</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;      dskParticle = (PndDskParticle*)fDskParticle-&gt;At(dd);</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;      <span class="keywordflow">if</span> ( fIdeal &amp;&amp; (dskParticle-&gt;GetTrackID() !=pidCand-&gt;<a class="code" href="../../df/d33/classPndPidCandidate.html#a820deb20125c21ce39cea26e56c9b0d2">GetMcIndex</a>()) ) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;      dskParticle-&gt;Position(dskPos);</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      </div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      Float_t dist = (vertex-dskPos).Mag2();    </div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      <span class="keywordflow">if</span> ( dskQuality &gt; dist)</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;  {</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    dskIndex = dd;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    dskQuality = dist;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    dskThetaC = dskParticle-&gt;GetThetaC();</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="comment">//dskThetaCErr = dskParticle-&gt;GetErrThetaC();</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    dskPhot = 0; <span class="comment">// ** to be filled **</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;  }</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      <span class="keywordflow">if</span> (fDebugMode)</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;  {</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    Float_t ntuple[] = {vertex.X(), vertex.Y(), vertex.Z(), vertex.Phi(),</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;            helix-&gt;<a class="code" href="../../d2/dfb/classFairTrackPar.html#a82b3d239ff710c04550cea5df141864d">GetMomentum</a>().Mag(), helix-&gt;<a class="code" href="../../d2/dfb/classFairTrackPar.html#a9c2d5f4a3f77c99943f7ad68ce48d73c">GetQ</a>(), helix-&gt;<a class="code" href="../../d2/dfb/classFairTrackPar.html#a82b3d239ff710c04550cea5df141864d">GetMomentum</a>().Theta(), helix-&gt;<a class="code" href="../../de/d81/classFairTrackParH.html#a4c5b3597ad017023382d3ab907b1d01f">GetZ</a>(),</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;            dskPos.X(), dskPos.Y(), dskPos.Z(), dskPos.Phi(), dist, dskParticle-&gt;GetThetaC(), 0., vertex.DeltaPhi(dskPos), dskGLength,</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;            helix-&gt;<a class="code" href="../../de/d81/classFairTrackParH.html#a2cb6c554c49ca46ba3d812aaf60fcb7c">GetX</a>(), helix-&gt;<a class="code" href="../../de/d81/classFairTrackParH.html#a057fca591ac539c2b716ef7066591b7f">GetY</a>(), helix-&gt;<a class="code" href="../../de/d81/classFairTrackParH.html#a4c5b3597ad017023382d3ab907b1d01f">GetZ</a>(), x_p, pidCand-&gt;<a class="code" href="../../df/d33/classPndPidCandidate.html#a5f41fe4272fb80fc734fa42af67dd6c9">GetFitStatus</a>()</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;};</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    dskCorr-&gt;Fill(ntuple);</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;  }</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    }</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;  </div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;  <span class="keywordflow">if</span> ((dskQuality&lt;fCorrPar-&gt;GetDskCut()) || (fIdeal &amp;&amp; dskIndex!=-1))</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    {</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;      pidCand-&gt;SetDiscQuality(dskQuality);</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;      pidCand-&gt;SetDiscThetaC(dskThetaC);</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      <span class="comment">//pidCand-&gt;SetDskThetaCErr(dskThetaCErr);</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;      pidCand-&gt;SetDiscNumberOfPhotons(dskPhot);</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;      pidCand-&gt;SetDiscIndex(dskIndex);</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    }</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;  <span class="keywordflow">return</span> kTRUE;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;}</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="comment">//_________________________________________________________________</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"><a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a567b99ae8ac84b12d7431bde711cd48c"> 1434</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a567b99ae8ac84b12d7431bde711cd48c">PndPidCorrelator::Register</a>() {</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  <span class="comment">//---</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;  TString chargName = <span class="stringliteral">&quot;PidChargedCand&quot;</span> + <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a2d3667dbc8768ad37631d147a63e9914">fTrackOutBranch</a>;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;  <a class="code" href="../../d0/d6c/classFairRootManager.html#a830b7803b29e7424a75f2dc374dcc96b">FairRootManager::Instance</a>()-&gt;<a class="code" href="../../d0/d6c/classFairRootManager.html#a18838841d44029983d5a855b46417591">Register</a>(chargName,<span class="stringliteral">&quot;Pid&quot;</span>, <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#af9bfe67c10fb5056e1ee1234d0d4ab08" title="PndTrackID TCA.">fPidChargedCand</a>, kTRUE); </div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="preprocessor">#if _TODAY_</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="preprocessor"></span>  <a class="code" href="../../d0/d6c/classFairRootManager.html#a830b7803b29e7424a75f2dc374dcc96b">FairRootManager::Instance</a>()-&gt;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a567b99ae8ac84b12d7431bde711cd48c">Register</a>(<span class="stringliteral">&quot;PidNeutralCand&quot;</span>,<span class="stringliteral">&quot;Pid&quot;</span>, fPidNeutralCand, kTRUE);</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  <span class="keywordflow">if</span> (fMdtRefit)</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    {</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;      <a class="code" href="../../d0/d6c/classFairRootManager.html#a830b7803b29e7424a75f2dc374dcc96b">FairRootManager::Instance</a>()-&gt;</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;  <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a567b99ae8ac84b12d7431bde711cd48c">Register</a>(<span class="stringliteral">&quot;MdtTrack&quot;</span>,<span class="stringliteral">&quot;Pid&quot;</span>, fMdtTrack, kTRUE);</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    }</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="preprocessor"></span>}</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;<span class="comment">//_________________________________________________________________</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"><a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a08c8067ccc14f15d2b02934a2be95a08"> 1451</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#a08c8067ccc14f15d2b02934a2be95a08">PndPidCorrelator::Finish</a>() {</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="preprocessor">#if _TODAY_</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="preprocessor"></span>  <span class="comment">//---</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;  <span class="keywordflow">if</span> (fDebugMode)</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    {</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;      <span class="comment">//TFile *r = TFile::Open(sDir+sFile,&quot;RECREATE&quot;);</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;      r-&gt;cd();</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;      tofCorr-&gt;Write();</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;      ftofCorr-&gt;Write();</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      emcCorr-&gt;Write(); </div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;      fscCorr-&gt;Write();</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;      mdtCorr-&gt;Write();  </div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;      drcCorr-&gt;Write();</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      dskCorr-&gt;Write();</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;      r-&gt;Save();</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    </div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;      tofCorr-&gt;Delete();</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;      ftofCorr-&gt;Delete();</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;      emcCorr-&gt;Delete(); </div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;      fscCorr-&gt;Delete();</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;      mdtCorr-&gt;Delete();</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;      drcCorr-&gt;Delete();</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;      dskCorr-&gt;Delete();</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    </div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;      tofCorr = 0;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;      ftofCorr = 0;</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;      emcCorr = 0; </div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;      fscCorr = 0;</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;      mdtCorr = 0;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;      drcCorr = 0;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;      dskCorr = 0;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    </div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;      r-&gt;Close();</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;      r-&gt;Delete();</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    }</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;<span class="preprocessor">#endif  </span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="preprocessor"></span>}</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="comment">//_________________________________________________________________</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"><a class="code" href="../../dd/d8c/classPndPidCorrelator.html#adba4c855b67ae00ebfffc42364ff6726"> 1490</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#adba4c855b67ae00ebfffc42364ff6726">PndPidCorrelator::Reset</a>() {</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="preprocessor">#if _TODAY_</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="preprocessor"></span>  <span class="comment">//---</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;  fMvdPath = 0.;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  fMvdELoss = 0.;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;  fMvdHitCount = 0;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;  fEmcClstCount = 0;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  fFscClstCount = 0;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;  fClusterList.clear();</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;  fClusterQ.clear();</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  mapMdtBarrel.clear();</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  mapMdtEndcap.clear();</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  mapMdtForward.clear();</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="preprocessor"></span>}</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="comment">//_________________________________________________________________</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"><a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ac72ed899e62455aacc92a32c423dd3ed"> 1507</a></span>&#160;<a class="code" href="../../df/d33/classPndPidCandidate.html">PndPidCandidate</a>* <a class="code" href="../../dd/d8c/classPndPidCorrelator.html#ac72ed899e62455aacc92a32c423dd3ed">PndPidCorrelator::AddChargedCandidate</a>(<a class="code" href="../../df/d33/classPndPidCandidate.html">PndPidCandidate</a>* cand) {</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  <span class="comment">// Creates a new hit in the TClonesArray.</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;  TClonesArray&amp; pidRef = *<a class="code" href="../../dd/d8c/classPndPidCorrelator.html#af9bfe67c10fb5056e1ee1234d0d4ab08" title="PndTrackID TCA.">fPidChargedCand</a>;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  Int_t size = pidRef.GetEntriesFast();</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">new</span>(pidRef[size]) <a class="code" href="../../df/d33/classPndPidCandidate.html">PndPidCandidate</a>(*cand);</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;}</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="preprocessor">#if _TODAY_</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="preprocessor"></span><span class="comment">//_________________________________________________________________</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<a class="code" href="../../df/d33/classPndPidCandidate.html">PndPidCandidate</a>* PndPidCorrelator::AddNeutralCandidate(<a class="code" href="../../df/d33/classPndPidCandidate.html">PndPidCandidate</a>* cand) {</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;  <span class="comment">// Creates a new hit in the TClonesArray.</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  </div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  TClonesArray&amp; pidRef = *fPidNeutralCand;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;  Int_t size = pidRef.GetEntriesFast();</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">new</span>(pidRef[size]) <a class="code" href="../../df/d33/classPndPidCandidate.html">PndPidCandidate</a>(*cand);</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;}</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="comment">//_________________________________________________________________</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<a class="code" href="../../d4/d3f/classPndTrack.html">PndTrack</a>* PndPidCorrelator::AddMdtTrack(<a class="code" href="../../d4/d3f/classPndTrack.html">PndTrack</a>* track) {</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;  <span class="comment">// Creates a new hit in the TClonesArray.</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  </div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;  TClonesArray&amp; pidRef = *fMdtTrack;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;  Int_t size = pidRef.GetEntriesFast();</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">new</span>(pidRef[size]) <a class="code" href="../../d4/d3f/classPndTrack.html">PndTrack</a>(*track);</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;}</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<a class="code" href="../../d5/db4/FairBaseContFact_8cxx.html#a9a58628a02b777c6a2e166100e5b7a81">ClassImp</a>(<a class="code" href="../../dd/d8c/classPndPidCorrelator.html">PndPidCorrelator</a>)</div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->

<!-- start footer part -->
<div id="nav-path" class="navpath">
	<!-- id is needed for treeview function! -->
	<ul>
		<li class="navelem"><a class="el" href="../../dir_d7aa557fabe0dbc710c3133bbb38c9dd.html">EicRoot</a></li><li class="navelem"><a class="el" href="../../dir_6c2f52c7c502fdce4930bf509aa7892f.html">blob</a></li><li class="navelem"><a class="el" href="../../dir_b7851b2c5844943c52ef11ccfc82d757.html">master</a></li><li class="navelem"><a class="el" href="../../dir_ba356c042a2324daf83c533bbc9bd0c8.html">pid</a></li><li class="navelem"><a class="el" href="../../dir_2d9f2bf3e52552e4d54f4dae40028f8c.html">PidCorr</a></li><li class="navelem"><a class="el" href="../../dd/dd9/PndPidCorrelator_8cxx.html">PndPidCorrelator.cxx</a></li>
		<li class="footer">
		Built by <a href="mailto:jhuang@bnl.gov">Jin Huang</a></em>.
			updated: <em>Mon Jan 22 2024 12:43:37</em> using <a
			href="http://www.doxygen.org/index.html"> <img class="footer"
				src="../../doxygen.png" alt="doxygen" /></a> 1.8.2 
				with <a href="https://github.com/eic">EIC GitHub integration</a>
		</li>
	</ul>
</div>
</body>
</html>
