<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />
<title>EIC Software: EicRoot/blob/master/eic/ayk/MgridInterpolation.h Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script> <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script> 
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-155388685-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-155388685-3');
</script>
</head>
<body>
	<div id="top">
		<!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectlogo"><a href="https://eic.github.io/"><img
								alt="Logo" src="../../ion-collision-xparent-crop.png" height="100"/></a></td>
						<td style="padding-left: 0.5em;">
							<div id="projectname">
								EIC Software
							</div> 
							<div id="projectbrief">
								Reference for 
								<a href="https://eic.github.io/">EIC</a> 
								<a href="https://github.com/eic/">simulation and reconstruction software on GitHub</a>
							</div> 
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Home&#160;page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../usergroup0.html"><span>External&#160;Links</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dd/dd8/MgridInterpolation_8h_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">MgridInterpolation.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../dd/dd8/MgridInterpolation_8h.html">Go to the documentation of this file.</a> Or view <a target="top" href="https://github.com/eic/EicRoot/blob/master/eic/ayk/MgridInterpolation.h">the newest version in sPHENIX GitHub for file MgridInterpolation.h</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* -------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/*  MgridInterpolation.h                                                      */</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">/*  A.Kisselev, PNPI, St.Petersburg, Russia.                                  */</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">/*    e-mail: kisselev@hermes.desy.de                                         */</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">/* -------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="../../d4/d35/ThreeDeePolySpace_8h.html">ThreeDeePolySpace.h</a>&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#ifndef _MGRID_INTERPOLATION_H</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define _MGRID_INTERPOLATION_H</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00013"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#ae663413a07a9fd753a7a1098f2ef75af">   13</a></span>&#160;<span class="keyword">typedef</span> double (*<a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#ae663413a07a9fd753a7a1098f2ef75af">interfun</a>)(<span class="keywordtype">double</span> xx, <span class="keywordtype">double</span> coord[], <span class="keywordtype">double</span> <a class="code" href="../../d3/d32/has__duplicates_8hpp.html#a5b4ee4ae6cba6bb75200ba7af1910873">value</a>[]);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// No interpolation at all (take nearest node value); </span></div>
<div class="line"><a name="l00016"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#a72318b8e65a522cb09ce1eef8fe3df23">   16</a></span>&#160;<span class="preprocessor">#define _NO_INTERPOLATION_                 0</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor"></span><span class="comment">// Sequential interpolation in XYZ direction in some order;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// dimensions are 2..4; &#39;2&#39; is linear interpolation,       </span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// &#39;3&#39; - quadratic, &#39;4&#39; - weighted quadratic (the latter   </span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// two are after WWC);                                     </span></div>
<div class="line"><a name="l00021"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#a0c982c8f73342baee4f8d7533c942b79">   21</a></span>&#160;<span class="preprocessor">#define _SEQUENTIAL_FAST_INTERPOLATION_    1</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor"></span><span class="comment">// The same, but at any dimension, orthogonal polynomials used; </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// moderately CPU intensive;                                    </span></div>
<div class="line"><a name="l00024"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#a01f2c9e276348fc917e6f20a301ee39d">   24</a></span>&#160;<span class="preprocessor">#define _SEQUENTIAL_HIGH_INTERPOLATION_    2</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor"></span><span class="comment">// Well, this mode is mathematically incorrect, because it does not    </span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// take into account possible spread of fitting errors after first 1-2 </span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">// directions; on the other hand taking them into account may lead     </span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">// to a complete screw up, because one either have to rely on the      </span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">// &#39;weight&#39; field, or renormalize by sqrt(chi^2/ndf) and it is not     </span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">// clear would not it be better to ignore errors all together;         </span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// besides this CPU usage will blow up since basis needs to be redone  </span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// for every new xx[];                                                 </span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">// for practical reasons this mode is left in (it is indeed more       </span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">// reasonable that interpolation with big adim[] since it gives        </span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">// more smooth fit); if one wants fit instead of interpolation         </span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">// and cares about mathematical correctness, _MGRID_MULTI_DIM_FITTING_ </span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">// is the way to go;                                                    </span></div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#a0cc0b0b872e9f8be4dfa0d1182a62f0f">   38</a></span>&#160;<span class="preprocessor">#define _SEQUENTIAL_HIGH_FITTING_          3</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor"></span><span class="comment">// A global 3dim polynomial interpolation (very CPU intensive); </span></div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#ad8a7f735fa87377fb0fec1d1f7f76531">   40</a></span>&#160;<span class="preprocessor">#define _MULTI_DIM_INTERPOLATION_          4</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor"></span><span class="comment">// The same, but number of cells may be more than overall          </span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">// degree of polynomial; NB: basis is built only ONCE, assuming    </span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">// that weight=1. in all points; attempt to change weights for     </span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">// individual xx[] points afterwards will result in wrong fitting; </span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">// in principle one can of course introduce a &#39;professional&#39; mode  </span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">// when basis is calculated every time new (and it is in fact very </span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">// easy to do), but for now assume that all points have always     </span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">// equal errors;                                                   </span></div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#af249cbcf798ebbd2aeb58de330fadba5">   49</a></span>&#160;<span class="preprocessor">#define _MULTI_DIM_FITTING_                5</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">// For now do not see need for more than 6 doubles (3 field   </span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">// components + 3 estimated errors); do not want &#39;double *B&#39;  </span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">// because the beginning of this structure will go directly   </span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">// into a data file; NB: the code will be backward compatible </span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">// with older versions even if one day this DIM will be       </span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">// increased, because the actual length is written in file    </span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">// header upon creation;                                      </span></div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#a24c0f6c4228ccbe5edbbcc3fd428a2b6">   59</a></span>&#160;<span class="preprocessor">#define _CELL_DATA_DIM_MAX_ 10</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">// This format header lines (property&amp;B[]) should never change!; </span></div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="code" href="../../d8/dec/structMgridCell.html">   62</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d8/dec/structMgridCell.html">MgridCell</a> {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">// N field components; perhaps anything else dazu; </span></div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="code" href="../../d8/dec/structMgridCell.html#ab66e3a9bc8cdafe3fed29115e9f5c513">   64</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d8/dec/structMgridCell.html#ab66e3a9bc8cdafe3fed29115e9f5c513">B</a>[<a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#a24c0f6c4228ccbe5edbbcc3fd428a2b6">_CELL_DATA_DIM_MAX_</a>];</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="comment">// !!! Do not touch fields above this line (apart from changing    </span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="comment">// _CELL_DATA_DIM_MAX_); well, in fact B[] to be the first element </span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="comment">// in this structure is the only requirement;                      </span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="comment">// The rest will not be stored in data files, but it is         </span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">// convenient to have this stuff in right here;                 </span></div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="code" href="../../d8/dec/structMgridCell.html#a8335652a519a2c85e87bb99c7ae53576">   74</a></span>&#160;  <span class="keywordtype">void</span> *<a class="code" href="../../d8/dec/structMgridCell.html#a8335652a519a2c85e87bb99c7ae53576">ptr</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="code" href="../../d8/dec/structMgridCell.html#a008c5a34401a46f3bed081a5f8766057">   76</a></span>&#160;  <a class="code" href="../../d8/dec/structMgridCell.html">MgridCell</a> *<a class="code" href="../../d8/dec/structMgridCell.html#a008c5a34401a46f3bed081a5f8766057">next</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;} ;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">// Possible bits in mgrid-&gt;object_contents_bits; </span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">// cell-&gt;B[] stuff (field + errors + ...);       </span></div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#a2d4c5a2feb0f03a3309e0943aaaa5433">   81</a></span>&#160;<span class="preprocessor">#define _CELL_DATA_                0x01</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor"></span><span class="comment">// Cell properties (since they are of char type it is </span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">// more economic to keep them in a separate array);   </span></div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#a721209aba2b0251e466ab0dcf1694b81">   84</a></span>&#160;<span class="preprocessor">#define _CELL_PROPERTIES_          0x02</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">// Possible bits of mgrid-&gt;cell_contents_bits; do not forget to </span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">// change max known bit #define below;                          </span></div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#a4ea26f3a8f82b70a12e56456e7201d3b">   88</a></span>&#160;<span class="preprocessor">#define _FIELD_COMPONENT_VALUES_   0x01</span></div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#a2f3aade4adaaca9bb0a8b51af17b6d0c">   89</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define _FIELD_COMPONENT_ERRORS_   0x02</span></div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#a31a1db55569c2a4996f370920a9e7c27">   90</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define _FIT_CHI_SQUARE_           0x04</span></div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#ae612e0d265b0f2ce6ed930ee7d1f2e29">   91</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define _CELL_COORDINATES_         0x08</span></div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#acdf7af9b8d42cb0a215ee68654586b8d">   92</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define _FIELD_GRADIENTS_          0x10</span></div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#a792c05f695f4b883cbbbaeb3326d5415">   93</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define _1D_FIELD_ERRORS_          0x20</span></div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#a30146c1451b4e0801a00a1018ad54021">   94</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define _3D_FIELD_ERRORS_          0x40</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor"></span><span class="comment">// Some sanity; does not help much; ok; </span></div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#a8ffa3bc3206f92ac5a2ae3a47c92c4e3">   96</a></span>&#160;<span class="preprocessor">#define _MAX_KNOWN_CELL_CONTENTS_BIT_ 7</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">// Possible cell status; should fit in 4 bits; the more the number </span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">// the worse this cell was;                                        </span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">// After the ASCII input all cells will be SAFE; after regriding cell </span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">// remains SAFE if 1) self-cell was SAFE, 2) ideal cube was used      </span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">// for interpolation/fitting without repositioning, 3) all neighbour  </span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">// cells used were SAFE;                                              </span></div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#a07165d78974e405db7c67e3df26888d6">  108</a></span>&#160;<span class="preprocessor">#define _SAFE_CELL_                0x01</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor"></span><span class="comment">// Basically means that regriding procedure for this cell either had </span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">// to reposition the cube, or to use EDGE self/neighbour cells;      </span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">// in other words this cell is on the edge of the grid;               </span></div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#a6dfb5f85f77ed3e6ac5cb6658fa46ad3">  112</a></span>&#160;<span class="preprocessor">#define _EDGE_CELL_                0x02</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor"></span><span class="comment">// This cell was either extrapolated from the other (known) cells    </span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">// or during it&#39;s creation EXTRA cells were used (means they were at </span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">// least allowed to be used - see self/neighbour allowed masks);     </span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">// creation of such cells is in principle straighforward, but not    </span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">// implemented yet;                                                  </span></div>
<div class="line"><a name="l00118"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#a46fea754d79231e2bfd60421673c4abe">  118</a></span>&#160;<span class="preprocessor">#define _EXTRA_CELL_               0x04</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="preprocessor"></span><span class="comment">// No info for this cell available; </span></div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#a062bd573c31c9458ecb445e34241baf8">  120</a></span>&#160;<span class="preprocessor">#define _DEAD_CELL_                0x08</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">// When creating a grid out of cell list either to put all components    </span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">// into separate grids and arrange mgrid heap (ON) or create a (2-3)-dim </span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">// mgrid right away (OFF); the former may be of interest if component    </span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">// grids are not guaranteed to be perfectly sitting on top of each other </span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">// for instance there are relative shifts which need to be found - it is </span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">// much easier to do moving around daughter grids inside a heap;           </span></div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#a0f6e64870ce84efb0dd3a6cc574e94ff">  128</a></span>&#160;<span class="preprocessor">#define _SPLIT_OFF_                   0</span></div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#a08d23aa6d707470bfff3ef086ddbb292">  129</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define _SPLIT_ON_                    1</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="keyword">class </span><a class="code" href="../../d0/d70/classMgrid.html">Mgrid</a>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="code" href="../../d9/dcf/structMgridCombiCell.html">  133</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d9/dcf/structMgridCombiCell.html">MgridCombiCell</a> {</div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="code" href="../../d9/dcf/structMgridCombiCell.html#a5651878ac1b49eb9637b994be9e829aa">  134</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d9/dcf/structMgridCombiCell.html#a5651878ac1b49eb9637b994be9e829aa">property</a>;</div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="code" href="../../d9/dcf/structMgridCombiCell.html#a9f07231532d6248d3ea5e990ee42bc7b">  135</a></span>&#160;  <a class="code" href="../../d8/dec/structMgridCell.html">MgridCell</a> *<a class="code" href="../../d9/dcf/structMgridCombiCell.html#a9f07231532d6248d3ea5e990ee42bc7b">cell</a>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;} ;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="code" href="../../d7/dd2/classMgridInterpolation.html">  138</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d7/dd2/classMgridInterpolation.html">MgridInterpolation</a> {</div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="code" href="../../d7/dd2/classMgridInterpolation.html#a4d04f66d88fba13419621697cf87775e">  139</a></span>&#160;  <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="../../d0/d70/classMgrid.html">Mgrid</a>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; <span class="keyword">private</span>:</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="comment">// Yes, convert old allocate_interpolation_frame() to a constructor;</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a17398c5b1873fddec773110520bc4bda">MgridInterpolation</a>(<a class="code" href="../../d0/d70/classMgrid.html">Mgrid</a> *mgrid);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="comment">// There are few different types (see definitions below); they            </span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="comment">// all give different accuracy and have a very different CPU consumption;  </span></div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="code" href="../../d7/dd2/classMgridInterpolation.html#a9c0113ff4a02289cd28a33d5791b6ebc">  147</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a9c0113ff4a02289cd28a33d5791b6ebc">mode</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="comment">// For safety (cross-check) purposes store address of a grid </span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="comment">// for which this interpolation was cooked; </span></div>
<div class="line"><a name="l00151"></a><span class="lineno"><a class="code" href="../../d7/dd2/classMgridInterpolation.html#a38f4592c35b51a4ab706f1932c44c2fe">  151</a></span>&#160;  <a class="code" href="../../d0/d70/classMgrid.html">Mgrid</a> *<a class="code" href="../../d7/dd2/classMgridInterpolation.html#a38f4592c35b51a4ab706f1932c44c2fe">_mgrid</a>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="comment">// Algorithm is expected to be fast and straightforward;           </span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="comment">// therefore KxMxN cube with adim[] sizes is chosen really as a    </span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="comment">// cube around xx[] point in a local grid coordinate sequence,     </span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="comment">// without any attempt to move it in order to have all             </span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="comment">// cells defined; if &#39;big&#39; cubes wanted, it is advisable           </span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="comment">// to add *extrapolated* &#39;galo&#39; cells outside of the measured area </span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="comment">// when producing mfile; NB: this may change in the future;        </span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="comment">// natural XYZ (RFZ) sequence;                                     </span></div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="code" href="../../d7/dd2/classMgridInterpolation.html#a25589fb7d97f4126de0c3ae54619cca7">  161</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a25589fb7d97f4126de0c3ae54619cca7">adim</a>[3];</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="comment">// Interpoaltion sequence -&gt; XYZ (RFZ) coordinates mapping;     </span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="comment">// sequence[0]=_Y_ means that interpolation is first done along </span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="comment">// Y (F) direction of XYZ (RFZ) coordinate system; used         </span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="comment">// in case of SEQUENTIAL modes only;                            </span></div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="code" href="../../d7/dd2/classMgridInterpolation.html#a9628477cef0a0ecc35112717f9fd1c53">  167</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a9628477cef0a0ecc35112717f9fd1c53">sequence</a>[3], <a class="code" href="../../d7/dd2/classMgridInterpolation.html#aedc1cc8dc3e1d7bddfe93e28c90d8409">reversed</a>[3];</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="comment">// -------------- The rest are working variables; --------------- </span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">// Bitwise mask of which types of cells may be considered    </span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="comment">// _EDGE_/_EXTRA_/_DEAD_; _DEAD_ for &#39;self_cell&#39; may make    </span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">// sense during extrapolation of original grig for exapmple; </span></div>
<div class="line"><a name="l00176"></a><span class="lineno"><a class="code" href="../../d7/dd2/classMgridInterpolation.html#acd9ed5a5f7797eb3b7d1b3b332c8d460">  176</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#acd9ed5a5f7797eb3b7d1b3b332c8d460">allowed_self_cells_mask</a>, <a class="code" href="../../d7/dd2/classMgridInterpolation.html#aec93513489800ce5238552984ba37c1f">allowed_neighbour_cells_mask</a>;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="comment">// Whether or not cube finder may shift cube with respect to &#39;best&#39; </span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">// position; is allowed per default; no need to change?;            </span></div>
<div class="line"><a name="l00179"></a><span class="lineno"><a class="code" href="../../d7/dd2/classMgridInterpolation.html#a665f844537be26ade5a1c14c88623c84">  179</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#aff44460e2e4fbd373415344b91c5ba03">cube_shift_allowed</a>, <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a665f844537be26ade5a1c14c88623c84">ideal_cube_required</a>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="comment">// KxMxN cell area; allocated linearly for simplicity; </span></div>
<div class="line"><a name="l00182"></a><span class="lineno"><a class="code" href="../../d7/dd2/classMgridInterpolation.html#af67aec364350aae4c833c478fd831a35">  182</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#af67aec364350aae4c833c478fd831a35">cube_cell_num</a>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="comment">// This is needed for the &#39;FAST&#39; mode; NB: interpolation index sequence!;</span></div>
<div class="line"><a name="l00185"></a><span class="lineno"><a class="code" href="../../d7/dd2/classMgridInterpolation.html#a8e55c9f0b3f568f59da992e1d67b4e63">  185</a></span>&#160;  <a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#ae663413a07a9fd753a7a1098f2ef75af">interfun</a> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a8e55c9f0b3f568f59da992e1d67b4e63">fun</a>[3];</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">// This is a polynomial degree used for fitting (may differ from adim[]); </span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="comment">// natural XYZ (RFZ) sequence, of course;                                 </span></div>
<div class="line"><a name="l00189"></a><span class="lineno"><a class="code" href="../../d7/dd2/classMgridInterpolation.html#a3960f818e93cf972b0605bd28e706aaa">  189</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a3960f818e93cf972b0605bd28e706aaa">pdim</a>[3];</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="comment">// If cubic area fails, few of the dimensions may be prohibited </span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="comment">// for non-cubic extension; say may want to have a true 1-dim   </span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="comment">// fitting for double entries in recoil detector magnet map;    </span></div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="code" href="../../d7/dd2/classMgridInterpolation.html#aebf18228f3ea98918c07c15024edf852">  193</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#aebf18228f3ea98918c07c15024edf852">extension_prohibited</a>[3];</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">// If cell points have different weights regular cube case makes not too        </span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="comment">// much sense since polynomial basis has to be rebuilt every time anyway;       </span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="comment">// since point weights can be changed by user any time (protect later, please!) </span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">// it is also expected that user is responsible for setting this flag;          </span></div>
<div class="line"><a name="l00199"></a><span class="lineno"><a class="code" href="../../d7/dd2/classMgridInterpolation.html#aa68d2cd00c010a418ddbbbfdf95e667f">  199</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#aa68d2cd00c010a418ddbbbfdf95e667f">force_irregular_case</a>, <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a1fc029fd11a0a240efaa9d12c53245db">force_1dim_weight_usage</a>, <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a4b26c075d0caed44ab42547f6ff4b3c4">force_3dim_weight_usage</a>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">// Gradient calculation takes CPU time =&gt; disabled per default;  </span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="comment">// in fact this works in 3D XYZ case only --&gt; need to check;    </span></div>
<div class="line"><a name="l00203"></a><span class="lineno"><a class="code" href="../../d7/dd2/classMgridInterpolation.html#a576f0c99fa40080c3ba936d1706f39b4">  203</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#ab49bcaf1b80eeca45e1e3181d8a4cc63">fit_error_wanted</a>, <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a576f0c99fa40080c3ba936d1706f39b4">gradient_wanted</a>;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="comment">// KxMxN cell area; allocated linearly for simplicity; </span></div>
<div class="line"><a name="l00206"></a><span class="lineno"><a class="code" href="../../d7/dd2/classMgridInterpolation.html#a77eeedb9672c9a89d8c17f72ea59eb67">  206</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a77eeedb9672c9a89d8c17f72ea59eb67">cell_counter</a>;</div>
<div class="line"><a name="l00207"></a><span class="lineno"><a class="code" href="../../d7/dd2/classMgridInterpolation.html#ab9c3c9c5e6670f59af0d38ba6f045572">  207</a></span>&#160;  <a class="code" href="../../d8/dec/structMgridCell.html">MgridCell</a> **<a class="code" href="../../d7/dd2/classMgridInterpolation.html#ab9c3c9c5e6670f59af0d38ba6f045572">cube</a>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="comment">// N-dim position of the leftmost cell in case of a cubic positioning; </span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="comment">// natural XYZ (RFZ) sequence;                                         </span></div>
<div class="line"><a name="l00211"></a><span class="lineno"><a class="code" href="../../d7/dd2/classMgridInterpolation.html#a3edf81e8a3d9201acde8ae08323afd7a">  211</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a3edf81e8a3d9201acde8ae08323afd7a">left</a>[3];</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="comment">// This is needed for the &#39;FAST&#39; mode; NB: interpolation index sequence!;</span></div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="code" href="../../d7/dd2/classMgridInterpolation.html#a976e2e49eefa0960fb853ab31cd62468">  214</a></span>&#160;  <span class="keywordtype">double</span> *<a class="code" href="../../d7/dd2/classMgridInterpolation.html#a976e2e49eefa0960fb853ab31cd62468">v</a>[3];</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="comment">// This is needed for the &#39;1DIM POLY&#39; mode; interpolation sequence!; </span></div>
<div class="line"><a name="l00217"></a><span class="lineno"><a class="code" href="../../d7/dd2/classMgridInterpolation.html#a6867f152e3f81a9a07462077b8dcee21">  217</a></span>&#160;  <a class="code" href="../../d0/d93/classThreeDeePolySpace.html">ThreeDeePolySpace</a> *<a class="code" href="../../d7/dd2/classMgridInterpolation.html#a6867f152e3f81a9a07462077b8dcee21">hspace</a>[3];</div>
<div class="line"><a name="l00218"></a><span class="lineno"><a class="code" href="../../d7/dd2/classMgridInterpolation.html#a23cb586ad4a2907d58e09f9b0dec96f8">  218</a></span>&#160;  <a class="code" href="../../d7/dfb/classThreeDeePolynomial.html">ThreeDeePolynomial</a> *<a class="code" href="../../d7/dd2/classMgridInterpolation.html#a23cb586ad4a2907d58e09f9b0dec96f8">hfit</a>[3];</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="comment">// This is needed for the &#39;GLOBAL&#39; mode; in fact it would probably make </span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="comment">// sense to equip polynomial structures with local thread buffers?;</span></div>
<div class="line"><a name="l00222"></a><span class="lineno"><a class="code" href="../../d7/dd2/classMgridInterpolation.html#ae725d32cf02ee9de00df2d71bc42e2aa">  222</a></span>&#160;  <a class="code" href="../../d0/d93/classThreeDeePolySpace.html">ThreeDeePolySpace</a> *<a class="code" href="../../d7/dd2/classMgridInterpolation.html#a35bea2c06552f325215248acc86e2a15">gspace</a>, *<a class="code" href="../../d7/dd2/classMgridInterpolation.html#ae725d32cf02ee9de00df2d71bc42e2aa">irregular</a>, *<a class="code" href="../../d7/dd2/classMgridInterpolation.html#aa23e6fa38f7501c976749e1f080cd48c">actual</a>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="comment">// grad[] is the gradient; </span></div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="code" href="../../d7/dd2/classMgridInterpolation.html#ab4c6a79f520f55d84a264e6903b51df3">  224</a></span>&#160;  <a class="code" href="../../d7/dfb/classThreeDeePolynomial.html">ThreeDeePolynomial</a> *<a class="code" href="../../d7/dd2/classMgridInterpolation.html#a68a1cc0cb8030e6848bd9fc2caf4179a">gfit</a>, *<a class="code" href="../../d7/dd2/classMgridInterpolation.html#ab4c6a79f520f55d84a264e6903b51df3">grad</a>[3];</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="comment">// Gradient value in the last xx[] point where field value </span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="comment">// was calculated; do it better later;                     </span></div>
<div class="line"><a name="l00227"></a><span class="lineno"><a class="code" href="../../d7/dd2/classMgridInterpolation.html#a3fadd27616e9ac4c468016aefddf1872">  227</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a3fadd27616e9ac4c468016aefddf1872">gvalue</a>[3], <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a73c56c784da219567663dfa273156d99">ferr</a>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">// Cell, cube, etc handling routines;</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a279d5c2e49fc5fcde26104f2d1022951">setAllowedCells</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> _allowed_self_cells_mask,</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> _allowed_neighbour_cells_mask);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#ab587d9ad35cd9712f8db4b494ede53ef">prepairIrregularCase</a>(<span class="keywordtype">int</span> cmp);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a9d11204f396fbdd3dfb2a4f4ca642e18">appendArbitraryNeighbouringCells</a>(<span class="keywordtype">int</span> cmp);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a77fca220cbad05c6a46f743978b594e1">checkNeighbouringCubicArea</a>(TVector3 &amp;xx, <span class="keywordtype">int</span> cmp);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a04dc069e08b5aa27ab4b8efd8ce6bba6">fillOutputCubeArray</a>(<span class="keywordtype">int</span> gdim[3], <a class="code" href="../../d9/dcf/structMgridCombiCell.html">MgridCombiCell</a> *ok_arr, <span class="keywordtype">int</span> <a class="code" href="../../df/d6c/classMgridHeader.html#a4fa139cd8550e5ce8060be8ee6b416d0">shift</a>[3]);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a20b3e28368e5294b5f66a2f7e7c8f133">checkSmallCube</a>(<span class="keywordtype">int</span> gdim[3], <a class="code" href="../../d9/dcf/structMgridCombiCell.html">MgridCombiCell</a> *ok_arr, <span class="keywordtype">int</span> <a class="code" href="../../df/d6c/classMgridHeader.html#a4fa139cd8550e5ce8060be8ee6b416d0">shift</a>[3]);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a7a6f231d2f0a6bcaa864a6290ed26926">fillOkArray</a>(<span class="keywordtype">int</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a3edf81e8a3d9201acde8ae08323afd7a">left</a>[3], <span class="keywordtype">int</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a25589fb7d97f4126de0c3ae54619cca7">adim</a>[3], <span class="keywordtype">int</span> cmp, <a class="code" href="../../d9/dcf/structMgridCombiCell.html">MgridCombiCell</a> *ok_arr);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="comment">// Interpolation creation routines;</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#aee353c497e35c1ee5b157bc54a27dd1d">calculateReversedSequence</a>();</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a0300b92add3a1b32fdaf2187cc3c4a4f">allocateCellCubeMemory</a>();</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a1fe5f50b07fec2dc4eadafd378474738">assignBestSequence</a>();</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a898278a0633b4c635bfc4a3cbcf73522">assignSuggestedSequence</a>(<span class="keywordtype">char</span> _sequence[]);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#ab911622d67722298e3387f02275800f8">precookSequentialHighCommon</a>(<span class="keywordtype">int</span> _adim[], <span class="keywordtype">char</span> _sequence[]);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#ac8afe9f94ca71b21a0cc2c09e7d7747f">postcookSequentialHighCommon</a>();</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#a60940056b330ea6819fc769e6a64ec00">preCookMultiDimCommon</a>(<span class="keywordtype">int</span> _adim[]);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d7/dd2/classMgridInterpolation.html#af5a78bee4cc39fcb05cc8fc48e81a135">postCookMultiDimCommon</a>();</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;} ;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">// Possible bits in &#39;status&#39; word; can not use 8 lower bits; </span></div>
<div class="line"><a name="l00251"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#a2e036fb2beca62adabe0bedcba3ba594">  251</a></span>&#160;<span class="preprocessor">#define _BAD_MGRID_POINTER_          0x00000100</span></div>
<div class="line"><a name="l00252"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#a4c273ddfdb411702ea220926abb59dc8">  252</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define _ZERO_INTERPOLATION_POINTER_ 0x00000200</span></div>
<div class="line"><a name="l00253"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#a0340040b9bf1679e422f94aa6ea229f5">  253</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define _CELL_OUT_OF_GRID_           0x00000400</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="preprocessor"></span><span class="comment">// This type of self cells is not allowed; </span></div>
<div class="line"><a name="l00255"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#aa18fb3c629d31d1146134046cd0ab206">  255</a></span>&#160;<span class="preprocessor">#define _ILLEGAL_SELF_CELL_          0x00000800</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="preprocessor"></span><span class="comment">// Cube may not be positioned properly; </span></div>
<div class="line"><a name="l00257"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#a7e25449ca0dd6476f73f0ca45508f561">  257</a></span>&#160;<span class="preprocessor">#define _CUBE_SHIFT_                 0x00001000</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="preprocessor"></span><span class="comment">// Was not able to position cube of requested size at all; </span></div>
<div class="line"><a name="l00259"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#adb2b9de9725aa8dc185323825fa097a8">  259</a></span>&#160;<span class="preprocessor">#define _CUBE_FAILURE_               0x00002000</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="preprocessor"></span><span class="comment">// Cube movement was off and not allowed neighbour cell encountered;                               </span></div>
<div class="line"><a name="l00261"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#aec7b74974038d0e640eb4a7ae9a67c79">  261</a></span>&#160;<span class="preprocessor">#define _ILLEGAL_NEIGHBOUR_CELL_     0x00004000</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00263"></a><span class="lineno"><a class="code" href="../../dd/dd8/MgridInterpolation_8h.html#a5a45d812c817224de008a9a1044a8bf5">  263</a></span>&#160;<span class="preprocessor">#define _FAILURE_(mgrid, bit) {(mgrid)-&gt;last_field_status |= (bit); return -1; }</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->

<!-- start footer part -->
<div id="nav-path" class="navpath">
	<!-- id is needed for treeview function! -->
	<ul>
		<li class="navelem"><a class="el" href="../../dir_d7aa557fabe0dbc710c3133bbb38c9dd.html">EicRoot</a></li><li class="navelem"><a class="el" href="../../dir_6c2f52c7c502fdce4930bf509aa7892f.html">blob</a></li><li class="navelem"><a class="el" href="../../dir_b7851b2c5844943c52ef11ccfc82d757.html">master</a></li><li class="navelem"><a class="el" href="../../dir_1bfc7400c7d9621b65a7f5dd68fa40ba.html">eic</a></li><li class="navelem"><a class="el" href="../../dir_6fd0f0273eefa276f18b09954ea01fc0.html">ayk</a></li><li class="navelem"><a class="el" href="../../dd/dd8/MgridInterpolation_8h.html">MgridInterpolation.h</a></li>
		<li class="footer">
		Built by <a href="mailto:jhuang@bnl.gov">Jin Huang</a></em>.
			updated: <em>Mon Jan 22 2024 12:43:33</em> using <a
			href="http://www.doxygen.org/index.html"> <img class="footer"
				src="../../doxygen.png" alt="doxygen" /></a> 1.8.2 
				with <a href="https://github.com/eic">EIC GitHub integration</a>
		</li>
	</ul>
</div>
</body>
</html>
